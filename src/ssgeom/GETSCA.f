**** SOURCE FILE : M0002771.V04   ***
*
C
      SUBROUTINE GETSCA(SCAN,SPL,PNTS,PTANS,PCRS,TAN,CTAN,IPARA,ILIN,
     *  ITW)
C----------SCULPTURED SURFACE ROUTINE ------- JULY 1971  *LPK*
C----------GET SSCAN ARRAY
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
      DIMENSION SCAN(*),TAN(*),CTAN(*)
      DIMENSION IPARA(2)
C
      INCLUDE 'BLANKCOM.INC'
C
      IDEBUG=0
C---------- XYZ
      IA=SPL
      IB=PNTS
      IC=PTANS-1
      ID=PCRS-1
      NPH=SSCAN(4)
      IE=6*NPH+10
      IG=IE
      IAA=IA-1
      IBB=IB-1
      IF(ILIN.EQ.1) GO TO 2000
      DO 1000 I=1,IAA
      DO 1000 J=1,IBB
      JA=(I-1)*IB*3+(J-1)*3
      JB=(I-1)*IB*3+J*3
      JC=IC+JA
      JD=IC+JB
      JE=I*IB*3+(J-1)*3
      JF=I*IB*3+J*3
      JG=JE+IC
      JH=JF+IC
      JI=ID+(J-1)*IA*3+(I-1)*3
      JJ=ID+I*3+(J-1)*IA*3
      JK=ID+J*IA*3+(I-1)*3
      JL=ID+J*IA*3+I*3
      JX=(J-1)*3+(I-1)*3*IBB
      JY=(J-1)*3+I*3*IBB
      JZ=(I-1)*3+(J-1)*3*IAA
      JW=(I-1)*3+J*3*IAA
      DO 1100 K=1,3
      SSCAN(IG+1)=SCAN(JA+K)
      SSCAN(IG+2)=SCAN(JB+K)
      SSCAN(IG+3)=SCAN(JC+K)
      IF(IPARA(1).EQ.1) GO TO 1002
      SSCAN(IG+4)=SCAN(JD+K)
 1012 SSCAN(IG+5)=SCAN(JE+K)
      SSCAN(IG+6)=SCAN(JF+K)
      SSCAN(IG+7)=SCAN(JG+K)
      IF(IPARA(1).EQ.1) GO TO 1003
      SSCAN(IG+8)=SCAN(JH+K)
 1013 SSCAN(IG+9)=SCAN(JI+K)
      SSCAN(IG+10)=SCAN(JK+K)
      IF(IPARA(2).EQ.1) GO TO 1031
      SSCAN(IG+11)=SCAN(JJ+K)
      SSCAN(IG+12)=SCAN(JL+K)
      GO TO 1005
C----------PARALLEL CASE
 1002 SSCAN(IG+4)=TAN(JX+K)
      GO TO 1012
 1003 SSCAN(IG+8)=TAN(JY+K)
      GO TO 1013
 1031 SSCAN(IG+11)=CTAN(JZ+K)
      SSCAN(IG+12)=CTAN(JW+K)
 1005 IF(ITW.EQ.0) GO TO 1101
C---------- INSERT TWIST VECTOR,IF SPL=2 OR PNTS=2
      TEMA=SSCAN(IG+11)
      TEMB=SSCAN(IG+12)
      IF(ITW.EQ.2  ) GO TO 1110
      SSCAN(IG+11)=(SSCAN(IG+7)-SSCAN(IG+3))
      SSCAN(IG+12)=(SSCAN(IG+8)-SSCAN(IG+4))
      GO TO 1111
 1110 SSCAN(IG+11)=(SSCAN(IG+10)-SSCAN(IG+9))
      SSCAN(IG+12)=(TEMB-TEMA)
 1111 SSCAN(IG+13)=TEMA
      SSCAN(IG+14)=TEMB
      SSCAN(IG+15)=SSCAN(IG+11)
      SSCAN(IG+16)=SSCAN(IG+12)
 1101 IG=IG+12
      IF(ITW.NE.0) IG=IG+4
 1100 CONTINUE
      SSCAN(IG+1)=1.0
      IG=IG+1
 1000 CONTINUE
      GO TO 9999
 2000 DO 2001 I=1,IAA
      DO 2001 J=1,IBB
      JA=(I-1)*IB*3+(J-1)*3
      JB=(I-1)*IB*3+J*3
      JC=IC+JA
      JD=IC+JB
      JE=I*IB*3+(J-1)*3
      JF=I*IB*3+J*3
      JG=JE+IC
      JH=JF+IC
      JI=ID+(J-1)*IA*3+(I-1)*3
      JJ=ID+I*3+(J-1)*IA*3
      JK=ID+J*IA*3+(I-1)*3
      JL=ID+J*IA*3+I*3
      JX=(J-1)*3+(I-1)*3*IBB
      JY=(J-1)*3+I*3*IBB
      JZ=(I-1)*3+(J-1)*3*IAA
      JW=(I-1)*3+J*3*IAA
      IF(SSCAN(6)-2.0) 2100,2200,2300
C----------XYPLAN
 2100 SSCAN(IG+1)=SCAN(JA+1)
      SSCAN(IG+2)=SCAN(JB+1)
      SSCAN(IG+3)=SCAN(JE+1)
      SSCAN(IG+4)=SCAN(JF+1)
      SSCAN(IG+5)=SCAN(JA+2)
      SSCAN(IG+6)=SCAN(JB+2)
      SSCAN(IG+7)=SCAN(JE+2)
      SSCAN(IG+8)=SCAN(JF+2)
      SSCAN(IG+9)=SCAN(JA+3)
      SSCAN(IG+10)=SCAN(JB+3)
      SSCAN(IG+11)=SCAN(JC+3)
      IF(IPARA(1).EQ.1) GO TO 2102
      SSCAN(IG+12)=SCAN(JD+3)
 2112 SSCAN(IG+13)=SCAN(JE+3)
      SSCAN(IG+14)=SCAN(JF+3)
      SSCAN(IG+15)=SCAN(JG+3)
      IF(IPARA(1).EQ.1) GO TO 2103
      SSCAN(IG+16)=SCAN(JH+3)
 2113 SSCAN(IG+17)=SCAN(JI+3)
      SSCAN(IG+18)=SCAN(JK+3)
      IF(IPARA(2).EQ.1) GO TO 2131
      SSCAN(IG+19)=SCAN(JJ+3)
      SSCAN(IG+20)=SCAN(JL+3)
      GO TO 2107
C----------PARALLEL CASE
 2102 SSCAN(IG+12)=TAN(JX+3)
      GO TO 2112
 2103 SSCAN(IG+16)=TAN(JY+3)
      GO TO 2113
 2131 SSCAN(IG+19)=CTAN(JZ+3)
      SSCAN(IG+20)=CTAN(JW+3)
 2107 IF(ITW.EQ.0  ) GO TO 2105
C---------- INSERT TWIST VECTOR,IF SPL=2 OR PNTS=2
      TEMA=SSCAN(IG+19)
      TEMB=SSCAN(IG+20)
      IF(ITW.EQ.2) GO TO 2110
      SSCAN(IG+19)=(SSCAN(IG+15)-SSCAN(IG+11))
      SSCAN(IG+20)=(SSCAN(IG+16)-SSCAN(IG+12))
      GO TO 2111
 2110 SSCAN(IG+19)=(SSCAN(IG+18)-SSCAN(IG+17))
      SSCAN(IG+20)=(TEMB-TEMA)
 2111 SSCAN(IG+21)=TEMA
      SSCAN(IG+22)=TEMB
      SSCAN(IG+23)=SSCAN(IG+19)
      SSCAN(IG+24)=SSCAN(IG+20)
      GO TO 2106
C---------- YZPLAN
 2200 SSCAN(IG+1)=SCAN(JA+1)
      SSCAN(IG+2)=SCAN(JB+1)
      SSCAN(IG+3)=SCAN(JC+1)
      IF(IPARA(1).EQ.1) GO TO 2202
      SSCAN(IG+4)=SCAN(JD+1)
 2212 SSCAN(IG+5)=SCAN(JE+1)
      SSCAN(IG+6)=SCAN(JF+1)
      SSCAN(IG+7)=SCAN(JG+1)
      IF(IPARA(1).EQ.1) GO TO 2203
      SSCAN(IG+8)=SCAN(JH+1)
 2213 SSCAN(IG+9)=SCAN(JI+1)
      SSCAN(IG+10)=SCAN(JK+1)
      IF(IPARA(2).EQ.1) GO TO 2231
      SSCAN(IG+11)=SCAN(JJ+1)
      SSCAN(IG+12)=SCAN(JL+1)
 2215 SSCAN(IG+13)=SCAN(JA+2)
      SSCAN(IG+14)=SCAN(JB+2)
      SSCAN(IG+15)=SCAN(JE+2)
      SSCAN(IG+16)=SCAN(JF+2)
      SSCAN(IG+17)=SCAN(JA+3)
      SSCAN(IG+18)=SCAN(JB+3)
      SSCAN(IG+19)=SCAN(JE+3)
      SSCAN(IG+20)=SCAN(JF+3)
      IF(ITW.EQ.0  ) GO TO 2105
C---------- INSERT TWIST VECTOR,IF SPL=2 OR PNTS=2
      TEMA=SSCAN(IG+11)
      TEMB=SSCAN(IG+12)
      SSCAN(IG+17)=SSCAN(IG+13)
      SSCAN(IG+18)=SSCAN(IG+14)
      SSCAN(IG+19)=SSCAN(IG+15)
      SSCAN(IG+20)=SSCAN(IG+16)
      SSCAN(IG+21)=SSCAN(IG+17)
      SSCAN(IG+22)=SSCAN(IG+18)
      SSCAN(IG+23)=SSCAN(IG+19)
      SSCAN(IG+24)=SSCAN(IG+20)
      IF(ITW.EQ.2) GO TO 2210
      SSCAN(IG+11)=(SSCAN(IG+7)-SSCAN(IG+3))
      SSCAN(IG+12)=(SSCAN(IG+8)-SSCAN(IG+4))
      GO TO 2211
 2210 SSCAN(IG+11)=(SSCAN(IG+10)-SSCAN(IG+9))
      SSCAN(IG+12)=(TEMB-TEMA)
 2211 SSCAN(IG+13)=TEMA
      SSCAN(IG+14)=TEMB
      SSCAN(IG+15)=SSCAN(IG+11)
      SSCAN(IG+16)=SSCAN(IG+12)
      GO TO 2106
C----------PARALLEL CASE
 2202 SSCAN(IG+4)=TAN(JX+1)
      GO TO 2212
 2203 SSCAN(IG+8)=TAN(JY+1)
      GO TO 2213
 2231 SSCAN(IG+11)=CTAN(JZ+1)
      SSCAN(IG+12)=CTAN(JW+1)
      GO TO 2215
C----------ZXPLAN
 2300 SSCAN(IG+1)=SCAN(JA+1)
      SSCAN(IG+2)=SCAN(JB+1)
      SSCAN(IG+3)=SCAN(JE+1)
      SSCAN(IG+4)=SCAN(JF+1)
      SSCAN(IG+5)=SCAN(JA+2)
      SSCAN(IG+6)=SCAN(JB+2)
      SSCAN(IG+7)=SCAN(JC+2)
      IF(IPARA(1).EQ.1) GO TO 2302
      SSCAN(IG+8)=SCAN(JD+2)
 2312 SSCAN(IG+9)=SCAN(JE+2)
      SSCAN(IG+10)=SCAN(JF+2)
      SSCAN(IG+11)=SCAN(JG+2)
      IF(IPARA(1).EQ.1) GO TO 2303
      SSCAN(IG+12)=SCAN(JH+2)
 2313 SSCAN(IG+13)=SCAN(JI+2)
      SSCAN(IG+14)=SCAN(JK+2)
      IF(IPARA(2).EQ.1) GO TO 2331
      SSCAN(IG+15)=SCAN(JJ+2)
      SSCAN(IG+16)=SCAN(JL+2)
 2315 SSCAN(IG+17)=SCAN(JA+3)
      SSCAN(IG+18)=SCAN(JB+3)
      SSCAN(IG+19)=SCAN(JE+3)
      SSCAN(IG+20)=SCAN(JF+3)
      IF(ITW.EQ.0  ) GO TO 2105
C---------- INSERT TWIST VECTOR,IF SPL=2 OR PNTS=2
      TEMA=SSCAN(IG+15)
      TEMB=SSCAN(IG+16)
      SSCAN(IG+21)=SSCAN(IG+17)
      SSCAN(IG+22)=SSCAN(IG+18)
      SSCAN(IG+23)=SSCAN(IG+19)
      SSCAN(IG+24)=SSCAN(IG+20)
      IF(ITW.EQ.2) GO TO 2310
      SSCAN(IG+15)=(SSCAN(IG+11)-SSCAN(IG+7))
      SSCAN(IG+16)=(SSCAN(IG+12)-SSCAN(IG+8))
      GO TO 2311
 2310 SSCAN(IG+15)=(SSCAN(IG+14)-SSCAN(IG+13))
      SSCAN(IG+16)=(TEMB-TEMA)
 2311 SSCAN(IG+17)=TEMA
      SSCAN(IG+18)=TEMB
      SSCAN(IG+19)=SSCAN(IG+15)
      SSCAN(IG+20)=SSCAN(IG+16)
      GO TO 2106
C----------PARALLEL CASE
 2302 SSCAN(IG+8)=TAN(JX+2)
      GO TO 2312
 2303 SSCAN(IG+12)=TAN(JY+2)
      GO TO 2313
 2331 SSCAN(IG+15)=CTAN(JZ+2)
      SSCAN(IG+16)=CTAN(JW+2)
      GO TO 2315
 2105 SSCAN(IG+21)=1.0
      IG=IG+21
      GO TO 2001
 2106 SSCAN(IG+25)=1.0
      IG=IG+25
 2001 CONTINUE
 9999 RETURN
      END
