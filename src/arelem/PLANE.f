**** SOURCE FILE : M0002852.V04   ***
*
C.....FORTRAN SUBROUTINE  ....PLANE          8/68                    PH
C.....FORTRAN SUBROUTINE             PLANE....              4/1/68   GK
      SUBROUTINE PLANE
      IMPLICIT DOUBLE PRECISION(A-H),DOUBLE PRECISION(O-Z)
C
C
C
C
      INCLUDE 'TOTAL.INC'
      INCLUDE 'DSHAR4.INC'
      INCLUDE 'FXCOR.INC'
      INCLUDE 'SV.INC'
      INCLUDE 'ZNUMBR.INC'
      INCLUDE 'ISV.INC'
      INCLUDE 'IFXCOR.INC'
      INCLUDE 'ISHR18.INC'
      INCLUDE 'KNUMBR.INC'
C
C...  21. ADDCOM BLOCK
C
      COMMON/ADDCOM/ ADDCOM
      DIMENSION ADDCOM(25)
      EQUIVALENCE (ADDCOM( 1),ELMAX ),  (ADDCOM( 2),CLNGTH),
     1            (ADDCOM(23),IBTFLG),  (ADDCOM(24),JLIN)
C
C
C
      DATA ZLIT1/3.5D0/
C
      J = IDS
      IF (IFL4(IS)) 3,4,3
    3 J = IPS
    4 DO 41 I = 1,3
      TP(I,J) = TP(I,J) + CMOVE(I)
      SP(I,J) = SP(I,J) + CMOVE(I)
   41 CONTINUE
    9 CALL CHECK
      IF(IAERR)16,91,16
   91 IF(JCKR)1,14,1
    1 CALL CENTR
      IF(IAERR)16,92,16
   92 IF(JCR)2,10,11
    2 CALL AERR(-24401,'PLANE   ')
      ISFTYP(IS) = 99
      GO TO 15
   12 J21(IS)=K1
      JPR = -K2
      TE(1)=TEL(1)
      TE(2)=TEL(2)
      TE(3)=TEL(3)
      S(IS)=Z3*DP
      IF (ICSCNT - K1) 16,16,30
   30 STCK(IS)=Z1E6
      DP=DPMAX
      S(IS)=ZLIT1*DP
      CSD(IS)=Z11EM1*DP
      GO TO 16
   10 CALL AERR (24402,'PLANE   ')
      GO TO 16
   11 IF((TE(1)-TEK(1))*TI(1)+(TE(2)-TEK(2))*TI(2)+(TE(3)-TEK(3)
     1)*TI(3))12,13,13
   13 IF(JCR-K1)21,20,21
   21 JPR=KM1
      GO TO 16
   20 JPR=K1
      GO TO 16
   14 NUMPT1=NUMPT1-K1
      CLNGTH = CLNGTH + DPMAX
      IF (ELMAX - CLNGTH) 19,19,18
   19 CALL AERR(24404,'PLANE   ')
   18 IF (NUMPT1 - K1) 15,17,15
   15 JPR=0
   16 CONTINUE
      RETURN
   17 CALL AERR (24403,'PLANE   ')
      GO TO 16
       END
