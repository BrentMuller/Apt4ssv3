**** SOURCE FILE : M0006666.W01   ***
*
C
C              FORTRAN SUBROUTINE PRO021
C
C LINKAGE      SUBROUTINE PRO021(RESULT,I,ERRP)
C
C          SUBSIDIARIES                  CALLED BY
C          TYPE          ENTRY           TYPE          ENTRY
C          SUBROUTINE    CALLZZ          SUBROUTINE    PRO020
C          INTEGER FCT.  MODE
C          INTEGER FCT.  NUMB
C          INTEGER FCT.  GETTMP
C          SUBROUTINE    OPCODE
C          SUBROUTINE    PUTTMP
C          SUBROUTINE    REFGEN
C          SUBROUTINE    RLSLIN
C          INTEGER FCT.  SEARCH
C          SUBROUTINE    TWOARG
C          SUBROUTINE    ARGCVT
C          SUBROUTINE    ALARM
C          SUBROUTINE    ARGGEN
C
      SUBROUTINE PRO021(RESULT,I,ERRP)
C
      IMPLICIT INTEGER (A-Z)
C
C        1.    NAME TABLE AND TABLE LIMITS
C
      INCLUDE 'NAMETB.INC'
C NAMTBL:      INTEGER CORRESPONDING TO NAME TABLE ENTRY
C CNAMTB:      NAME TABLE OR DICTIONARY
C IFIXST:      NAMTBL INDEX OF BEGINNING OF FIXED POINT NUMBER SECTION
C
C        2.    STACK AND POINTER STORAGE
C
      COMMON/STKLST/STKLST
      DIMENSION STKLST(300),STACK(2,99),ARGSTK(99)
C TOP:         POINTER TO LAST STACK ENTRY
      EQUIVALENCE (TOP,STKLST(1))
C ARGTOP:      POINTER TO LAST ARGSTK ENTRY
      EQUIVALENCE (ARGTOP,STKLST(2))
C STACK:       WORKING STACK
      EQUIVALENCE (STACK(1,1),STKLST(4))
C ARGSTK:      ARGUMENT STACK
      EQUIVALENCE (ARGSTK(1),STKLST(202))
C
C        3.    METALINGUISTIC VARIABLE CLASS CODES
C
      COMMON/CODE/CODE
      DIMENSION CODE(150),GEOM(2)
C GEOM:        (1)=CODE CLASS 16000,(2)=NAMTBL INDEX OF 'GEOM  '
      EQUIVALENCE (GEOM(1),CODE(31))
C
C        9.    NAME TABLE POINTERS TO NUMBERS
C
      COMMON/NUMPTR/NUMPTR
      DIMENSION NUMPTR(12),IARG(8)
C ZERO:        NAMTBL POINTER TO '0     '
      EQUIVALENCE (ZERO,NUMPTR(1))
C ZEROPT:      NAMTBL POINTER TO '0.    '
      EQUIVALENCE (ZEROPT,NUMPTR(2))
C ONE:         NAMTBL POINTER TO '1     '
      EQUIVALENCE (ONE,NUMPTR(3))
C ONEPT:       NAMTBL POINTER TO '1.    '
      EQUIVALENCE (ONEPT,IARG(1),NUMPTR(4))
C TWO:         NAMTBL POINTER TO '2     '
      EQUIVALENCE (TWO,NUMPTR(5))
C THREE:       NAMTBL POINTER TO '3     '
      EQUIVALENCE (THREE,NUMPTR(6))
C
C       10.    TABLE STORAGE FOR GEOMETRIC FUNCTION PROCESSOR
C
      INCLUDE 'GMTY.INC'
C GEOLOC:      GEOMETRIC PRODUCTION STARTING INDEX IN GEOMTB
C GEOMTB:      GEOMETRIC FORMAT PRODUCTIONS ARRANGED BY SURFACE TYPE
C
C       16.    LITERALS FOR I. L. OPERATION CODES
C
      COMMON/IL/IL
      DIMENSION IL(21)
C FSUB:        CONTAINS COMMAND CODE ( 2) FOR FSUB COMMAND
      EQUIVALENCE (FSUB,IL(2))
C MOVE:        CONTAINS COMMAND CODE (19) FOR MOVE COMMAND
      EQUIVALENCE (MOVE,IL(19))
C
C       17.    MODE CODES
C
      COMMON/MODX/MODX
      DIMENSION MODX(32)
C LINE:        MODE CODE ( 1) FOR LINE
      EQUIVALENCE (LINE,MODX(1))
C MATRIX:      MODE CODE (18) FOR MATRIX
      EQUIVALENCE (MATRIX,MODX(18))
C POINT:       MODE CODE (19) FOR POINT
      EQUIVALENCE (POINT,MODX(19))
C VECTOR:      MODE CODE (20) FOR VECTOR
      EQUIVALENCE (VECTOR,MODX(20))
C BOUNDS:      MODE CODE (27) FOR BOUNDS
      EQUIVALENCE (BOUNDS,MODX(27))
C OBJECT:      MODE CODE (28) FOR OBJECT
      EQUIVALENCE (OBJECT,MODX(28))
C
C       28.    OPERAND MODIFIERS
C
      COMMON/SUBLST/SUBLST
      DIMENSION SUBLST(136),APTXXX(120)
C APTXXX:      NAMTBL POINTERS FOR XECUTION SUBROUTINE NAMES
      EQUIVALENCE (APTXXX(1),SUBLST(1))
C UNDEF:       NAMTBL POINTER TO EXECUTION SUBROUTINE UNDEF
      EQUIVALENCE (UNDEF,SUBLST(74))
C DEFEXT:      NAMTBL POINTER TO EXECUTION SUBROUTINE DEFEXT
      EQUIVALENCE (DEFEXT,SUBLST(82))
C
C       29.    CLASS CODE MODULI
C
      COMMON/MODULI/MODULI
      DIMENSION MODULI(2)
C MODHLF:      NORMAL MODE CODE LIMIT 500
      EQUIVALENCE (MODHLF,MODULI(2))
C
C       30.    NAMTBL POINTERS TO FIRST CANONICAL FORMS IN EACH BLOCK
C              NAMTBL POINTER TO FIRST CANONICAL FORMS IN EACH BLOCK
      COMMON/BLKCFS/FIRST
      DIMENSION FIRST(2,3)
C
C       35.    COMMON BLOCK FOR BOUNDED GEOMETRY AND CFSAVE
C
      COMMON/BGEOM/BGEOM
      DIMENSION BGEOM(4)
C IFBNDS:      VALUE 1 IF BOUNDED GEOMETRY IS INCLUDED IN PART PROGRAM
      EQUIVALENCE (IFBNDS,BGEOM(1))
C*
C ARGUMENTS    RESULT  ARRAY TO CONTAIN CANONICAL FORM WHEN
C                      I.L. IS EXECUTED
C              I       CURRENT PRODUCTION NUMBER
C**
      DIMENSION NARG(7,38),IARGZ(38),P(5),ICF(300)
      CHARACTER*12 ITWOPT
      external alarm
      DATA ITWOPT/'2.          '/
C
C    STEUER DATEN FUER ERWEITERTE PUNKT/VECTOR-DEFINITIONEN
      DATA NARG/
C   201: PT/IN, SC,P/F,  R       ;202:PT/IN, SC,P/F,  R,  R
     1       -12, 3, 0, 2, 1, 0, 0,       -12, 4, 0, 3, 2, 1, 0,
C   203: PT/IN, SS,  R,  R       ;204:PT/IN, SS,  R,  R,  R
     2       -14, 3, 0, 2, 1, 0, 0,       -14, 4, 0, 3, 2, 1, 0,
C   205: PT/IN, SS,P/F,  R,R,R   ;206:PT/IN,L/P, SC, PT
     3       -14, 5, 0, 3, 2, 1, 0,       -13, 2, 0, 0, 3, 1, 0,
C   207: PT/IN, SS, PT, PT       ;208:PT/IN, SS,P/F, PT, PT
     4       -16, 3, 0, 2, 0, 1, 0,       -16, 4, 0, 2, 0, 1, 0,
C   209: PT/IN, SS, PT, VT, PT   ;210:PT/IN, SS,P/F, PT, VT, PT
     5       -18, 4, 0, 3, 2, 1, 0,       -18, 5, 0, 3, 2, 1, 0,
C   211: PT/IN, SS, PT, VT       ;212:PT/IN, SS,P/F, PT, VT
     6       -17, 3, 0, 2, 1, 0, 0,       -17, 4, 0, 2, 1, 0, 0,
C   213: PT/IN, SS, PT           ;214:PT/IN, SS,P/F, PT
     7       -15, 2, 0, 1, 0, 0, 0,       -15, 3, 0, 1, 0, 0, 0,
C   215: VT/IN, SC,P/F,  R,TA1, U;216:VT/IN, SC,P/F,  R,  R,TA1, U
     8       -12, 5, 2, 4, 3, 0, 1,       -12, 6, 2, 5, 4, 3, 1,
C   217: VT/IN, SC,P/F,  R,TA1   ;218:VT/IN, SC,P/F,  R,  R,TA1
     9       -12, 4, 1, 3, 2, 0, 0,       -12, 5, 1, 4, 3, 2, 0,
C   219: VT/IN, SS,  R,  R,TA2, U;220:VT/IN, SS,  R,  R,  R,TA2, U
     A       -14, 5, 2, 4, 3, 0, 1,       -14, 6, 2, 5, 4, 3, 1,
C   221: VT/IN,SS,P/F,R,R,R,TA2,U;222:VT/IN, SS,  R,  R,TA2
     A       -14, 7, 2, 5, 4, 3, 1,       -14, 4, 1, 3, 2, 0, 0,
C   223: VT/IN, SS,  R,  R, R,TA2;224:VT/IN, SS,P/F,  R,  R,  R,TA2
     B       -14, 5, 1, 4, 3, 2, 0,       -14, 6, 1, 4, 3, 2, 0,
C   225: VT/IN,L/P, SC, PT,TA1   ;226:VT/IN,L/P, SC, PT,TA1, U
     B       -13, 3, 1, 0, 4, 2, 0,       -13, 4, 2, 0, 5, 3, 1,
C   227: VT/IN, SS, PT,TA2       ;228:VT/IN, SS, PT,TA2, U
     C       -15, 3, 1, 2, 0, 0, 0,       -15, 4, 2, 3, 0, 0, 1,
C   229: VT/IN, SS,P/F, PT,TA2   ;230:VT/IN, SS, PT, PT,TA2
     D       -15, 4, 1, 2, 0, 0, 0,       -16, 4, 1, 3, 0, 2, 0,
C   231: VT/IN, SS, PT, PT,TA2, U;232:VT/IN, SS,P/F, PT, PT,TA2
     E       -16, 5, 2, 4, 0, 3, 1,       -16, 5, 1, 3, 0, 2, 0,
C   233: VT/IN, SS, PT, VT,TA2   ;234:VT/IN, SS, PT, VT,TA2, U
     F       -17, 4, 1, 3, 2, 0, 0,       -17, 5, 2, 4, 3, 0, 1,
C   235: VT/IN, SS,P/F, PT,VT,TA2;236:VT/IN, SS, PT, VT, PT,TA2
     G       -17, 5, 1, 3, 2, 0, 0,       -18, 5, 1, 4, 3, 2, 0,
C   237: VT/IN,SS,PT,VT, PT,TA2,U;238:VT/IN, SS,P/F, PT, VT, PT,TA2
     H       -18, 6, 2, 5, 4, 3, 1,       -18, 6, 1, 4, 3, 2, 0/
C  BEDEUTUNG DER PARAMETER-KUERZEL: IN=INTOF , SC=SCURV , SS=SSURF ,
C     P/F=PARAM/FLOW , R=REAL , PT=POINT , VT=VECTOR , L/P=LINE/PLANE ,
C     TA1=TANSPL/CRSSPL/NORMAL/BINORM , TA2=TANSPL/CRSSPL/NORMAL
C   STEUER-ARGUMENT-ERZEUGUNG MITTELS ZEIGER AUS COMMON/NUMPTR/
      DATA  IARGZ/4,5,4,5,6,4,4,5,5,6,4,5,3,4,
     *          6,7,5,6,6,7,8,5,6,7,5,6,
     *          4,5,5,5,6,6,5,6,6,6,7,7/
      DATA KGT/0/,P/5*1/
C
C     ANZAHL DER ARGUMENTE
      DATA ICF/
C ICF                ( 5)           (10)           (15)           (20)
     1     4, 4, 3, 5, 5, 5, 3, 4, 4,-2, 5, 5, 5, 4, 4, 3, 4,-1,-4, 4,
C ICF                (25)           (30)           (35)           (40)
     2     4, 4, 3, 5, 4, 4, 3, 5,-3, 4, 5, 5, 6, 4, 4, 6, 6, 7,11, 5,
C ICF                (45)           (50)           (55)           (60)
     3     3, 3, 4,-1, 3, 5, 5, 5,-1, 5, 7,-4, 5, 6, 7, 7, 8, 8,-1, 4,
C ICF                (65)           (70)           (75)           (80)
     4     6, 5, 3, 4, 5,-1,-1,-1, 7, 7, 6,-1,-1,-1, 6, 5, 5, 4, 5, 3,
C ICF                (85)           (90)                         (100)
     5     5,-1, 7, 9,-1,-5,-6,-1, 7,-9,       9* -1              , 7,
C ICF               (105)          (110)
     6     4, 3, 5, 4, 7, 4, 5, 5,13, 3, 2, 2, 5, 37* -1             ,
C ICF               (155)          (160)          (165)          (170)
     7     6, 5, 4, 4, 6, 9, 8, 7, 7, 5, 8, 7, 6, 6, 4, 7, 6, 5, 5, 4,
C ICF               (175)          (180)          (185)
     8     7, 6, 5, 5, 4, 3, 4, 8,12,11,10, 6, 5, 5,-7,-8, 14* -1    ,
C ICF               (205)          (210)          (215)          (220)
     9     5, 6, 5, 6, 7, 5, 5, 6, 6, 7, 5, 6, 4, 5, 7, 8, 6, 7, 7, 8,
C ICF               (225)          (230)          (235)
     A     9, 6, 7, 8, 6, 7, 5, 6, 6, 6, 7, 7, 6, 7, 7, 7, 8, 8,62* -1 /
C     PRODUKTION NICHT GEFUNDEN
      ERRPT=-ERRP
      IF(ERRPT.GE.0)ERRPT=-1
      IF(I.EQ.200) GOTO 999
C     PRUEFEN DER ANZAHL DER ARGUMENTE
      I1=ICF(I)
      IF(I1.LT.0) GOTO 91
      IF(I1.EQ.ARGTOP) GOTO 100
      ERRPT=I1-ARGTOP
      GOTO 998
   91 I1=-I1
      GOTO (998,92,93,94,100,100,100,100,90),I1
      GOTO 998
   90 I=27
      IF(ARGTOP.EQ.5) GOTO 100
      GOTO 998
   92 IF(ARGTOP.EQ.6) GOTO 100
      GOTO 95
   93 IF(ARGTOP.EQ.3) GOTO 100
      GOTO 95
   94 IF(ARGTOP.EQ.4) GOTO 100
   95 ERRPT=7-I1/3-ARGTOP
      IF(ERRPT.GT.0)ERRPT=-1
      IF(ARGTOP.NE.5) GOTO 998
C
  100 IF(I.GE.100) GOTO 151
  101 CALL CALLZZ(APTXXX(I))
      CALL ARGCVT(RESULT)
      IF(I.GT.50) GOTO 102
      GO TO (2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,
     *       2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,
     *       2021,2022,2023,2024,2025,2026,2027,2028,2029,2030,
     *       2031,2032,2033,2034,2035,2036,2037,2038,2039,2040,
     *       2041,2042,2043,2044,2045,2046,2047,2048,2049,2050),I
  102 I=I-50
      GO TO (2051,2052,2053,2054,2055,2056,2057,2058,2059,2060,
     *       2061,2062,2063,2064,2065,2066,2067,2068,2069,2070,
     *       2071,2072,2073,2074,2075,2076,2077,2078,2079,2080,
     *       2081,2082,2083,2084,2085,2086,2087,2088,2089),I
C    FEHLERAUSGANG FUER PRODUKTIONSNUMMERN 91 BIS 99
      GOTO  998
C   SONDERDEFINITIONEN
  151 IF(I.GT.200)GOTO 2201
      IF(I.GT.150)GOTO 152
C
      I=I-99
      GO TO (2100,2101,2102,2103,2104,2105,2106,2107,2108,2109,
     *       2110,2111,2112,2113),I
      GOTO  999
C MACRO-DEFINITIONEN UND SONSTIGES
  152 I=I-150
      GO TO (2151,2152,2153,2154,2155,2156,2157,2158,2159,2160,
     *       2161,2162,2163,2164,2165,2166,2167,2168,2169,2170,
     *       2171,2172,2173,2174,2175,2176,2177,2178,2179,2180,
     *       2181,2182,2183,2184,2185,2186),I
      GOTO  999
C  FEHLERAUSGANG
 2018 CONTINUE
 2044 CONTINUE
 2049 CONTINUE
 2059 CONTINUE
 2066 CONTINUE
 2067 CONTINUE
 2068 CONTINUE
 2072 CONTINUE
 2073 CONTINUE
 2074 CONTINUE
 2082 CONTINUE
 2085 CONTINUE
 2088 CONTINUE
  999 CALL ALARM(2001,ERRPT,8,'PRO021  ')
  997 CALL CALLZZ(UNDEF)
      CALL ARGCVT(RESULT)
      CALL RLSLIN
      ARGTOP = 0
      RETURN
C
  998 CALL ALARM(2052,ERRPT,8,'PRO021  ')
      GOTO 997
C
C   1.ARGUMENT AUSLASSEN,SONST ALLE AUSGEBEN --- VERARBEITUNGSART A
 2001 CONTINUE
 2003 CONTINUE
 2004 CONTINUE
 2006 CONTINUE
 2014 CONTINUE
 2017 CONTINUE
 2023 CONTINUE
 2028 CONTINUE
 2030 CONTINUE
 2036 CONTINUE
 2037 CONTINUE
 2040 CONTINUE
 2042 CONTINUE
 2048 CONTINUE
 2053 CONTINUE
 2060 CONTINUE
 2062 CONTINUE
 2077 CONTINUE
 2080 CONTINUE
 2081 CONTINUE
20011 ARGTOP=ARGTOP-2
      CALL ARGGEN
      CALL RLSLIN
      RETURN
C  VORLETZTES ARGUMENT AUSLASSEN                  VERARBEITUNGSART B
 2057 CONTINUE
 2058 CONTINUE
 2084 CONTINUE
      CALL ARGCVT (ARGSTK(7))
 2056 CONTINUE
      CALL ARGCVT (ARGSTK(6))
 2055 CONTINUE
20551 CALL ARGCVT (ARGSTK(5))
 2050 CONTINUE
 2054 CONTINUE
20501 CALL ARGCVT (ARGSTK(4))
 2002 CONTINUE
 2008 CONTINUE
 2009 CONTINUE
 2012 CONTINUE
 2013 CONTINUE
 2019 CONTINUE
 2020 CONTINUE
 2022 CONTINUE
 2026 CONTINUE
 2031 CONTINUE
20571 CALL ARGCVT (ARGSTK(3))
      CALL ARGCVT (ARGSTK(1))
      ARGTOP=0
      CALL RLSLIN
      RETURN
C    ALLE ARGUMENTE AUSGEBEN                VERARBEITUNGSART C
 2005 CONTINUE
 2007 CONTINUE
 2011 CONTINUE
 2015 CONTINUE
 2016 CONTINUE
 2024 CONTINUE
 2025 CONTINUE
 2032 CONTINUE
 2033 CONTINUE
 2034 CONTINUE
 2035 CONTINUE
 2038 CONTINUE
 2039 CONTINUE
 2043 CONTINUE
 2063 CONTINUE
 2064 CONTINUE
 2078 CONTINUE
 2079 CONTINUE
 2083 CONTINUE
 2089 CONTINUE
20051 ARGTOP=ARGTOP-1
      CALL ARGGEN
      CALL RLSLIN
      RETURN
C  LINE/(ATA/SLO),R,INTERC,(XA/YA),R   VERARBEITUNGSART D
 2010 CONTINUE
      IF(ARGTOP.EQ.5) GO TO 20101
      ARGSTK(3)=ARGSTK(2)
      GO TO 20551
20101 ARGSTK(2)=TWO
      ARGTOP=ARGTOP-1
      CALL ARGGEN
      CALL RLSLIN
      RETURN
C  2. ARGUMENT ELIMINIEREN             VERARBEITUNGSART E
 2046 CONTINUE
 2047 CONTINUE
 2065 CONTINUE
 2076 CONTINUE
      ARGSTK(3)= ARGSTK(2)
      GO TO 20501
C  SPEZIAL: UMSPEICHERN DER ARGUMENTE  VERARBEITUNGSART F
 2021 CONTINUE
      ARGSTK(2)=ARGSTK(1)
      ARGSTK(1)=ARGSTK(3)
      GOTO 20011
C  SPEZIALVERARBEITUNG                 VERARBEITUNGSART G
 2029 CONTINUE
      IF (ARGTOP .GT. 3) GO TO 20571
      GO TO 20051
C  SPEZIALVERARBEITUNG                 VERARBEITUNGSART H
 2041 CONTINUE
      ARGSTK(3)=ARGSTK(2)
      ARGSTK(2)=ARGSTK(1)
      ARGSTK(1)=ONE
      CALL ARGGEN
      CALL RLSLIN
      RETURN
C  SPEZIALVERARBEITUNG                 VERARBEITUNGSART I
 2051 CONTINUE
      CALL ARGCVT(ARGSTK(6))
      GO TO 20501
C  SPEZIALVERARBEITUNG                 VERARBEITUNGSART J
 2052 CONTINUE
      IF(ARGTOP.EQ.4) GO TO 20051
      ARGSTK(1) = ARGSTK(2)
      GO TO 20501
C  SPEZIALVERARBEITUNG                 VERARBEITUNGSART K
 2061 CONTINUE
      CALL ARGCVT (ARGSTK(1))
      CALL ARGCVT (ARGSTK(4))
      CALL ARGCVT (ARGSTK(2))
      ARGTOP=0
      CALL RLSLIN
      RETURN
C  SPEZIALVERARBEITUNG                 VERARBEITUNGSART L
 2069 CONTINUE
      DO 20691 J=1,5
20691 ARGSTK(J)= ARGSTK(J+1)
      ARGTOP= 5
      CALL ARGGEN
      CALL ARGCVT(TWO)
      CALL RLSLIN
      RETURN
C  SPEZIALVERARBEITUNG                 VERARBEITUNGSART M
 2071 CONTINUE
      ARGTOP= 5
      CALL ARGGEN
      CALL ARGCVT(ONE)
      CALL RLSLIN
      RETURN
C  SPEZIALVERARBEITUNG                 VERARBEITUNGSART N
 2070 CONTINUE
      CALL ARGCVT (ARGSTK(6))
      CALL ARGCVT (ARGSTK(5))
      CALL ARGCVT (ARGSTK(3))
      CALL ARGCVT (ARGSTK(2))
      ARGTOP=0
      CALL RLSLIN
      RETURN
C  SPEZIALVERARBEITUNG                 VERARBEITUNGSART O
 2075 CONTINUE
      ARGTOP=ARGTOP-3
      CALL ARGGEN
      CALL RLSLIN
      RETURN
C  POINT/CLDATA,N  = PR. 27 ; POINT/CLDATA,N1,TP,N1  = PR. 90
C  VECTOR/CLDATA,N = PR. 27 ; VECTOR/CLDATA,N1,TV,N2= PR. 90
20271 ARGSTK(ARGTOP-1)=ZERO
C   UNTERSUCHUNG OB VECTOR
      KMODE=NAMTBL(STACK(1,TOP-3))-GEOM(1)
      IF(KMODE.GT.MODHLF)KMODE=KMODE-MODHLF
      IF(KMODE.EQ.VECTOR)ARGSTK(ARGTOP-1)=ONE
      GOTO 20051
 2027 IF(ARGTOP.EQ.3)GOTO 20272
      L=ARGSTK(2)
      ARGSTK(2)=ZERO+MOD(NAMTBL(L),10)
      GOTO 20271
20272 ARGTOP=5
      ARGSTK(5)=ARGSTK(3)
      ARGSTK(4)=ARGSTK(2)
      ARGSTK(3)=ZERO
      ARGSTK(2)=ZERO
      GOTO 20271
C   POINT/PATERN,N   PATERNPUNKT
 2045 GOTO 20051
C   VECTOR/R,R,R,R,R,R
 2100 CONTINUE
      J=RESULT
      IREF=6
      DO 21002 L=1,3
      CALL OPCODE(FSUB)
      CALL TWOARG(-L,J)
      M=4-L
      DO 21001 N=1,2
      CALL ARGCVT(ARGSTK(M))
21001 M=M+3
21002 CALL RLSLIN
      ARGTOP = 0
      CALL REFGEN(3,RESULT)
      RETURN
C    POINT/R,R,R
 2101 CALL OPCODE(MOVE)
      CALL ARGGEN
      CALL RLSLIN
      ARGTOP = 0
      CALL REFGEN(1,RESULT)
      RETURN
C    POINT/R,R
 2102 CALL OPCODE(MOVE)
      CALL ARGGEN
      CALL RLSLIN
      ARGTOP = 0
      CALL CALLZZ(APTXXX(49))
      CALL ARGCVT(RESULT)
      CALL RLSLIN
      RETURN
C   CIRCLE/R,R,R,R
 2103 CONTINUE
      J=4
21031 CALL OPCODE(MOVE)
      CALL ARGCVT (RESULT)
      CALL ARGCVT (ARGSTK(J))
      CALL ARGCVT (ARGSTK(J-1))
      CALL ARGCVT (ARGSTK(J-2))
21032 CALL ARGCVT(ZEROPT)
      CALL ARGCVT(ZEROPT)
      CALL ARGCVT(ONEPT)
      CALL ARGCVT (ARGSTK(1))
      CALL RLSLIN
      ARGTOP = 0
      CALL REFGEN(2,RESULT)
      RETURN
C   CIRCLE/CENTER,R,R,R,RADIUS,R
 2104 CONTINUE
      CALL OPCODE(MOVE)
      CALL ARGCVT (RESULT)
      CALL ARGCVT (ARGSTK(3))
      CALL ARGCVT (ARGSTK(2))
      CALL ARGCVT(ZEROPT)
      GO TO 21032
C   CIRCLE/R,R,R
 2105 CONTINUE
      J= 5
      GO TO 21031
C   VECTOR/R,R,R    /   VECTOR/UNIT,R,R,R
 2106 CONTINUE
 2107 CALL OPCODE (MOVE)
      CALL ARGCVT (RESULT)
      CALL ARGCVT (ARGSTK(3))
      CALL ARGCVT (ARGSTK(2))
      CALL ARGCVT (ARGSTK(1))
      CALL RLSLIN
      CALL REFGEN(3,RESULT)
      IF(ARGTOP.EQ.4)GOTO 21071
      CALL CALLZZ (APTXXX(23))
      CALL ARGCVT (RESULT)
      CALL ARGCVT (RESULT)
      CALL RLSLIN
21071 ARGTOP = 0
      RETURN
C    SPHERE/R,R,R,R
 2108 CALL OPCODE (MOVE)
      CALL ARGGEN
      CALL RLSLIN
      CALL REFGEN(1,RESULT)
      RETURN
C    MATRIX/R,R,R,R,R,R,R,R,R,R,R,R
 2109 CALL OPCODE (MOVE)
      CALL ARGGEN
      CALL RLSLIN
21091 CALL CALLZZ(DEFEXT)
      CALL ARGCVT(RESULT)
      CALL RLSLIN
      RETURN
C    MATRIX/SCALE,R
 2110 CALL OPCODE (MOVE)
      CALL ARGCVT (RESULT)
      CALL ARGCVT (ARGSTK(1))
      DO 21102 J=1,2
      DO 21101 L=1,4
21101 CALL ARGCVT(ZEROPT)
21102 CALL ARGCVT(ARGSTK(1))
      CALL ARGCVT(ZEROPT)
      CALL RLSLIN
      ARGTOP=0
      GOTO 21091
C    LINE/XAXIS
 2111 CALL OPCODE (MOVE)
      CALL ARGCVT (RESULT)
      CALL ARGCVT(ZEROPT)
      CALL ARGCVT(ONEPT)
21111 CALL ARGCVT(ZEROPT)
      CALL ARGCVT(ZEROPT)
      CALL RLSLIN
      CALL REFGEN(4,RESULT)
      ARGTOP=0
      RETURN
C    LINE/YAXIS
 2112 CALL OPCODE (MOVE)
      CALL ARGCVT (RESULT)
      CALL ARGCVT(ONEPT)
      CALL ARGCVT(ZEROPT)
      GOTO 21111
C    LINE/PT,ATANGL/SLOPE,R,YAXIS
 2113 ARGSTK(1)=GETTMP(LINE)
      CALL OPCODE (MOVE)
      CALL ARGCVT (ARGSTK(1))
      CALL ARGCVT(ONEPT)
      CALL ARGCVT(ZEROPT)
      CALL ARGCVT(ZEROPT)
      CALL ARGCVT(ZEROPT)
      CALL RLSLIN
      CALL REFGEN(4,ARGSTK(1))
      CALL PUTTMP(LINE)
      I=11
      GOTO 100
C **********************************************************************
C   MEHRFACHTRANSFORMATION
C... BEHANDLUNG DER 2. MATRIX:
C
C  2.MATRIX SCHON DEFINIERT
 2155 CONTINUE
 2160 CONTINUE
 2165 CONTINUE
 2170 IZRES2=ARGSTK(1)
C  MULTIPLIKATIONSSCHALTER AUF NORMAL STELLEN
      I66=ONE
      GOTO 701
C  2.MATRIX : TRANSL,X,Y,Z
 2151 CONTINUE
 2156 CONTINUE
 2161 CONTINUE
 2166 CONTINUE
 2171 IZRES2=GETTMP(MATRIX)
C   MATRIXMULTIPLIKATIONSSCHALTER VORLAEUFIG AUF SONDERBEHANDLUNG STELLE
      I66=ZERO
      CALL CALLZZ(APTXXX(40))
      CALL ARGCVT(IZRES2)
      CALL ARGCVT(ARGSTK(3))
      CALL ARGCVT(ARGSTK(2))
      CALL ARGCVT(ARGSTK(1))
      GOTO 702
C  2.MATRIX : TRANSL,X,Y
 2152 CONTINUE
 2157 CONTINUE
 2162 CONTINUE
 2167 CONTINUE
 2172 IZRES2=GETTMP(MATRIX)
C   MATRIXMULTIPLIKATIONSSCHALTER VORLAEUFIG AUF SONDERBEHANDLUNG STELLE
      I66=ZERO
      CALL CALLZZ(APTXXX(40))
      CALL ARGCVT(IZRES2)
      CALL ARGCVT(ARGSTK(2))
      CALL ARGCVT(ARGSTK(1))
      CALL ARGCVT(ZEROPT)
      GOTO 702
C  2.MATRIX : XYROT/YZROT/ZXROT,ALPH
 2153 CONTINUE
 2158 CONTINUE
 2163 CONTINUE
 2168 CONTINUE
 2173 IZRES2=GETTMP(MATRIX)
C   MATRIXMULTIPLIKATIONSSCHALTER VORLAEUFIG AUF SONDERBEHANDLUNG STELLE
      I66=ZERO
      CALL CALLZZ(APTXXX(63))
      CALL ARGCVT(IZRES2)
      CALL ARGCVT(ARGSTK(2))
      CALL ARGCVT(ARGSTK(1))
      GOTO 702
C  2.MATRIX : SCALE,F
 2154 CONTINUE
 2159 CONTINUE
 2164 CONTINUE
 2169 CONTINUE
 2174 IZRES2=GETTMP(MATRIX)
      CALL OPCODE(MOVE)
      CALL ARGCVT(IZRES2)
      CALL ARGCVT(ARGSTK(1))
      DO 21542 J=1,2
      DO 21541 L=1,4
21541 CALL ARGCVT(ZEROPT)
21542 CALL ARGCVT(ARGSTK(1))
      CALL ARGCVT(ZEROPT)
      CALL RLSLIN
      CALL CALLZZ(DEFEXT)
      CALL ARGCVT(IZRES2)
C    MULTIPLIKATION AUF NORMAL STELLEN
      I66=ONE
C   SETZEN DES ZAEHLERS FUER MATRIX-ZWISCHENSPEICHER
  702 KGT=1
C  ABSCHLUSS DER BEFEHLSFOLGE FUER 2. MATRIX
      CALL RLSLIN
C  BEHANDLUNG DER 1. MATRIX
  701 GOTO (4151,4152,4153,4154,4155,4156,4157,4158,4159,4160,
     *      4161,4162,4163,4164,4165,4166,4167,4168,4169,4170,
     *      4171,4172,4173,4174),I
C  1.MATRIX SCHON DEFINIERT
 4151 CONTINUE
 4152 CONTINUE
 4153 CONTINUE
 4154 IZRES1=ARGSTK(ARGTOP-1)
C  MULTIPLIKATIONSSCHALTER AUF NORMAL STELLEN
      I66=ONE
      GOTO 711
C  1.MATRIX : TRANSL,X,Y,Z
 4155 CONTINUE
 4156 CONTINUE
 4157 CONTINUE
 4158 CONTINUE
 4159 IZRES1=GETTMP(MATRIX)
      CALL CALLZZ(APTXXX(40))
      CALL ARGCVT(IZRES1)
      CALL ARGCVT(ARGSTK(ARGTOP-2))
      CALL ARGCVT(ARGSTK(ARGTOP-3))
      CALL ARGCVT(ARGSTK(ARGTOP-4))
      GOTO 712
C  1.MATRIX : TRANSL,X,Y
 4160 CONTINUE
 4161 CONTINUE
 4162 CONTINUE
 4163 CONTINUE
 4164 IZRES1=GETTMP(MATRIX)
      CALL CALLZZ(APTXXX(40))
      CALL ARGCVT(IZRES1)
      CALL ARGCVT(ARGSTK(ARGTOP-2))
      CALL ARGCVT(ARGSTK(ARGTOP-3))
      CALL ARGCVT(ZEROPT)
      GOTO 712
C  1.MATRIX : XYROT/YZROT/ZXROT,ALPH
 4165 CONTINUE
 4166 CONTINUE
 4167 CONTINUE
 4168 CONTINUE
 4169 IZRES1=GETTMP(MATRIX)
      CALL CALLZZ(APTXXX(63))
      CALL ARGCVT(IZRES1)
      CALL ARGCVT(ARGSTK(ARGTOP-1))
      CALL ARGCVT(ARGSTK(ARGTOP-2))
      GOTO 712
C  1.MATRIX : SCALE,F
 4170 CONTINUE
 4171 CONTINUE
 4172 CONTINUE
 4173 CONTINUE
 4174 IZRES1=GETTMP(MATRIX)
      CALL OPCODE(MOVE)
      CALL ARGCVT(IZRES1)
      CALL ARGCVT(ARGSTK(ARGTOP-2))
      DO 41702 J=1,2
      DO 41701 L=1,4
41701 CALL ARGCVT(ZEROPT)
41702 CALL ARGCVT(ARGSTK(ARGTOP-2))
      CALL ARGCVT(ZEROPT)
      CALL RLSLIN
      CALL CALLZZ(DEFEXT)
      CALL ARGCVT(IZRES1)
C    MULTIPLIKATION AUF NORMAL STELLEN
      I66=ONE
C   LOSLASSEN DES EBEN BENUTZTEN MATRIX-ZWISCHENSPEICHERS
  712 CALL PUTTMP(MATRIX)
C  ABSCHLUSS DER BEFEHLSFOLGE FUER 1. MATRIX
      CALL RLSLIN
C  GGF ZWISCHENSPEICHER FUER 2.MATRIX LOSLASSEN
  711 IF(KGT.EQ.0)GOTO 720
      KGT=0
      CALL PUTTMP(MATRIX)
C   MATRIX-ENDVERARBEITUNG
  720 CALL CALLZZ(APTXXX(41))
      CALL ARGCVT(RESULT)
      CALL ARGCVT(IZRES1)
      CALL ARGCVT(IZRES2)
      CALL ARGCVT(I66)
      CALL RLSLIN
      ARGTOP=0
      RETURN
C **********************************************************************
C   MATRIX/TRANSL,R,R
 2175 ARGSTK(5)=ARGSTK(4)
      ARGSTK(4)=ARGSTK(3)
      ARGSTK(3)=ARGSTK(2)
      ARGSTK(2)=ARGSTK(1)
      ARGSTK(1)=ZEROPT
      ARGTOP=5
      I=40
      GO TO 100
C    MATRIX/MIRROR,XYPLAN/YZPLAN/ZXPLAN
 2176 ARGSTK(5)=ARGSTK(3)
      ARGSTK(4)=ARGSTK(2)
      ARGSTK(3)=ARGSTK(1)
      ARGSTK(2)=ZERO
      ARGSTK(1)=ZERO
      ARGTOP=5
      I=81
      GO TO 100
C    MATRIX/MIRROR,XYPLAN/YZPLAN/ZXPLAN,XYPLAN/YZPLAN/ZXPLAN
 2177 ARGSTK(5)=ARGSTK(4)
      ARGSTK(4)=ARGSTK(3)
      ARGSTK(3)=ARGSTK(2)
      ARGSTK(2)=ARGSTK(1)
      ARGSTK(1)=ZERO
      ARGTOP=5
      I=81
      GO TO 100
C **********************************************************************
C    LOFT-CONIC-VERARBEITUNG
C   LCONIC/5PT,X1,Y1,X2,Y2,X3,Y3,X4,Y4,X5,Y5
C  ARGSTK (11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1)
 2179 GOTO 801
C   LCONIC/4PT1SL,X1,Y1,SL,X2,Y2,X3,Y3,X4,Y4
C  ARGSTK ( 10   , 9, 8, 7, 6, 5, 4, 3, 2, 1)
 2180 P(4)=-1
      GOTO 801
C   LCONIC/3PT2SL,X1,Y1,SL,X2,Y2,SL,X3,Y3
C  ARGSTK (  9   , 8, 7, 6, 5, 4, 3, 2, 1)
 2181 P(2)=-1
      P(4)=-1
      GOTO 801
C  LCONIC-BERECHNUNG
  801 J1=1
      DO 802 J=1,5
C  PUNKTBERECHNUNG: Z=0 ERGAENZEN,RUECKTRANSFORMATION
      IF(P(J).LT.0) GOTO 803
      P(J)=GETTMP(POINT)
      CALL OPCODE(MOVE)
      CALL ARGCVT(P(J))
      CALL ARGCVT(ARGSTK(J1+1))
      CALL ARGCVT(ARGSTK(J1))
      CALL ARGCVT(ZEROPT)
      CALL RLSLIN
      CALL REFGEN(1,P(J))
      ARGSTK(J)=P(J)
      J1=J1+2
      GOTO 802
C   STEIGUNG UMSPEICHERN
  803 ARGSTK(J)=ARGSTK(J1)
      J1=J1+1
  802 CONTINUE
C   DEFINITIONSART UND RESULTATZEIGER UMSPEICHERN
      ARGSTK(6)=ARGSTK(J1)
      ARGSTK(7)=ARGSTK(J1+1)
      ARGTOP=7
C   HILFSZEIGER LOSLASSEN
      DO 804 J=1,5
      IF(P(J).NE.-1)CALL PUTTMP(POINT)
  804 P(J)=1
C NORMALE VERARBEITUNG
      I=83
      GOTO 100
C **********************************************************************
C ... CYLNDR/X,Y,Z,V1,RADIUS
 2182 I = 34
      ISAV=RESULT
      RESULT = GETTMP(POINT)
      CALL OPCODE(MOVE)
      CALL ARGCVT(RESULT)
      CALL ARGCVT(ARGSTK(5))
      CALL ARGCVT(ARGSTK(4))
      CALL ARGCVT(ARGSTK(3))
      CALL RLSLIN
      CALL PUTTMP(POINT)
      CALL REFGEN(1,RESULT)
      ARGSTK(3) = RESULT
      RESULT=ISAV
      ARGTOP = ARGTOP - 2
      GO TO 100
C ... CYLNDR/X,Y,Z,I,J,K,RADIUS
 2178 I = 33
      ISAV=RESULT
      RESULT = GETTMP(POINT)
      CALL OPCODE(MOVE)
      CALL ARGCVT(RESULT)
      CALL ARGCVT(ARGSTK(7))
      CALL ARGCVT(ARGSTK(6))
      CALL ARGCVT(ARGSTK(5))
      CALL RLSLIN
      CALL PUTTMP(POINT)
      CALL REFGEN(1,RESULT)
      ARGSTK(5) = RESULT
      RESULT=ISAV
      ARGTOP = ARGTOP - 2
      GO TO 100
C ... PLANE/P1,P2,PERPTO,PL1
 2183 I=28
      ARGSTK(2) = ARGSTK(4)
      ISAV = ARGSTK(3)
      ARGSTK(3) = ARGSTK(1)
      ARGSTK(1) = ISAV
      GO TO 101
C ... POINT/THETAR,**,ANGLE,RADIUS
 2184 I = 48
      ISAV = ARGSTK(1)
      ARGSTK(1)=ARGSTK(2)
      ARGSTK(2)=ISAV
      GO TO 101
C...  PROCESS BOUNDS STATEMENT
C
C     CALL GENERATED TO APT102        (I=86)
C
C     TEST IF THIS IS FIRST CALL TO APT102.  IF SO GENERATE EXTRA CALL
C     TO ALLOW INITIALIZATION OF BLOCK 1 POINTER.
C
 2086 IF (IFBNDS .NE.  0) GO TO 1305
      TWOPT=NUMB(ITWOPT)
      IFBNDS=1
      DO 1302 I=1,3
      IF (FIRST(2,I) .NE. 0) GO TO 1303
 1302 CONTINUE
 1303 CALL ARGCVT(FIRST(1,I))
      CALL ARGCVT(ZEROPT)
      CALL ARGCVT(ONE)
      CALL RLSLIN
      CALL CALLZZ(APTXXX(86))
      CALL ARGCVT(RESULT)
C
 1305 CALL ARGCVT(ARGSTK(ARGTOP-1))
      CALL ARGCVT(ZEROPT)
      CALL ARGCVT (ONE)
      CALL RLSLIN
      L = GEOLOC(BOUNDS)
      K = TOP + ARGTOP - 1
      ERRPT=ARGTOP-1
 1306 ARGTOP = ARGTOP - 2
      J = 0
      KT2=K*2
      I = SEARCH(STACK,KT2,GEOMTB(L),ERRPT)
      ERRPT=-ERRPT
      IF(ERRPT.GE.0)ERRPT=-1
      IF (I .EQ. 185) GO TO 1308
      IF (I .NE. 186) GO TO 999
C
C     BOUNDN/...,SURF,POINT OR POSX OR NEGX OR POSY OR NEGY OR POSZ ETC.
C
      CALL CALLZZ(APTXXX(86))
      CALL ARGCVT(RESULT)
      CALL ARGCVT(ARGSTK(ARGTOP))
      I = ARGSTK(ARGTOP - 1)
      IF (I .LT. IFIXST) GO TO 1319
      M = I - ONE + 1
      I = ONEPT
      GO TO (1307,1307,1307,1310,1310,1310), M
 1307 I = TWOPT
      GO TO 1310
C
C     BOUNDS/...,SURF,IN OR OUT OR REAL,...
C
 1308 CALL CALLZZ(APTXXX(86))
      CALL ARGCVT(RESULT)
      CALL ARGCVT(ARGSTK(ARGTOP))
      I = ARGSTK(ARGTOP - 1)
      IF (I .EQ. ONE) I = ONEPT
      IF (I .EQ. TWO) I = TWOPT
 1310 CALL ARGCVT(I)
      IF (ARGTOP .EQ. 2) GO TO 1315
      CALL ARGCVT(TWO + J)
      CALL RLSLIN
      K = K - 2
      GO TO 1306
 1315 CALL ARGCVT(THREE + J)
 1318 CALL RLSLIN
      ARGTOP=0
      RETURN
C
C     EMBEDDED POINT.
C
 1319 J = 2
      GO TO 1310
C
C     ERROR EXIT WHEN PRIMARY SURFACE NOT SPECIFIED.
C
 2185 CONTINUE
 2186 GO TO 999
C
C... PROCESS OBJECT STATEMENT
C
C     CALL GENERATED TO APT103               (I=87)
 2087 CALL ARGCVT (ARGSTK(ARGTOP-1))
      J = 0
      KK=ARGTOP-2
      IF (KK .LT. 1) GO TO 1330
      CALL ARGCVT (ONE)
      CALL RLSLIN
      DO 1325 K=1,KK
      CALL CALLZZ(APTXXX(87))
      CALL ARGCVT(RESULT)
      L=KK-K+1
      M = MODE(ARGSTK(L))
      ERRPT=-L
      IF (M .NE. BOUNDS .AND. M .NE. OBJECT) GO TO 999
      CALL ARGCVT(ARGSTK(L))
      IF (K .EQ. KK) GO TO 1315
      CALL ARGCVT(TWO)
 1325 CALL RLSLIN
 1330 CALL ARGCVT(ZERO)
      GO TO 1318
C  PUNKT UND VECTOR-ABGRIFF VUN SSURF UND SCURV
 2201 I=I-200
      IF(I.GT.38)GOTO 999
      NA=I
      ERRPT=1-ARGTOP
      IF(ARGTOP-1.NE.IARGZ(NA))GOTO 999
      CALL CALLZZ(APTXXX(91))
      CALL ARGCVT(RESULT)
      DO 3300 NB=1,7
      NARG1=NARG(NB,NA)
      IF(NARG1)3310,3320,3330
C STEUERVARIABLE 'II' FUER ROUTINE APT109 WIRD AUSGEGEBEN
 3310 CALL ARGCVT(IARG(-10-NARG1))
      GOTO 3300
C AUSGABE EINER REAL-ZAHL 0.0D0
 3320 CALL ARGCVT(ZEROPT)
      GOTO 3300
C AUSGABE EINER ARGSTK-ANGABE (ARGUMENT DER GEOMETRIE-DEFINITION)
 3330 CALL ARGCVT(ARGSTK(NARG1))
 3300 CONTINUE
      ARGTOP=0
      CALL RLSLIN
      RETURN
      END
