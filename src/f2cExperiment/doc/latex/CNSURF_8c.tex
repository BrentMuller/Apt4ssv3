\hypertarget{CNSURF_8c}{}\section{C\+N\+S\+U\+R\+F.\+c File Reference}
\label{CNSURF_8c}\index{C\+N\+S\+U\+R\+F.\+c@{C\+N\+S\+U\+R\+F.\+c}}
{\ttfamily \#include \char`\"{}f2c.\+h\char`\"{}}\\*
Include dependency graph for C\+N\+S\+U\+R\+F.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=148pt]{CNSURF_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{CNSURF_8c_aa957bf0809cdc5dc0b1ac20f58f60d60}{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1}~\hyperlink{XNUMBR_8c_a2a3eec0f18d8617877d8210266fba452}{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+}
\item 
\#define \hyperlink{CNSURF_8c_a5ba45740712660000cfa0d00672aea0c}{can}~((doublereal $\ast$)\&\hyperlink{XNUMBR_8c_aa957bf0809cdc5dc0b1ac20f58f60d60}{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1} + 40)
\item 
\#define \hyperlink{CNSURF_8c_a68d3ba380c16e286247bb69367760615}{canon}~((doublereal $\ast$)\&\hyperlink{XNUMBR_8c_aa957bf0809cdc5dc0b1ac20f58f60d60}{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1})
\item 
\#define \hyperlink{CNSURF_8c_a046eb84c6e1d8dee3e013f5255c2467d}{sscan}~((doublereal $\ast$)\&\hyperlink{XNUMBR_8c_aa957bf0809cdc5dc0b1ac20f58f60d60}{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1} + 40)
\item 
\#define \hyperlink{CNSURF_8c_a2f226f15c00130b05db70054f6514916}{bcanon}~((doublereal $\ast$)\&\hyperlink{XNUMBR_8c_aa957bf0809cdc5dc0b1ac20f58f60d60}{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1} + 40)
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{CNSURF_8c_ac78829905fa0a953daade27a36d7111f}{cnsurf\+\_\+} (doublereal $\ast$\hyperlink{TAPOP_8c_a1031e94780c31bfd9818821446b757cc}{u}, doublereal $\ast$\hyperlink{ZSURF_8c_a628b7f3f5aeb2a45107c95273a05a7bf}{v}, doublereal $\ast$\hyperlink{TLNORM_8c_a32dd5c98fee19eac3d7d7737e3482023}{b}, doublereal $\ast$\hyperlink{INTTPL_8c_a3d64207bd438c7bb10bfc8a45697be2a}{spv}, integer $\ast$\hyperlink{SSV3_8c_ad662923de9cd4e8699f82b58327e3c7b}{iflag}, integer $\ast$\hyperlink{SSV3_8c_a9764d5ed8d6d5b708278f417d3d43568}{mmode})
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\begin{tabbing}
xx\=xx\=xx\=xx\=xx\=xx\=xx\=xx\=xx\=\kill
struct \{\\
\>doublereal \hyperlink{CNSURF_8c_ac9e1ba82c0ed916fb992cf8f72d92ac0}{com} \mbox{[}36000\mbox{]}\\
\} \hyperlink{CNSURF_8c_ac2df3d91bb916d95685631296b8bf7c4}{\_BLNK\_\_}\\

\end{tabbing}\item 
static integer \hyperlink{CNSURF_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\+\_\+\+\_\+1} = 1
\item 
static integer \hyperlink{CNSURF_8c_a0eeed1e607f74578e1b4643f08de6f36}{c\+\_\+\+\_\+8} = 8
\item 
static doublereal \hyperlink{CNSURF_8c_a945e9f60d9fc74e5736530a7341feaaa}{c\+\_\+b14} = 10.
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\index{C\+N\+S\+U\+R\+F.\+c@{C\+N\+S\+U\+R\+F.\+c}!\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1@{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1}}
\index{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1@{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1}!C\+N\+S\+U\+R\+F.\+c@{C\+N\+S\+U\+R\+F.\+c}}
\subsubsection[{\texorpdfstring{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1}{_BLNK__1}}]{\setlength{\rightskip}{0pt plus 5cm}\#define \+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1~{\bf \+\_\+\+B\+L\+N\+K\+\_\+\+\_\+}}\hypertarget{CNSURF_8c_aa957bf0809cdc5dc0b1ac20f58f60d60}{}\label{CNSURF_8c_aa957bf0809cdc5dc0b1ac20f58f60d60}


Definition at line 21 of file C\+N\+S\+U\+R\+F.\+c.

\index{C\+N\+S\+U\+R\+F.\+c@{C\+N\+S\+U\+R\+F.\+c}!bcanon@{bcanon}}
\index{bcanon@{bcanon}!C\+N\+S\+U\+R\+F.\+c@{C\+N\+S\+U\+R\+F.\+c}}
\subsubsection[{\texorpdfstring{bcanon}{bcanon}}]{\setlength{\rightskip}{0pt plus 5cm}\#define bcanon~((doublereal $\ast$)\&{\bf \+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1} + 40)}\hypertarget{CNSURF_8c_a2f226f15c00130b05db70054f6514916}{}\label{CNSURF_8c_a2f226f15c00130b05db70054f6514916}
\index{C\+N\+S\+U\+R\+F.\+c@{C\+N\+S\+U\+R\+F.\+c}!can@{can}}
\index{can@{can}!C\+N\+S\+U\+R\+F.\+c@{C\+N\+S\+U\+R\+F.\+c}}
\subsubsection[{\texorpdfstring{can}{can}}]{\setlength{\rightskip}{0pt plus 5cm}\#define can~((doublereal $\ast$)\&{\bf \+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1} + 40)}\hypertarget{CNSURF_8c_a5ba45740712660000cfa0d00672aea0c}{}\label{CNSURF_8c_a5ba45740712660000cfa0d00672aea0c}
\index{C\+N\+S\+U\+R\+F.\+c@{C\+N\+S\+U\+R\+F.\+c}!canon@{canon}}
\index{canon@{canon}!C\+N\+S\+U\+R\+F.\+c@{C\+N\+S\+U\+R\+F.\+c}}
\subsubsection[{\texorpdfstring{canon}{canon}}]{\setlength{\rightskip}{0pt plus 5cm}\#define canon~((doublereal $\ast$)\&{\bf \+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1})}\hypertarget{CNSURF_8c_a68d3ba380c16e286247bb69367760615}{}\label{CNSURF_8c_a68d3ba380c16e286247bb69367760615}


Referenced by cnsurf\+\_\+().

\index{C\+N\+S\+U\+R\+F.\+c@{C\+N\+S\+U\+R\+F.\+c}!sscan@{sscan}}
\index{sscan@{sscan}!C\+N\+S\+U\+R\+F.\+c@{C\+N\+S\+U\+R\+F.\+c}}
\subsubsection[{\texorpdfstring{sscan}{sscan}}]{\setlength{\rightskip}{0pt plus 5cm}\#define sscan~((doublereal $\ast$)\&{\bf \+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1} + 40)}\hypertarget{CNSURF_8c_a046eb84c6e1d8dee3e013f5255c2467d}{}\label{CNSURF_8c_a046eb84c6e1d8dee3e013f5255c2467d}


\subsection{Function Documentation}
\index{C\+N\+S\+U\+R\+F.\+c@{C\+N\+S\+U\+R\+F.\+c}!cnsurf\+\_\+@{cnsurf\+\_\+}}
\index{cnsurf\+\_\+@{cnsurf\+\_\+}!C\+N\+S\+U\+R\+F.\+c@{C\+N\+S\+U\+R\+F.\+c}}
\subsubsection[{\texorpdfstring{cnsurf\+\_\+(doublereal $\ast$u, doublereal $\ast$v, doublereal $\ast$b, doublereal $\ast$spv, integer $\ast$iflag, integer $\ast$mmode)}{cnsurf_(doublereal *u, doublereal *v, doublereal *b, doublereal *spv, integer *iflag, integer *mmode)}}]{\setlength{\rightskip}{0pt plus 5cm}int cnsurf\+\_\+ (
\begin{DoxyParamCaption}
\item[{doublereal $\ast$}]{u, }
\item[{doublereal $\ast$}]{v, }
\item[{doublereal $\ast$}]{b, }
\item[{doublereal $\ast$}]{spv, }
\item[{integer $\ast$}]{iflag, }
\item[{integer $\ast$}]{mmode}
\end{DoxyParamCaption}
)}\hypertarget{CNSURF_8c_ac78829905fa0a953daade27a36d7111f}{}\label{CNSURF_8c_ac78829905fa0a953daade27a36d7111f}


Definition at line 31 of file C\+N\+S\+U\+R\+F.\+c.



References b, c\+\_\+\+\_\+1, c\+\_\+\+\_\+8, c\+\_\+b14, canon, cnsurg\+\_\+(), cnsurh\+\_\+(), cross\+\_\+(), d1, d2, dotv\+\_\+(), eval\+\_\+(), f, holfrm\+\_\+(), i\+\_\+\+\_\+, iflag, mmode, mode, one, spv, u, u1, v, v1, and zero.



Referenced by apt109\+\_\+(), balloc\+\_\+(), balsrf\+\_\+(), cmesh\+\_\+(), dgeom\+\_\+(), evalss\+\_\+(), gop\+\_\+(), intbnd\+\_\+(), intnrm\+\_\+(), intout\+\_\+(), intsrf\+\_\+(), midpnt\+\_\+(), pchprc\+\_\+(), polmtn\+\_\+(), puvloc\+\_\+(), srfcom\+\_\+(), and sspict\+\_\+().


\begin{DoxyCode}
33 \{
34     \textcolor{comment}{/* Initialized data */}
35 
36     \textcolor{keyword}{static} doublereal \hyperlink{APT301_8c_a361b1d0588e13a7b5994f24b40138ec0}{zero} = 0.;
37     \textcolor{keyword}{static} doublereal \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one} = 1.;
38     \textcolor{keyword}{static} doublereal vsmal = 1e-9;
39     \textcolor{keyword}{static} doublereal smal = 1e-6;
40     \textcolor{keyword}{static} doublereal half = .499999;
41 
42     \textcolor{comment}{/* Builtin functions */}
43     \textcolor{keywordtype}{double} sqrt(doublereal), pow\_di(doublereal *, integer *);
44 
45     \textcolor{comment}{/* Local variables */}
46     \textcolor{keyword}{static} integer \hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_};
47     \textcolor{keyword}{static} doublereal \hyperlink{APT069_8c_a1fe17aa2ff1722c937379044a27da68a}{d1}, \hyperlink{ARLM2_8c_a2e84eabcf4365b45c8a1a5d42c540819}{d2}, d3, \hyperlink{REGION_8c_a64f8055b64cf2a4c299c841130c5c938}{u1}, \hyperlink{POLPOL_8c_ae6c3ee9933cc50ea02782419401e84f0}{v1}, du, dv, u1p, v1p, fac;
48 \textcolor{preprocessor}{#define can ((doublereal *)&\_BLNK\_\_1 + 40)}
49     \textcolor{keyword}{static} integer nct, nwd;
50     \textcolor{keyword}{static} doublereal spw[32], ainc;
51     \textcolor{keyword}{static} integer \hyperlink{APT331_8c_af613cadd5cf49515a2b8790d3bfd56af}{mode};
52     \textcolor{keyword}{extern} \textcolor{comment}{/* Subroutine */} \textcolor{keywordtype}{int} \hyperlink{EVAL_8c_a64df9f8a0665781c04785fa774479c58}{eval\_}(\textcolor{keywordtype}{char} *, doublereal *, doublereal *, 
53         doublereal *, doublereal *, integer *, ftnlen);
54     \textcolor{keyword}{static} integer iext;
55     \textcolor{keyword}{extern} \textcolor{comment}{/* Subroutine */} \textcolor{keywordtype}{int} \hyperlink{UTILTY_8c_a657f0ea34a6889bdeb8b3f35b3d9d0b5}{dotv\_}(doublereal *, doublereal *, doublereal *
56         );
57     \textcolor{keyword}{static} \textcolor{keywordtype}{char} ename[8];
58 \textcolor{preprocessor}{#define canon ((doublereal *)&\_BLNK\_\_1)}
59 \textcolor{preprocessor}{#define sscan ((doublereal *)&\_BLNK\_\_1 + 40)}
60     \textcolor{keyword}{extern} \textcolor{comment}{/* Subroutine */} \textcolor{keywordtype}{int} \hyperlink{UTILTY_8c_a58ae76ce755b09f1dcba2597c6be3859}{cross\_}(doublereal *, doublereal *, doublereal 
61         *);
62     \textcolor{keyword}{static} doublereal u1save, v1save;
63 \textcolor{preprocessor}{#define bcanon ((doublereal *)&\_BLNK\_\_1 + 40)}
64     \textcolor{keyword}{extern} \textcolor{comment}{/* Subroutine */} \textcolor{keywordtype}{int} \hyperlink{HOLFRM_8c_ad837b853605dc07f300a66c119eb7eb4}{holfrm\_}(doublereal *, \textcolor{keywordtype}{char} *, integer *, 
65         integer *, integer *, ftnlen), \hyperlink{CNSURG_8c_aeb337d8584ab211289ab0b5c0bbc770a}{cnsurg\_}(doublereal *, doublereal *,
66          doublereal *, doublereal *, integer *, integer *), \hyperlink{CNSURH_8c_aa910bd774ed90ce6681153bbdaf1dc78}{cnsurh\_}(
67         doublereal *, doublereal *, doublereal *, doublereal *, integer *,
68          integer *);
69 
70 \textcolor{comment}{/* ................................................................... */}
71 \textcolor{comment}{/* ..PURPOSE   GIVEN PATCH AND PARAMETRIC COORDINATES COMPUTE THE PATCH */}
72 \textcolor{comment}{/* ..          POINTS AND DERIVATIVES.  SEARCH LOGIC IS USED TO ATTEMPT */}
73 \textcolor{comment}{/* ..          TO FIND A NON-ZERO SURFACE NORMAL WHEN THAT NORMAL IS TOO */}
74 \textcolor{comment}{/* ..          SMALL.  WHEN PATCH COORDINATES ARE OUTSIDE THE UNIT SQUARE */}
75 \textcolor{comment}{/* ..          DATA IS COMPUTED ON THE UNIT BORDER AND EXTRAPOLATED BY A */}
76 \textcolor{comment}{/* ..          LINEAR BLEND FORMULA. */}
77 \textcolor{comment}{/* ..ARGUMENTS */}
78 \textcolor{comment}{/* ..   U,V -  INPUT  PARAMETRIC U,V COORDINATES OF PATCH. */}
79 \textcolor{comment}{/* ..   B   -  INPUT PATCH COEFFICIENT ARRAY FOR BICUBIC PATCH AND PATCH */}
80 \textcolor{comment}{/* ..          TYPE FLAG ( IN B(1) ) FOR GENCUR PATCH */}
81 \textcolor{comment}{/* ..   SPV -  OUTPUT  POINT AND DERIVATIVES OF PATCH AT U,V POSITION */}
82 \textcolor{comment}{/* ..          SPV(1-3)=POINT, SPV(5-8)=DP/DU, SPV(9-11)=DP/DV, */}
83 \textcolor{comment}{/* ..          SPV(13-15)=DDP/DUU, SPV(17-19)=DDP/DUV, SPV(21-23)=DDP/DVV */}
84 \textcolor{comment}{/* ..          SPV(25-27)= DP/DU X DP/DV,  SPV(29-31)=NORM OF SPV(25-27) */}
85 \textcolor{comment}{/* ..          SPV(4,8,12,..)=1 IF ARRAY IS SET, =0 IF NOT SET. */}
86 \textcolor{comment}{/* ..   IFLAG  INPUT MATRIX FLAGS FOR BICUBIC PATCH AND LOCAL POINTERS */}
87 \textcolor{comment}{/* ..          FOR GENCUR PATCH CURVES. */}
88 \textcolor{comment}{/* ..   MMODE  INPUT  =0 MEANS CALCULATE PATCH POINT ONLY. */}
89 \textcolor{comment}{/* ..                 =1 MEANS CALCULATE POINT AND DERIVATIVES(SPV) */}
90 
91 \textcolor{comment}{/* ..CALLED BY APT109 BALLOC BALSRF DGEOM  PCHPRC PUVLOC SRFCOM SSPICT */}
92 \textcolor{comment}{/* ..CALLS     CNSURG CNSURH CROSS  DMIN1  DMAX1  DOTV   DSQRT */}
93 \textcolor{comment}{/* ..ERRORS    NO PROGRAMMED ERROR MODES. */}
94 \textcolor{comment}{/* ..RESTRICTIONS */}
95 \textcolor{comment}{/* ..          SEARCH LOGIC TO RETRIEVE A NON-ZERO NORMAL MAY NOT */}
96 \textcolor{comment}{/* ..          SUCCEED.  IN THAT CASE NORMAL IS SET TO ZERO.  ALSO */}
97 \textcolor{comment}{/* ..          SURFACE NORMAL ORIENTATION MAY BE REVERSED IN AREAS */}
98 \textcolor{comment}{/* ..          OF COLLAPSING EXTENSIONS. */}
99 \textcolor{comment}{/* ..LOCAL VARIABLES */}
100 \textcolor{comment}{/* ..   AINC   VARIABLE TO CONTROL THE PARAMETRIC INCREMENT FOR SEARCHING */}
101 \textcolor{comment}{/* ..   MODE   VARIABLE TO CONTROL NUMBER OF DERIVATIVES CALCULATED */}
102 \textcolor{comment}{/* ..          =MMODE, BUT =1 ALWAYS ON LINEAR EXTENSIONS OF SURFACE */}
103 \textcolor{comment}{/* ..   NCT    THE NUMBER OF SEARCH ATTEMPTS */}
104 \textcolor{comment}{/* ..   SPW    A BUFFER TO HOLD CURRENT SURFACE PT AND DERIVATIVES WHILE */}
105 \textcolor{comment}{/* ..          SEARCHING FOR A NON ZERO NORMAL OR EXTRAPOLATING DATA ON */}
106 \textcolor{comment}{/* ..          EXTENSIONS */}
107 \textcolor{comment}{/* ..   U1,V1  THE CLOSEST POINT IN THE UNIT SQUARE TO U,V */}
108 \textcolor{comment}{/* ..   VSMAL  FIXED VARIABLE USED TO JUDGE WHEN A VECTOR LENGTH IS SMALL */}
109 \textcolor{comment}{/* ................................................................... */}
110 
111 
112 
113 
114 \textcolor{comment}{/*     UNLABELLED COMMON */}
115 
116 \textcolor{comment}{/* ---     SIZE OF BLANK COMMON IS ALLOCATED RIGHT HERE. */}
117 
118 
119 
120 
121     \textcolor{comment}{/* Parameter adjustments */}
122     --\hyperlink{ATAPE_8c_ad662923de9cd4e8699f82b58327e3c7b}{iflag};
123     --\hyperlink{INTBND_8c_a3d64207bd438c7bb10bfc8a45697be2a}{spv};
124     --\hyperlink{APT102_8c_ab2d05693952610f937e5acb3c4a8fa1b}{b};
125 
126     \textcolor{comment}{/* Function Body */}
127 
128 \textcolor{comment}{/* ---/STEP 1/   PREPARATION */}
129 \textcolor{comment}{/* ---      SET U1,V1 TO CLOSEST POINT IN UNIT SQUARE TO U,V */}
130 \textcolor{comment}{/* ---      WHEN U,V IS OUTSIDE THE UNIT SQUARE THE SURFACE POINT */}
131 \textcolor{comment}{/* ---      AND DERIVATIVES ARE EXTRAPOLATED FROM DATA ON THE BORDER. */}
132     u1 = *\hyperlink{APT088_8c_a1f9aca42e2010bb82488684dee1a66ea}{u};
133     v1 = *\hyperlink{AERR2_8c_ab44777b30b9087bd3c98cfad93128179}{v};
134     u1 = min(one,u1);
135     u1 = max(zero,u1);
136     v1 = min(one,v1);
137     v1 = max(zero,v1);
138     mode = *\hyperlink{SSDEF_8c_af4f5a097223e7eee43089d20536eb1ef}{mmode};
139     iext = 0;
140     \textcolor{keywordflow}{if} (*\hyperlink{APT088_8c_a1f9aca42e2010bb82488684dee1a66ea}{u} == u1 && *\hyperlink{AERR2_8c_ab44777b30b9087bd3c98cfad93128179}{v} == v1) \{
141     \textcolor{keywordflow}{goto} L5;
142     \}
143 \textcolor{comment}{/* ---      U,V IS OUTSIDE THE UNIT SQUARE, EXTRAPOLATION REQUIRED. */}
144     iext = 1;
145     mode = 1;
146 L5:
147 
148 \textcolor{comment}{/* --- NCT IS THE COUNTER WHICH KEEPS TRACK OF THE NUMBER OF TRIALS */}
149 \textcolor{comment}{/* --- WITHIN CNSURF WHENEVER TROUBLE IS ENCOUNTERED IN FINDING A NORMAL */}
150     nct = 0;
151 \textcolor{comment}{/* ---    AINC IS STARTING FACTOR FOR ALTERATION OF U-V VALUES */}
152 \textcolor{comment}{/* ---    WHILE SEARCHING FOR A NON DEGENERATE SURFACE NORMAL */}
153     ainc = 1e-9\hyperlink{APT102_8c_a7a51ed112e9b79f89e3e70beb8db8bf5}{f};
154 \textcolor{comment}{/* ---      SAVE U1,V1 VALUES, AS THEY MAY BE CHANGED BY A SEARCH */}
155     u1save = \hyperlink{REGION_8c_a64f8055b64cf2a4c299c841130c5c938}{u1};
156     v1save = \hyperlink{POLPOL_8c_ae6c3ee9933cc50ea02782419401e84f0}{v1};
157 
158 L1:
159 \textcolor{comment}{/* ---/STEP 2/   PATCH DERIVATIVES */}
160 
161 \textcolor{comment}{/* ---    EXTRACT SURFACE POINT AND DERIVATIVES AT U,V VALUES */}
162 \textcolor{comment}{/* ---     INTERPOLATE SURF PT AND DERIVS AS RATIONAL BICUBIC. */}
163     \textcolor{keywordflow}{if} (\hyperlink{ATAPE_8c_ad662923de9cd4e8699f82b58327e3c7b}{iflag}[1] > 9) \{
164     \textcolor{keywordflow}{goto} L7;
165     \}
166     \hyperlink{CNSURG_8c_aeb337d8584ab211289ab0b5c0bbc770a}{cnsurg\_}(&u1, &v1, &\hyperlink{APT102_8c_ab2d05693952610f937e5acb3c4a8fa1b}{b}[1], spw, &\hyperlink{ATAPE_8c_ad662923de9cd4e8699f82b58327e3c7b}{iflag}[1], &mode);
167     \textcolor{keywordflow}{goto} L6;
168 \textcolor{comment}{/* ---     INTERPOLATE SURF PT AND DERIVS AS GENCUR PATCH */}
169 L7:
170     \textcolor{keywordflow}{if} (\hyperlink{ATAPE_8c_ad662923de9cd4e8699f82b58327e3c7b}{iflag}[2] == 0) \{
171     \textcolor{keywordflow}{goto} L8;
172     \}
173     \hyperlink{CNSURH_8c_aa910bd774ed90ce6681153bbdaf1dc78}{cnsurh\_}(&u1, &v1, &\hyperlink{APT102_8c_ab2d05693952610f937e5acb3c4a8fa1b}{b}[1], spw, &\hyperlink{ATAPE_8c_ad662923de9cd4e8699f82b58327e3c7b}{iflag}[1], &mode);
174     \textcolor{keywordflow}{goto} L6;
175 \textcolor{comment}{/* ---     INTERPOLATE SURF PT AND DERIVS AS FOREIGN PATCH */}
176 L8:
177     \hyperlink{HOLFRM_8c_ad837b853605dc07f300a66c119eb7eb4}{holfrm\_}(&\hyperlink{APT102_8c_ab2d05693952610f937e5acb3c4a8fa1b}{b}[1], ename, &\hyperlink{CNSURF_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{CNSURF_8c_a0eeed1e607f74578e1b4643f08de6f36}{c\_\_8}, &nwd, (ftnlen)8);
178     \hyperlink{EVAL_8c_a64df9f8a0665781c04785fa774479c58}{eval\_}(ename, &u1, &v1, &\hyperlink{CNSURF_8c_a68d3ba380c16e286247bb69367760615}{canon}[\hyperlink{ATAPE_8c_ad662923de9cd4e8699f82b58327e3c7b}{iflag}[1] - 1], spw, &mode, (ftnlen)8);
179 
180 \textcolor{comment}{/* ---      SAVE SURFACE POINT ON FIRST PASS */}
181 L6:
182     \textcolor{keywordflow}{if} (nct != 0) \{
183     \textcolor{keywordflow}{goto} L3;
184     \}
185     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= 3; ++\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}) \{
186 \textcolor{comment}{/* L2: */}
187     \hyperlink{INTBND_8c_a3d64207bd438c7bb10bfc8a45697be2a}{spv}[\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}] = spw[i\_\_ - 1];
188     \}
189     \hyperlink{INTBND_8c_a3d64207bd438c7bb10bfc8a45697be2a}{spv}[4] = \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one};
190 L3:
191 
192 \textcolor{comment}{/* ---      SKIP NORMAL CHECKING WHEN ONLY POINT IS DESIRED */}
193     \textcolor{keywordflow}{if} (*\hyperlink{SSDEF_8c_af4f5a097223e7eee43089d20536eb1ef}{mmode} == 0) \{
194     \textcolor{keywordflow}{goto} L400;
195     \}
196 \textcolor{comment}{/* ---/STEP 3/   SIGNIFICANCE OF DERIVATIVES */}
197 \textcolor{comment}{/* ---    EXAMINE SURFACE NORMAL FOR NON DEGENERACY */}
198     \hyperlink{UTILTY_8c_a58ae76ce755b09f1dcba2597c6be3859}{cross\_}(&spw[4], &spw[8], &spw[24]);
199     \hyperlink{UTILTY_8c_a657f0ea34a6889bdeb8b3f35b3d9d0b5}{dotv\_}(&d3, &spw[24], &spw[24]);
200     d3 = sqrt(d3);
201     \textcolor{keywordflow}{if} (d3 > vsmal) \{
202     \textcolor{keywordflow}{goto} L310;
203     \}
204 \textcolor{comment}{/* ---    SURFACE NORMAL MAGNITUDE IS SMALL SO EXAMINE FURTHER */}
205 \textcolor{comment}{/* ---    FIND MAGNITUDES OF TANSPL AND CRSSPL VECTORS */}
206     \hyperlink{UTILTY_8c_a657f0ea34a6889bdeb8b3f35b3d9d0b5}{dotv\_}(&d1, &spw[4], &spw[4]);
207     d1 = sqrt(d1);
208     \hyperlink{UTILTY_8c_a657f0ea34a6889bdeb8b3f35b3d9d0b5}{dotv\_}(&d2, &spw[8], &spw[8]);
209     d2 = sqrt(d2);
210 \textcolor{comment}{/* ---    IF EITHER TANGENT VECTOR IS SMALL, FIND NEW U,V */}
211     \textcolor{keywordflow}{if} (d1 < vsmal || d2 < vsmal) \{
212     \textcolor{keywordflow}{goto} L309;
213     \}
214 \textcolor{comment}{/* ---    FINALLY CHECK ANGULAR SPREAD BETWEEN TANSPL AND CRSSPL */}
215     \textcolor{keywordflow}{if} (d3 > smal * d1 * d2) \{
216     \textcolor{keywordflow}{goto} L310;
217     \}
218 
219 L309:
220 \textcolor{comment}{/* ---/STEP 4/   ALTER COORDINATES */}
221 \textcolor{comment}{/* ---    OBTAIN A NEW U,V AND TRY FOR A CLEARER SURFACE NORMAL */}
222     ++nct;
223 \textcolor{comment}{/* ---    QUIT AFTER 8 TRIALS */}
224     \textcolor{keywordflow}{if} (nct > 8) \{
225     \textcolor{keywordflow}{goto} L310;
226     \}
227     fac = one - vsmal * pow\_di(&\hyperlink{CNSURF_8c_a945e9f60d9fc74e5736530a7341feaaa}{c\_b14}, &nct);
228     u1 = (u1save - half) * fac + half;
229     v1 = (v1save - half) * fac + half;
230 \textcolor{comment}{/* ---    RECYCLE TO CHECK WHETHER NEW NORMAL IS DEFINED */}
231     \textcolor{keywordflow}{goto} L1;
232 
233 \textcolor{comment}{/* ---/STEP 5/   CONSOLIDATE PATCH DERIVATIVES */}
234 L310:
235 \textcolor{comment}{/* ---      RESTORE U1,V1 AND COMPUTE UNIT NORMAL */}
236     u1 = u1save;
237     v1 = v1save;
238     \textcolor{keywordflow}{if} (d3 == zero) \{
239     d3 = \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one};
240     \}
241     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= 3; ++\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}) \{
242     spw[i\_\_ - 1] = \hyperlink{INTBND_8c_a3d64207bd438c7bb10bfc8a45697be2a}{spv}[\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}];
243     spw[i\_\_ + 27] = spw[i\_\_ + 23] / d3;
244 \textcolor{comment}{/* L311: */}
245     \}
246 
247 \textcolor{comment}{/* ---      FINAL STEP, EXTRAPOLATE SURFACE PT AND DERIVS IF POINT */}
248 \textcolor{comment}{/* ---      IS OUTSIDE THE UNIT SQUARE. */}
249 L400:
250     \textcolor{keywordflow}{if} (iext != 0) \{
251     \textcolor{keywordflow}{goto} L410;
252     \}
253     \textcolor{keywordflow}{if} (*\hyperlink{SSDEF_8c_af4f5a097223e7eee43089d20536eb1ef}{mmode} == 0) \{
254     \textcolor{keywordflow}{goto} L490;
255     \}
256 \textcolor{comment}{/* ---      TRANSFER DERIVATIVES TO SPV ARRAY */}
257     \textcolor{keywordflow}{for} (i\_\_ = 5; i\_\_ <= 32; ++\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}) \{
258 \textcolor{comment}{/* L405: */}
259     \hyperlink{INTBND_8c_a3d64207bd438c7bb10bfc8a45697be2a}{spv}[\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}] = spw[i\_\_ - 1];
260     \}
261     \textcolor{keywordflow}{goto} L490;
262 
263 L410:
264 \textcolor{comment}{/* ---/STEP 6/   DERIVATIVES EXTRAPOLATED TO PATCH EXTENSION. */}
265     du = *\hyperlink{APT088_8c_a1f9aca42e2010bb82488684dee1a66ea}{u} - \hyperlink{REGION_8c_a64f8055b64cf2a4c299c841130c5c938}{u1};
266     dv = *\hyperlink{AERR2_8c_ab44777b30b9087bd3c98cfad93128179}{v} - \hyperlink{POLPOL_8c_ae6c3ee9933cc50ea02782419401e84f0}{v1};
267 \textcolor{comment}{/* ---      U1 IS A FUNCTION OF U.  U1P IS RATE OF CHANGE OF U1 WRT U. */}
268 \textcolor{comment}{/* ---      SIMILARLY FOR V1 AND V1P. */}
269     u1p = \hyperlink{APT301_8c_a361b1d0588e13a7b5994f24b40138ec0}{zero};
270     \textcolor{keywordflow}{if} (*\hyperlink{APT088_8c_a1f9aca42e2010bb82488684dee1a66ea}{u} == u1) \{
271     u1p = \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one};
272     \}
273     v1p = \hyperlink{APT301_8c_a361b1d0588e13a7b5994f24b40138ec0}{zero};
274     \textcolor{keywordflow}{if} (*\hyperlink{AERR2_8c_ab44777b30b9087bd3c98cfad93128179}{v} == v1) \{
275     v1p = \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one};
276     \}
277     \hyperlink{INTBND_8c_a3d64207bd438c7bb10bfc8a45697be2a}{spv}[4] = \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one};
278 \textcolor{comment}{/* ---      EXTRAPOLATION FORMULA IS AS FOLLOWS */}
279 \textcolor{comment}{/* ---      SPV = SPW + DU*SPW-U +DV*SPW-V + DU*DV*SPW-UV */}
280     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= 3; ++\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}) \{
281     \hyperlink{INTBND_8c_a3d64207bd438c7bb10bfc8a45697be2a}{spv}[\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}] = spw[i\_\_ - 1] + du * spw[i\_\_ + 3] + dv * (spw[i\_\_ + 7] + du 
282         * spw[i\_\_ + 15]);
283     \textcolor{keywordflow}{if} (*\hyperlink{SSDEF_8c_af4f5a097223e7eee43089d20536eb1ef}{mmode} == 0) \{
284         \textcolor{keywordflow}{goto} L430;
285     \}
286     \hyperlink{INTBND_8c_a3d64207bd438c7bb10bfc8a45697be2a}{spv}[i\_\_ + 4] = spw[i\_\_ + 3] + dv * spw[i\_\_ + 15];
287     \hyperlink{INTBND_8c_a3d64207bd438c7bb10bfc8a45697be2a}{spv}[i\_\_ + 8] = spw[i\_\_ + 7] + du * spw[i\_\_ + 15];
288     \hyperlink{INTBND_8c_a3d64207bd438c7bb10bfc8a45697be2a}{spv}[i\_\_ + 12] = u1p * spw[i\_\_ + 11];
289     \hyperlink{INTBND_8c_a3d64207bd438c7bb10bfc8a45697be2a}{spv}[i\_\_ + 16] = spw[i\_\_ + 15];
290     \hyperlink{INTBND_8c_a3d64207bd438c7bb10bfc8a45697be2a}{spv}[i\_\_ + 20] = v1p * spw[i\_\_ + 19];
291 L430:
292     ;
293     \}
294     \textcolor{keywordflow}{if} (*\hyperlink{SSDEF_8c_af4f5a097223e7eee43089d20536eb1ef}{mmode} == 0) \{
295     \textcolor{keywordflow}{goto} L490;
296     \}
297     \hyperlink{UTILTY_8c_a58ae76ce755b09f1dcba2597c6be3859}{cross\_}(&\hyperlink{INTBND_8c_a3d64207bd438c7bb10bfc8a45697be2a}{spv}[5], &\hyperlink{INTBND_8c_a3d64207bd438c7bb10bfc8a45697be2a}{spv}[9], &\hyperlink{INTBND_8c_a3d64207bd438c7bb10bfc8a45697be2a}{spv}[25]);
298     \hyperlink{UTILTY_8c_a657f0ea34a6889bdeb8b3f35b3d9d0b5}{dotv\_}(&d1, &\hyperlink{INTBND_8c_a3d64207bd438c7bb10bfc8a45697be2a}{spv}[25], &\hyperlink{INTBND_8c_a3d64207bd438c7bb10bfc8a45697be2a}{spv}[25]);
299     d1 = sqrt(d1);
300     \textcolor{keywordflow}{if} (d1 == zero) \{
301     d1 = \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one};
302     \}
303     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= 3; ++\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}) \{
304 \textcolor{comment}{/* L440: */}
305     \hyperlink{INTBND_8c_a3d64207bd438c7bb10bfc8a45697be2a}{spv}[i\_\_ + 28] = \hyperlink{INTBND_8c_a3d64207bd438c7bb10bfc8a45697be2a}{spv}[i\_\_ + 24] / \hyperlink{APT069_8c_a1fe17aa2ff1722c937379044a27da68a}{d1};
306     \}
307 L490:
308 \textcolor{comment}{/* ---      SET FLAGS FOR DERIVATIVES */}
309     \textcolor{keywordflow}{if} (*\hyperlink{SSDEF_8c_af4f5a097223e7eee43089d20536eb1ef}{mmode} == 0) \{
310     \textcolor{keywordflow}{goto} L999;
311     \}
312     \textcolor{keywordflow}{for} (i\_\_ = 8; i\_\_ <= 32; i\_\_ += 4) \{
313 \textcolor{comment}{/* L495: */}
314     \hyperlink{INTBND_8c_a3d64207bd438c7bb10bfc8a45697be2a}{spv}[\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}] = \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one};
315     \}
316 
317 L999:
318     \textcolor{keywordflow}{return} 0;
319 \} \textcolor{comment}{/* cnsurf\_ */}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{CNSURF_8c_ac78829905fa0a953daade27a36d7111f_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{CNSURF_8c_ac78829905fa0a953daade27a36d7111f_icgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\index{C\+N\+S\+U\+R\+F.\+c@{C\+N\+S\+U\+R\+F.\+c}!\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+@{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+}}
\index{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+@{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+}!C\+N\+S\+U\+R\+F.\+c@{C\+N\+S\+U\+R\+F.\+c}}
\subsubsection[{\texorpdfstring{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+}{_BLNK__}}]{\setlength{\rightskip}{0pt plus 5cm}struct \{ ... \}   \+\_\+\+B\+L\+N\+K\+\_\+\+\_\+}\hypertarget{CNSURF_8c_ac2df3d91bb916d95685631296b8bf7c4}{}\label{CNSURF_8c_ac2df3d91bb916d95685631296b8bf7c4}
\index{C\+N\+S\+U\+R\+F.\+c@{C\+N\+S\+U\+R\+F.\+c}!c\+\_\+\+\_\+1@{c\+\_\+\+\_\+1}}
\index{c\+\_\+\+\_\+1@{c\+\_\+\+\_\+1}!C\+N\+S\+U\+R\+F.\+c@{C\+N\+S\+U\+R\+F.\+c}}
\subsubsection[{\texorpdfstring{c\+\_\+\+\_\+1}{c__1}}]{\setlength{\rightskip}{0pt plus 5cm}integer c\+\_\+\+\_\+1 = 1\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{CNSURF_8c_aac061f9822f71d2164eeeaae0e2a342c}{}\label{CNSURF_8c_aac061f9822f71d2164eeeaae0e2a342c}


Definition at line 25 of file C\+N\+S\+U\+R\+F.\+c.



Referenced by cnsurf\+\_\+().

\index{C\+N\+S\+U\+R\+F.\+c@{C\+N\+S\+U\+R\+F.\+c}!c\+\_\+\+\_\+8@{c\+\_\+\+\_\+8}}
\index{c\+\_\+\+\_\+8@{c\+\_\+\+\_\+8}!C\+N\+S\+U\+R\+F.\+c@{C\+N\+S\+U\+R\+F.\+c}}
\subsubsection[{\texorpdfstring{c\+\_\+\+\_\+8}{c__8}}]{\setlength{\rightskip}{0pt plus 5cm}integer c\+\_\+\+\_\+8 = 8\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{CNSURF_8c_a0eeed1e607f74578e1b4643f08de6f36}{}\label{CNSURF_8c_a0eeed1e607f74578e1b4643f08de6f36}


Definition at line 26 of file C\+N\+S\+U\+R\+F.\+c.



Referenced by cnsurf\+\_\+().

\index{C\+N\+S\+U\+R\+F.\+c@{C\+N\+S\+U\+R\+F.\+c}!c\+\_\+b14@{c\+\_\+b14}}
\index{c\+\_\+b14@{c\+\_\+b14}!C\+N\+S\+U\+R\+F.\+c@{C\+N\+S\+U\+R\+F.\+c}}
\subsubsection[{\texorpdfstring{c\+\_\+b14}{c_b14}}]{\setlength{\rightskip}{0pt plus 5cm}doublereal c\+\_\+b14 = 10.\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{CNSURF_8c_a945e9f60d9fc74e5736530a7341feaaa}{}\label{CNSURF_8c_a945e9f60d9fc74e5736530a7341feaaa}


Definition at line 27 of file C\+N\+S\+U\+R\+F.\+c.



Referenced by cnsurf\+\_\+().

\index{C\+N\+S\+U\+R\+F.\+c@{C\+N\+S\+U\+R\+F.\+c}!com@{com}}
\index{com@{com}!C\+N\+S\+U\+R\+F.\+c@{C\+N\+S\+U\+R\+F.\+c}}
\subsubsection[{\texorpdfstring{com}{com}}]{\setlength{\rightskip}{0pt plus 5cm}doublereal com\mbox{[}36000\mbox{]}}\hypertarget{CNSURF_8c_ac9e1ba82c0ed916fb992cf8f72d92ac0}{}\label{CNSURF_8c_ac9e1ba82c0ed916fb992cf8f72d92ac0}


Definition at line 18 of file C\+N\+S\+U\+R\+F.\+c.

