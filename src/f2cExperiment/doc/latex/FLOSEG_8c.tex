\hypertarget{FLOSEG_8c}{}\section{F\+L\+O\+S\+E\+G.\+c File Reference}
\label{FLOSEG_8c}\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
{\ttfamily \#include \char`\"{}f2c.\+h\char`\"{}}\\*
Include dependency graph for F\+L\+O\+S\+E\+G.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=145pt]{FLOSEG_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{FLOSEG_8c_aa957bf0809cdc5dc0b1ac20f58f60d60}{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1}~\hyperlink{XNUMBR_8c_a2a3eec0f18d8617877d8210266fba452}{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+}
\item 
\#define \hyperlink{FLOSEG_8c_a618688b91ef10762e933d4002925afab}{sspad\+\_\+1}~\hyperlink{SSV3_8c_a55cc1af51f82b825bacf79bfbbdb5619}{sspad\+\_\+}
\item 
\#define \hyperlink{FLOSEG_8c_aa2a88aa3f2e858e87f5074fadc0e1d8e}{ibugg\+\_\+1}~\hyperlink{XTPCAL_8c_a00d42583c036d05afed4d07a03432522}{ibugg\+\_\+}
\item 
\#define \hyperlink{FLOSEG_8c_a6a01fdbcd4e9ab45bf32c168785cc8a6}{darray\+\_\+1}~\hyperlink{XCANON_8c_a01023c467b63fbe7d0676e9952161ec5}{darray\+\_\+}
\item 
\#define \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}~((doublereal $\ast$)\&\hyperlink{SSV3_8c_a618688b91ef10762e933d4002925afab}{sspad\+\_\+1} + 1)
\item 
\#define \hyperlink{FLOSEG_8c_a5ba45740712660000cfa0d00672aea0c}{can}~((doublereal $\ast$)\&\hyperlink{XNUMBR_8c_aa957bf0809cdc5dc0b1ac20f58f60d60}{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1} + 40)
\item 
\#define \hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}~((doublereal $\ast$)\&\hyperlink{XNUMBR_8c_aa957bf0809cdc5dc0b1ac20f58f60d60}{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1})
\item 
\#define \hyperlink{FLOSEG_8c_a046eb84c6e1d8dee3e013f5255c2467d}{sscan}~((doublereal $\ast$)\&\hyperlink{XNUMBR_8c_aa957bf0809cdc5dc0b1ac20f58f60d60}{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1} + 40)
\item 
\#define \hyperlink{FLOSEG_8c_a2f226f15c00130b05db70054f6514916}{bcanon}~((doublereal $\ast$)\&\hyperlink{XNUMBR_8c_aa957bf0809cdc5dc0b1ac20f58f60d60}{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1} + 40)
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{FLOSEG_8c_ae676909061cd7cd0ffe5a99f54de2fef}{floseg\+\_\+} (integer $\ast$nsize, integer $\ast$nszsav, integer $\ast$\hyperlink{APT331_8c_af613cadd5cf49515a2b8790d3bfd56af}{mode}, integer $\ast$iflseg, integer $\ast$irr)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\begin{tabbing}
xx\=xx\=xx\=xx\=xx\=xx\=xx\=xx\=xx\=\kill
struct \{\\
\>doublereal \hyperlink{FLOSEG_8c_ac9e1ba82c0ed916fb992cf8f72d92ac0}{com} \mbox{[}36000\mbox{]}\\
\} \hyperlink{FLOSEG_8c_a5ce107cfed3c87771544f53193b59d31}{\_BLNK\_\_}\\

\end{tabbing}\item 
\begin{tabbing}
xx\=xx\=xx\=xx\=xx\=xx\=xx\=xx\=xx\=\kill
struct \{\\
\>integer \hyperlink{FLOSEG_8c_ab26b43007e1470a6812269aedc276cc4}{nscnmx}\\
\>integer \hyperlink{FLOSEG_8c_a4f36f70535ff45e43613827fb1a9c44c}{iscan}\\
\>doublereal \hyperlink{FLOSEG_8c_a054b516dd6020a563cf155a4b217ec26}{scan} \mbox{[}20000\mbox{]}\\
\} \hyperlink{FLOSEG_8c_a855e143ab6e1d6bb108e7a8bb52f7e00}{sspad\_}\\

\end{tabbing}\item 
\begin{tabbing}
xx\=xx\=xx\=xx\=xx\=xx\=xx\=xx\=xx\=\kill
struct \{\\
\>integer \hyperlink{FLOSEG_8c_acf8cd9aebbc7f97517952bf2f89ed57c}{ibug}\\
\>integer \hyperlink{FLOSEG_8c_aa7c1d3b50810f4362d609ea905340770}{ipcolc}\\
\>integer \hyperlink{FLOSEG_8c_ab16df98aac0af928eb1e69b5f3080334}{ipcolm}\\
\} \hyperlink{FLOSEG_8c_abf885136954d7c11355b87e2d6b0bd09}{ibugg\_}\\

\end{tabbing}\item 
\begin{tabbing}
xx\=xx\=xx\=xx\=xx\=xx\=xx\=xx\=xx\=\kill
struct \{\\
\>char \hyperlink{FLOSEG_8c_ad8149129b0ac5c966968e55ba6106146}{darray} \mbox{[}120\mbox{]}\\
\} \hyperlink{FLOSEG_8c_a3782325cc3240c0e554c3d8d28814ee4}{darray\_}\\

\end{tabbing}\item 
static integer \hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\+\_\+\+\_\+1} = 1
\item 
static integer \hyperlink{FLOSEG_8c_a0eeed1e607f74578e1b4643f08de6f36}{c\+\_\+\+\_\+8} = 8
\item 
static integer \hyperlink{FLOSEG_8c_ad0e41331e05e813dcc44fc78ce9d648f}{c\+\_\+n54} = -\/54
\item 
static integer \hyperlink{FLOSEG_8c_a9e9287f317ef3436252a395791a899f6}{c\+\_\+n1} = -\/1
\item 
static integer \hyperlink{FLOSEG_8c_a6a4ee26669af052a7e7fb5dda2b01f63}{c\+\_\+\+\_\+0} = 0
\item 
static integer \hyperlink{FLOSEG_8c_ab547b63b356ef99dc04f74ea358aa245}{c\+\_\+\+\_\+24} = 24
\item 
static integer \hyperlink{FLOSEG_8c_a900642cfb0fdb02c80380e0b73330cb5}{c\+\_\+n4} = -\/4
\item 
static integer \hyperlink{FLOSEG_8c_a7edaec1331969a1fc0e86088d783286e}{c\+\_\+\+\_\+48} = 48
\item 
static integer \hyperlink{FLOSEG_8c_ab195470f8c6d55e333ee709af09ba2d6}{c\+\_\+\+\_\+4} = 4
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1@{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1}}
\index{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1@{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1}{_BLNK__1}}]{\setlength{\rightskip}{0pt plus 5cm}\#define \+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1~{\bf \+\_\+\+B\+L\+N\+K\+\_\+\+\_\+}}\hypertarget{FLOSEG_8c_aa957bf0809cdc5dc0b1ac20f58f60d60}{}\label{FLOSEG_8c_aa957bf0809cdc5dc0b1ac20f58f60d60}


Definition at line 21 of file F\+L\+O\+S\+E\+G.\+c.

\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!bcanon@{bcanon}}
\index{bcanon@{bcanon}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{bcanon}{bcanon}}]{\setlength{\rightskip}{0pt plus 5cm}\#define bcanon~((doublereal $\ast$)\&{\bf \+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1} + 40)}\hypertarget{FLOSEG_8c_a2f226f15c00130b05db70054f6514916}{}\label{FLOSEG_8c_a2f226f15c00130b05db70054f6514916}
\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!can@{can}}
\index{can@{can}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{can}{can}}]{\setlength{\rightskip}{0pt plus 5cm}\#define can~((doublereal $\ast$)\&{\bf \+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1} + 40)}\hypertarget{FLOSEG_8c_a5ba45740712660000cfa0d00672aea0c}{}\label{FLOSEG_8c_a5ba45740712660000cfa0d00672aea0c}
\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!canon@{canon}}
\index{canon@{canon}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{canon}{canon}}]{\setlength{\rightskip}{0pt plus 5cm}\#define canon~((doublereal $\ast$)\&{\bf \+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1})}\hypertarget{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{}\label{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}


Referenced by floseg\+\_\+().

\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!darray\+\_\+1@{darray\+\_\+1}}
\index{darray\+\_\+1@{darray\+\_\+1}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{darray\+\_\+1}{darray_1}}]{\setlength{\rightskip}{0pt plus 5cm}\#define darray\+\_\+1~{\bf darray\+\_\+}}\hypertarget{FLOSEG_8c_a6a01fdbcd4e9ab45bf32c168785cc8a6}{}\label{FLOSEG_8c_a6a01fdbcd4e9ab45bf32c168785cc8a6}


Definition at line 40 of file F\+L\+O\+S\+E\+G.\+c.



Referenced by floseg\+\_\+().

\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!ibugg\+\_\+1@{ibugg\+\_\+1}}
\index{ibugg\+\_\+1@{ibugg\+\_\+1}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{ibugg\+\_\+1}{ibugg_1}}]{\setlength{\rightskip}{0pt plus 5cm}\#define ibugg\+\_\+1~{\bf ibugg\+\_\+}}\hypertarget{FLOSEG_8c_aa2a88aa3f2e858e87f5074fadc0e1d8e}{}\label{FLOSEG_8c_aa2a88aa3f2e858e87f5074fadc0e1d8e}


Definition at line 34 of file F\+L\+O\+S\+E\+G.\+c.



Referenced by floseg\+\_\+().

\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!sscan@{sscan}}
\index{sscan@{sscan}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{sscan}{sscan}}]{\setlength{\rightskip}{0pt plus 5cm}\#define sscan~((doublereal $\ast$)\&{\bf \+\_\+\+B\+L\+N\+K\+\_\+\+\_\+1} + 40)}\hypertarget{FLOSEG_8c_a046eb84c6e1d8dee3e013f5255c2467d}{}\label{FLOSEG_8c_a046eb84c6e1d8dee3e013f5255c2467d}
\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!sspad\+\_\+1@{sspad\+\_\+1}}
\index{sspad\+\_\+1@{sspad\+\_\+1}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{sspad\+\_\+1}{sspad_1}}]{\setlength{\rightskip}{0pt plus 5cm}\#define sspad\+\_\+1~{\bf sspad\+\_\+}}\hypertarget{FLOSEG_8c_a618688b91ef10762e933d4002925afab}{}\label{FLOSEG_8c_a618688b91ef10762e933d4002925afab}


Definition at line 28 of file F\+L\+O\+S\+E\+G.\+c.

\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!st@{st}}
\index{st@{st}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{st}{st}}]{\setlength{\rightskip}{0pt plus 5cm}\#define st~((doublereal $\ast$)\&{\bf sspad\+\_\+1} + 1)}\hypertarget{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{}\label{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}


Referenced by floseg\+\_\+().



\subsection{Function Documentation}
\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!floseg\+\_\+@{floseg\+\_\+}}
\index{floseg\+\_\+@{floseg\+\_\+}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{floseg\+\_\+(integer $\ast$nsize, integer $\ast$nszsav, integer $\ast$mode, integer $\ast$iflseg, integer $\ast$irr)}{floseg_(integer *nsize, integer *nszsav, integer *mode, integer *iflseg, integer *irr)}}]{\setlength{\rightskip}{0pt plus 5cm}int floseg\+\_\+ (
\begin{DoxyParamCaption}
\item[{integer $\ast$}]{nsize, }
\item[{integer $\ast$}]{nszsav, }
\item[{integer $\ast$}]{mode, }
\item[{integer $\ast$}]{iflseg, }
\item[{integer $\ast$}]{irr}
\end{DoxyParamCaption}
)}\hypertarget{FLOSEG_8c_ae676909061cd7cd0ffe5a99f54de2fef}{}\label{FLOSEG_8c_ae676909061cd7cd0ffe5a99f54de2fef}


Definition at line 56 of file F\+L\+O\+S\+E\+G.\+c.



References an1, an2, angseg\+\_\+(), arcseg\+\_\+(), bad\+\_\+(), c\+\_\+\+\_\+0, c\+\_\+\+\_\+1, c\+\_\+\+\_\+24, c\+\_\+\+\_\+4, c\+\_\+\+\_\+48, c\+\_\+\+\_\+8, c\+\_\+n1, c\+\_\+n4, c\+\_\+n54, canon, cform\+\_\+(), chdseg\+\_\+(), chord, cncurv\+\_\+(), cprint\+\_\+(), darray\+\_\+1, error\+\_\+(), f, holfrm\+\_\+(), i1, i2, i\+\_\+\+\_\+, ibugg\+\_\+1, ierror, ii, ir, iseg, j, jj, k, l, length, m, npts, num, one, param, point, pp, seg, st, t, test, tol, vector, and zero.



Referenced by apt108\+\_\+().


\begin{DoxyCode}
58 \{
59     \textcolor{comment}{/* Initialized data */}
60 
61     \textcolor{keyword}{static} doublereal areal = 21.;
62     \textcolor{keyword}{static} doublereal aflow = 149.;
63     \textcolor{keyword}{static} doublereal aseg = 150.;
64     \textcolor{keyword}{static} integer maxsc = 96;
65     \textcolor{keyword}{static} integer lstemx = 100;
66     \textcolor{keyword}{static} \textcolor{keywordtype}{char} \hyperlink{AERR2_8c_a047a9207c2bd2bc497e8815a70636f32}{seg}[8] = \textcolor{stringliteral}{"SEG     "};
67     \textcolor{keyword}{static} \textcolor{keywordtype}{char} arc[8] = \textcolor{stringliteral}{"ARC     "};
68     \textcolor{keyword}{static} \textcolor{keywordtype}{char} \hyperlink{APT301_8c_acff701cfc8fab0de8704435ba1462970}{param}[8] = \textcolor{stringliteral}{"PARAM   "};
69     \textcolor{keyword}{static} \textcolor{keywordtype}{char} \hyperlink{ARLM2_8c_af9da3640450124f9882e3ddea16f45af}{chord}[8] = \textcolor{stringliteral}{"CHORD   "};
70     \textcolor{keyword}{static} \textcolor{keywordtype}{char} flow[8] = \textcolor{stringliteral}{"FLOW    "};
71     \textcolor{keyword}{static} \textcolor{keywordtype}{char} \hyperlink{OPCODE_8c_a0492c4557ef9b88f68d0a0bc7a2d0e97}{length}[8] = \textcolor{stringliteral}{"LENGTH  "};
72     \textcolor{keyword}{static} \textcolor{keywordtype}{char} angle[8] = \textcolor{stringliteral}{"ANGLE   "};
73     \textcolor{keyword}{static} doublereal \hyperlink{APT301_8c_a361b1d0588e13a7b5994f24b40138ec0}{zero} = 0.;
74     \textcolor{keyword}{static} doublereal \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one} = 1.;
75     \textcolor{keyword}{static} doublereal smal = 1e-7;
76     \textcolor{keyword}{static} doublereal tolr = .005;
77     \textcolor{keyword}{static} \textcolor{keywordtype}{char} rnam1[8] = \textcolor{stringliteral}{"FLOSEG  "};
78     \textcolor{keyword}{static} \textcolor{keywordtype}{char} rnam2[8] = \textcolor{stringliteral}{"ANGSEG  "};
79     \textcolor{keyword}{static} \textcolor{keywordtype}{char} rnam3[8] = \textcolor{stringliteral}{"CHDSEG  "};
80     \textcolor{keyword}{static} \textcolor{keywordtype}{char} rnam4[8] = \textcolor{stringliteral}{"ARCSEG  "};
81     \textcolor{keyword}{static} \textcolor{keywordtype}{char} rnam5[8] = \textcolor{stringliteral}{"ANGDER  "};
82     \textcolor{keyword}{static} \textcolor{keywordtype}{char} rnama[8] = \textcolor{stringliteral}{"FLOSEG??"};
83     \textcolor{keyword}{static} \textcolor{keywordtype}{char} rname[8] = \textcolor{stringliteral}{"        "};
84     \textcolor{keyword}{static} integer imax2 = 3;
85     \textcolor{keyword}{static} integer izal2[3] = \{ 5508,5509,5510 \};
86     \textcolor{keyword}{static} integer imax3 = 6;
87     \textcolor{keyword}{static} integer izal3[6] = \{ 5502,5503,5504,5505,5506,5507 \};
88     \textcolor{keyword}{static} integer imax4 = 3;
89     \textcolor{keyword}{static} integer izal4[3] = \{ 5501,5522,5523 \};
90     \textcolor{keyword}{static} integer imax5 = 3;
91     \textcolor{keyword}{static} integer izal5[3] = \{ 5519,5511,5512 \};
92     \textcolor{keyword}{static} integer nhd = 1;
93     \textcolor{keyword}{static} doublereal \hyperlink{INDIRP_8c_a7bff2da864fb642dcbfa06bc2ac74fa7}{point} = 19.;
94     \textcolor{keyword}{static} doublereal \hyperlink{INDIRV_8c_add93f942eb3d18a8f8e108404869156f}{vector} = 20.;
95 
96     \textcolor{comment}{/* System generated locals */}
97     integer i\_\_1, i\_\_2;
98     doublereal d\_\_1;
99 
100     \textcolor{comment}{/* Builtin functions */}
101     integer s\_cmp(\textcolor{keywordtype}{char} *, \textcolor{keywordtype}{char} *, ftnlen, ftnlen);
102     \textcolor{keywordtype}{double} sqrt(doublereal);
103     \textcolor{comment}{/* Subroutine */} \textcolor{keywordtype}{int} s\_copy(\textcolor{keywordtype}{char} *, \textcolor{keywordtype}{char} *, ftnlen, ftnlen);
104 
105     \textcolor{comment}{/* Local variables */}
106     \textcolor{keyword}{static} integer \hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}, \hyperlink{PRO026_8c_aa8c84707b22bdc99b810d3c7d3ec5d52}{j}, \hyperlink{MOTION_8c_a13b230ea1d237595fb236c951a0849e0}{k}, \hyperlink{PRO026_8c_a1cb503ddd20ff3cf9588d2b5abd202d8}{l}, \hyperlink{APT088_8c_a3d6a160e79abd2d447bd74462fa979b8}{m};
107     \textcolor{keyword}{static} doublereal \hyperlink{SPRVIS_8c_a1f0cf49f22a9b271d1d9e6e14609faed}{t};
108     \textcolor{keyword}{static} integer \hyperlink{APT088_8c_af963619ce97fcda891257c2a296fc0b9}{i1}, \hyperlink{CUTREG_8c_a5f589bc83e55eecc5b1c372de3376ea9}{i2}, \hyperlink{BAD_8c_a42e9a863c1f6c785301bf4664e47fdf3}{ii}, \hyperlink{GFETCH_8c_a8ccf5dde08cd0f6cfa1133ce508a2414}{jj}, nh, mm, \hyperlink{APT301_8c_a79fbdfd6d18963a5b89c61facf5afdfc}{ir}, nn, np;
109     \textcolor{keyword}{static} doublereal \hyperlink{ADV_8c_a6bdeb75d0d30207cefb604a676d0340b}{pp}[12]  \textcolor{comment}{/* was [4][3] */};
110     \textcolor{keyword}{static} integer ns;
111 \textcolor{preprocessor}{#define st ((doublereal *)&sspad\_1 + 1)}
112     \textcolor{keyword}{static} doublereal sz, \hyperlink{APT301_8c_a21310c6f7f66ee25aa3e9406d32b948e}{an1}, \hyperlink{APT301_8c_a951f48963f05eb3e6871f6438f14b582}{an2};
113     \textcolor{keyword}{static} integer jj1, il2, il3, il4, il5;
114     \textcolor{keyword}{extern} \textcolor{comment}{/* Subroutine */} \textcolor{keywordtype}{int} \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}();
115 \textcolor{preprocessor}{#define can ((doublereal *)&\_BLNK\_\_1 + 40)}
116     \textcolor{keyword}{static} doublereal anh;
117     \textcolor{keyword}{static} integer kkk, nct, nwd;
118     \textcolor{keyword}{static} doublereal \hyperlink{GOCHOR_8c_ab319cb41d2e6faf11ec8cfbc3e291967}{tol};
119     \textcolor{keyword}{static} integer ist, \hyperlink{APT301_8c_aa3c72ca6b3be24e62558686312531347}{num};
120     \textcolor{keyword}{static} doublereal sum;
121     \textcolor{keyword}{static} integer nhd1, ndif;
122     \textcolor{keyword}{static} logical \hyperlink{AERR_8c_abdc936055e6863ee32f47ab3666ef718}{iseg};
123     \textcolor{keyword}{static} integer nloc, irct;
124     \textcolor{keyword}{static} doublereal span;
125     \textcolor{keyword}{static} integer mmmm;
126     \textcolor{keyword}{static} doublereal anst;
127     \textcolor{keyword}{static} integer ispl, nnnn, jtop;
128     \textcolor{keyword}{static} \textcolor{keywordtype}{char} \hyperlink{MOTION_8c_af04af1bc6d042a68a2b24d6e1312d253}{test}[8];
129     \textcolor{keyword}{static} integer \hyperlink{INTCON_8c_a1f0203656d2880e98c95896b7ce303b4}{npts};
130     \textcolor{keyword}{static} doublereal tsum;
131     \textcolor{keyword}{static} integer nloc1;
132 \textcolor{preprocessor}{#define canon ((doublereal *)&\_BLNK\_\_1)}
133     \textcolor{keyword}{extern} \textcolor{comment}{/* Subroutine */} \textcolor{keywordtype}{int} \hyperlink{CFORM_8c_ac1d4f86996388dd43d61bc383e8ecfc4}{cform\_}(\textcolor{keywordtype}{char} *, \textcolor{keywordtype}{char} *, integer *, integer *, 
134         ftnlen, ftnlen);
135 \textcolor{preprocessor}{#define sscan ((doublereal *)&\_BLNK\_\_1 + 40)}
136     \textcolor{keyword}{static} doublereal asize;
137     \textcolor{keyword}{static} logical iflow;
138     \textcolor{keyword}{static} integer istem;
139     \textcolor{keyword}{static} doublereal anpts, bpnts;
140     \textcolor{keyword}{static} integer msize;
141     \textcolor{keyword}{static} doublereal stemp[400]    \textcolor{comment}{/* was [4][100] */};
142     \textcolor{keyword}{extern} \textcolor{comment}{/* Subroutine */} \textcolor{keywordtype}{int} \hyperlink{ERROR_8c_a5bb40fce8df3b6b0ad823562e349b89e}{error\_}(integer *, \textcolor{keywordtype}{char} *, ftnlen);
143     \textcolor{keyword}{static} integer ncurv, ispmx;
144     \textcolor{keyword}{extern} \textcolor{comment}{/* Subroutine */} \textcolor{keywordtype}{int} \hyperlink{CHDSEG_8c_a0544e35fcd0ad404c0e478ad9a0df35a}{chdseg\_}(doublereal *, doublereal *, 
145         doublereal *, integer *, integer *, integer *, doublereal *, 
146         doublereal *, doublereal *);
147 \textcolor{preprocessor}{#define bcanon ((doublereal *)&\_BLNK\_\_1 + 40)}
148     \textcolor{keyword}{extern} \textcolor{comment}{/* Subroutine */} \textcolor{keywordtype}{int} \hyperlink{ARCSEG_8c_ad825ba5c668e9b3cdbc106d70829c35e}{arcseg\_}(doublereal *, doublereal *, 
149         doublereal *, integer *, integer *, integer *), \hyperlink{ANGSEG_8c_a05661170e2895775b60bcb02795cb89b}{angseg\_}(
150         doublereal *, doublereal *, doublereal *, integer *, integer *, 
151         integer *, doublereal *, doublereal *);
152     \textcolor{keyword}{static} doublereal factor;
153     \textcolor{keyword}{static} integer inctem;
154     \textcolor{keyword}{extern} \textcolor{comment}{/* Subroutine */} \textcolor{keywordtype}{int} \hyperlink{HOLFRM_8c_ad837b853605dc07f300a66c119eb7eb4}{holfrm\_}(doublereal *, \textcolor{keywordtype}{char} *, integer *, 
155         integer *, integer *, ftnlen);
156     \textcolor{keyword}{static} integer numseg, isegst, iflost;
157     \textcolor{keyword}{extern} \textcolor{comment}{/* Subroutine */} \textcolor{keywordtype}{int} \hyperlink{CNCURV_8c_a04761b7674edc68920b6ae1f87beb0b5}{cncurv\_}(doublereal *, doublereal *, 
158         doublereal *, integer *);
159     \textcolor{keyword}{static} integer nflost, nsegst, lstemp, \hyperlink{APT001_8c_ae6291c7ad4bbbf5230272398ac66056b}{ierror}, istmax;
160     \textcolor{keyword}{extern} \textcolor{comment}{/* Subroutine */} \textcolor{keywordtype}{int} \hyperlink{CPRINT_8c_a162e4af07e13f17e2aa965863091b687}{cprint\_}(\textcolor{keywordtype}{char} *, ftnlen);
161     \textcolor{keyword}{static} doublereal totlen;
162     \textcolor{keyword}{static} integer isplst;
163 
164 
165 
166 
167 \textcolor{comment}{/*     UNLABELLED COMMON */}
168 
169 \textcolor{comment}{/* ---     SIZE OF BLANK COMMON IS ALLOCATED RIGHT HERE. */}
170 
171 
172 
173 
174 
175 \textcolor{comment}{/* .... SCULPTURED SURFACES SCRATCH PAD AREA */}
176 
177 
178 
179 
180 
181 \textcolor{comment}{/* ---     THE FOLLOWING ARRAY, DARRAY, IS SHARED FOR PRINTING */}
182 
183 \textcolor{comment}{/*   ***  20.  DARRAY BLOCK  *** */}
184 
185 \textcolor{comment}{/*   PRINT BUFFER */}
186 
187 
188 
189 
190 \textcolor{comment}{/* ---      LSTEMX IS THE MAXIMUM NUMBER OF ROWS IN STEMP */}
191 
192 
193     np = 0;
194     nh = 41;
195     anh = (doublereal) nh;
196     nhd1 = nhd + 1;
197     ns = nh + 8;
198 \textcolor{comment}{/* --- MODE=2 MEANS PROCESS FLOW COMMANDS PREVIOUSLY STORED */}
199 \textcolor{comment}{/* ---      IN STEMP */}
200 \textcolor{comment}{/* --- MODE=1 MEANS PERFORM PRELIMINARY SCAN OF SCURV INPUT-STREAM */}
201 \textcolor{comment}{/* ---      AND STORE FLOW DATA, IF ANY, IN STEMP. */}
202     \textcolor{keywordflow}{if} (*\hyperlink{APT331_8c_af613cadd5cf49515a2b8790d3bfd56af}{mode} == 2) \{
203     \textcolor{keywordflow}{goto} L2000;
204     \}
205 
206 \textcolor{comment}{/* ---     PERFORM A PRELIMINARY SCAN OF DATA TO LOCATE FLOW */}
207 \textcolor{comment}{/* ---     AND SEGMENT INFORMATION IN THE DEFINITION */}
208 \textcolor{comment}{/* ---     LSTEMP IS THE POINTER TO THE LAST USED ROW IN STEMP */}
209 \textcolor{comment}{/* ---     IFLOW IS TRUE ONLY WHILE PROCESSING FLOW BLOCKS */}
210 \textcolor{comment}{/* ---     ISEG IS TRUE ONLY WHILE PROCESSING SEGMENT BLOCKS */}
211 \textcolor{comment}{/* ---     NSEGST POINTS TO THE STARTING ROW FOR SEGMENT INFORMATION */}
212 \textcolor{comment}{/* ---     NFLOST POINTS TO THE STARTING ROW FOR FLOW INFORMATION */}
213     iflow = FALSE\_;
214     iseg = FALSE\_;
215     nflost = 0;
216     nsegst = 0;
217     lstemp = 0;
218     numseg = 0;
219     *iflseg = 0;
220 
221 \textcolor{comment}{/* ---     SEARCH FOR FLOW AND SEGMENT BLOCKS AND TRANSFER */}
222 \textcolor{comment}{/* ---     INFORMATION IN EDITED FORM INTO THE STEMP ARRAY */}
223 
224     nloc = ns;
225 L34:
226     \textcolor{keywordflow}{if} (nloc >= *nsize) \{
227     \textcolor{keywordflow}{goto} L1034;
228     \}
229 
230 \textcolor{comment}{/* ---     NLOC POINTS TO THE STARTING LOCATION OF THE CURRENT */}
231 \textcolor{comment}{/* ---     SUBSTRING BEING EXAMINED. IT IS UPDATED TO THE NEXT SUBSTRING */}
232 \textcolor{comment}{/* ---     AT THE TERMINATION OF CODE FOR EACH SUBSTRING. */}
233     t = \hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nloc - 1];
234     \hyperlink{HOLFRM_8c_ad837b853605dc07f300a66c119eb7eb4}{holfrm\_}(&t, test, &\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{FLOSEG_8c_a0eeed1e607f74578e1b4643f08de6f36}{c\_\_8}, &nwd, (ftnlen)8);
235     \textcolor{keywordflow}{if} (s\_cmp(test, flow, (ftnlen)8, (ftnlen)8) == 0) \{
236     \textcolor{keywordflow}{goto} L40;
237     \}
238     \textcolor{keywordflow}{if} (s\_cmp(test, seg, (ftnlen)8, (ftnlen)8) == 0) \{
239     \textcolor{keywordflow}{goto} L50;
240     \}
241     \hyperlink{HOLFRM_8c_ad837b853605dc07f300a66c119eb7eb4}{holfrm\_}(&\hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nloc], test, &\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{FLOSEG_8c_a0eeed1e607f74578e1b4643f08de6f36}{c\_\_8}, &nwd, (ftnlen)8);
242     \textcolor{keywordflow}{if} (s\_cmp(test, seg, (ftnlen)8, (ftnlen)8) == 0) \{
243     \textcolor{keywordflow}{goto} L51;
244     \}
245 \textcolor{comment}{/* ---     IF FLOW OR SEG HAVE NOT BEEN FOUND, CONTINUE SEARCH */}
246     \textcolor{keywordflow}{if} (! iflow && ! iseg) \{
247     ++nloc;
248     \}
249     \textcolor{keywordflow}{if} (! iflow && ! iseg) \{
250     \textcolor{keywordflow}{goto} L31;
251     \}
252     \textcolor{keywordflow}{if} (iflow) \{
253     \textcolor{keywordflow}{goto} L60;
254     \}
255 \textcolor{comment}{/* ---     ISEG MUST BE TRUE SO CHECK FOR SEGMENT BLOCKS */}
256     t = \hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nloc];
257     \hyperlink{HOLFRM_8c_ad837b853605dc07f300a66c119eb7eb4}{holfrm\_}(&t, test, &\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{FLOSEG_8c_a0eeed1e607f74578e1b4643f08de6f36}{c\_\_8}, &nwd, (ftnlen)8);
258     \textcolor{keywordflow}{if} (s\_cmp(test, length, (ftnlen)8, (ftnlen)8) == 0 || s\_cmp(test, param, (
259         ftnlen)8, (ftnlen)8) == 0) \{
260     \textcolor{keywordflow}{goto} L35;
261     \}
262 \textcolor{comment}{/* ****    PROPER MINOR WORD DID NOT FOLLOW HERE. */}
263     *irr = 1;
264     \textcolor{keywordflow}{goto} L30;
265 L35:
266     ++lstemp;
267     \textcolor{keywordflow}{if} (lstemp <= lstemx) \{
268     \textcolor{keywordflow}{goto} L36;
269     \}
270 \textcolor{comment}{/* ****    NO ROOM AVAILABLE IN BUFFER FOR FLOW/SEG DATA */}
271     *irr = 2;
272     \textcolor{keywordflow}{goto} L30;
273 L36:
274     stemp[(lstemp << 2) - 4] = t;
275     \textcolor{keywordflow}{if} (\hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nloc + 1] == areal && \hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nloc + 3] == areal) \{
276     \textcolor{keywordflow}{goto} L38;
277     \}
278 \textcolor{comment}{/* ****    AT LEAST TWO SCALARS SHOULD FOLLOW */}
279     *irr = 3;
280     \textcolor{keywordflow}{goto} L30;
281 L38:
282     stemp[(lstemp << 2) - 3] = \hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nloc + 2];
283     stemp[(lstemp << 2) - 2] = \hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nloc + 4];
284     stemp[(lstemp << 2) - 1] = one;
285     nloc += 6;
286     ++numseg;
287     \textcolor{keywordflow}{goto} L31;
288 
289 \textcolor{comment}{/* ---     CHECK FOR PROPER WORDS FOR FLOW INFORMATION */}
290 L60:
291     t = \hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nloc];
292     msize = 1;
293     \hyperlink{HOLFRM_8c_ad837b853605dc07f300a66c119eb7eb4}{holfrm\_}(&t, test, &\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{FLOSEG_8c_a0eeed1e607f74578e1b4643f08de6f36}{c\_\_8}, &nwd, (ftnlen)8);
294     \textcolor{keywordflow}{if} (s\_cmp(test, arc, (ftnlen)8, (ftnlen)8) == 0 || s\_cmp(test, param, (
295         ftnlen)8, (ftnlen)8) == 0) \{
296     \textcolor{keywordflow}{goto} L65;
297     \}
298     msize = 4;
299     \textcolor{keywordflow}{if} (s\_cmp(test, chord, (ftnlen)8, (ftnlen)8) == 0) \{
300     \textcolor{keywordflow}{goto} L65;
301     \}
302     msize = 4;
303     \textcolor{keywordflow}{if} (s\_cmp(test, angle, (ftnlen)8, (ftnlen)8) == 0) \{
304     \textcolor{keywordflow}{goto} L65;
305     \}
306 \textcolor{comment}{/* ****   NONE OF THE REQUIRED KEYWORDS HAS FOLLOWED */}
307     msize = 0;
308     *irr = 4;
309     \textcolor{keywordflow}{goto} L30;
310 
311 L65:
312     asize = (doublereal) msize;
313     \textcolor{keywordflow}{if} (\hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nloc + 1] == areal && \hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nloc + 3] == areal) \{
314     \textcolor{keywordflow}{goto} L70;
315     \}
316 \textcolor{comment}{/* ****    AT LEAST TWO SCALARS SHOULD FOLLOW */}
317     *irr = 5;
318     \textcolor{keywordflow}{goto} L30;
319 L70:
320     ++lstemp;
321     \textcolor{keywordflow}{if} (lstemp + msize - 1 <= lstemx) \{
322     \textcolor{keywordflow}{goto} L75;
323     \}
324 \textcolor{comment}{/* ****    NO ROOM TO BUFFER ARC/FLOW DATA */}
325     *irr = 6;
326     \textcolor{keywordflow}{goto} L30;
327 L75:
328     stemp[(lstemp << 2) - 4] = t;
329     stemp[(lstemp << 2) - 3] = \hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nloc + 2];
330     stemp[(lstemp << 2) - 2] = \hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nloc + 4];
331     stemp[(lstemp << 2) - 1] = asize + tolr;
332     nloc += 6;
333     \textcolor{keywordflow}{if} (\hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nloc - 1] != areal) \{
334     \textcolor{keywordflow}{goto} L76;
335     \}
336 \textcolor{comment}{/* ---     LOAD A USER SUPPLIED TOLERANCE , IF ACCEPTABLE */}
337     t = \hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nloc];
338     \textcolor{keywordflow}{if} (t > smal && t < one) \{
339     stemp[(lstemp << 2) - 1] = asize + t;
340     \}
341     nloc += 2;
342 L76:
343     \textcolor{keywordflow}{if} (msize < 2) \{
344     \textcolor{keywordflow}{goto} L89;
345     \}
346 \textcolor{comment}{/* ---     SCAN FOR MODIFYING POINTS AND VECTORS FOR FLOW SPECIFICATION */}
347     mm = msize - 1;
348     i\_\_1 = mm;
349     \textcolor{keywordflow}{for} (l = 1; l <= i\_\_1; ++\hyperlink{PRO026_8c_a1cb503ddd20ff3cf9588d2b5abd202d8}{l}) \{
350     \textcolor{keywordflow}{for} (k = 1; k <= 4; ++\hyperlink{MOTION_8c_a13b230ea1d237595fb236c951a0849e0}{k}) \{
351         stemp[k + (l + lstemp << 2) - 5] = zero;
352 \textcolor{comment}{/* L80: */}
353     \}
354     \}
355     t = \hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nloc - 1];
356     \textcolor{keywordflow}{if} (t != point || msize < 2) \{
357     \textcolor{keywordflow}{goto} L83;
358     \}
359     \textcolor{keywordflow}{for} (l = 1; l <= 3; ++\hyperlink{PRO026_8c_a1cb503ddd20ff3cf9588d2b5abd202d8}{l}) \{
360     stemp[l + (lstemp + 1 << 2) - 5] = \hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nloc + l - 1];
361 \textcolor{comment}{/* L81: */}
362     \}
363     stemp[(lstemp + 1 << 2) - 1] = one;
364     nloc += 4;
365     t = \hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nloc - 1];
366 L83:
367     \textcolor{keywordflow}{if} (t != point || msize < 3) \{
368     \textcolor{keywordflow}{goto} L87;
369     \}
370     \textcolor{keywordflow}{for} (l = 1; l <= 3; ++\hyperlink{PRO026_8c_a1cb503ddd20ff3cf9588d2b5abd202d8}{l}) \{
371     stemp[l + (lstemp + 2 << 2) - 5] = \hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nloc + l - 1];
372 \textcolor{comment}{/* L86: */}
373     \}
374     stemp[(lstemp + 2 << 2) - 1] = one;
375     nloc += 4;
376     t = \hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nloc - 1];
377 L87:
378     \textcolor{keywordflow}{if} (t != vector || msize < 4) \{
379     \textcolor{keywordflow}{goto} L89;
380     \}
381     \textcolor{keywordflow}{for} (l = 1; l <= 3; ++\hyperlink{PRO026_8c_a1cb503ddd20ff3cf9588d2b5abd202d8}{l}) \{
382     stemp[l + (lstemp + 3 << 2) - 5] = \hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nloc + l - 1];
383 \textcolor{comment}{/* L88: */}
384     \}
385     stemp[(lstemp + 3 << 2) - 1] = one;
386     nloc += 4;
387 L89:
388 \textcolor{comment}{/* ---     UPDATE FLOW BLOCK POINTER TO NEXT AVAILABLE SPACE. */}
389 \textcolor{comment}{/* ---     NSEGST FINALLY POINTS TO START OF SEGMENT INFORMATION */}
390     lstemp = lstemp + msize - 1;
391     \textcolor{keywordflow}{goto} L31;
392 
393 \textcolor{comment}{/* ---     INITIALIZE DATA FOR FLOW INFORMATION */}
394 L40:
395     *irr = 7;
396 \textcolor{comment}{/* ****    NEITHER FLOW NOR SEG SHOULD HAVE BEEN ENCOUNTERED */}
397     ++nloc;
398     \textcolor{keywordflow}{if} (\hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nloc - 3] != aflow) \{
399     \textcolor{keywordflow}{goto} L31;
400     \}
401     \textcolor{keywordflow}{if} (iflow || iseg) \{
402     \textcolor{keywordflow}{goto} L30;
403     \}
404     \textcolor{keywordflow}{if} (nsegst > 0 || nflost > 0) \{
405     \textcolor{keywordflow}{goto} L30;
406     \}
407     iflow = TRUE\_;
408     nflost = 1;
409 \textcolor{comment}{/* ---     STORE THE DATA SIZE OF INPUT UP TO THE FIRST FLOW COMMAND */}
410     *nszsav = nloc - 3;
411     \textcolor{keywordflow}{goto} L31;
412 \textcolor{comment}{/* ---     INITIALIZE DATA FOR SEGMENT INFORMATION. */}
413 L51:
414     ++nloc;
415 L50:
416     ++nloc;
417     *irr = 8;
418 \textcolor{comment}{/* ****    FLOW SHOULD HAVE BEEN ENCOUNTERED BUT NOT SEG */}
419     \textcolor{keywordflow}{if} (\hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nloc - 3] != aseg) \{
420     \textcolor{keywordflow}{goto} L31;
421     \}
422     \textcolor{keywordflow}{if} (! iflow || iseg) \{
423     \textcolor{keywordflow}{goto} L30;
424     \}
425     \textcolor{keywordflow}{if} (nsegst > 0 || nflost <= 0) \{
426     \textcolor{keywordflow}{goto} L30;
427     \}
428     iflow = FALSE\_;
429     iseg = TRUE\_;
430     nsegst = lstemp + 1;
431     \textcolor{keywordflow}{goto} L31;
432 
433 L31:
434 
435     *irr = 0;
436 \textcolor{comment}{/* L32: */}
437 \textcolor{comment}{/* ---     END OF LOOP TO SCAN FOR SEGMENT/FLOW BLOCKS */}
438     \textcolor{keywordflow}{goto} L34;
439 
440 L1034:
441 
442 
443     \textcolor{keywordflow}{if} (\hyperlink{FLOSEG_8c_aa2a88aa3f2e858e87f5074fadc0e1d8e}{ibugg\_1}.ibug != 11) \{
444     \textcolor{keywordflow}{goto} L33;
445     \}
446     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{FLOSEG_8c_ad0e41331e05e813dcc44fc78ce9d648f}{c\_n54}, &\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"STEM"}, stemp, (ftnlen)4);
447 L33:
448 
449     \textcolor{keywordflow}{if} (*irr == 0) \{
450     \textcolor{keywordflow}{goto} L90;
451     \}
452 
453 \textcolor{comment}{/* ---     ERROR PATH, UNDEFINE CANON FORM AND QUIT */}
454 L30:
455 \textcolor{comment}{/* ---     WRITE OUT INFORMATION FOR DIAGNOSING PROBLEM */}
456     ndif = *nsize - ns + 1;
457     i\_\_1 = -ndif;
458     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&i\_\_1, &\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"CAN "}, &\hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[ns - 1], (ftnlen)4);
459     nloc = nloc - ns + 1;
460     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{FLOSEG_8c_a9e9287f317ef3436252a395791a899f6}{c\_n1}, &\hyperlink{FLOSEG_8c_a6a4ee26669af052a7e7fb5dda2b01f63}{c\_\_0}, \textcolor{stringliteral}{"NLOC"}, &nloc, (ftnlen)4);
461     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{FLOSEG_8c_a6a4ee26669af052a7e7fb5dda2b01f63}{c\_\_0}, \textcolor{stringliteral}{"NSEG"}, &nsegst, (ftnlen)4);
462     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{FLOSEG_8c_a6a4ee26669af052a7e7fb5dda2b01f63}{c\_\_0}, \textcolor{stringliteral}{"I   "}, &i\_\_, (ftnlen)4);
463     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{FLOSEG_8c_a6a4ee26669af052a7e7fb5dda2b01f63}{c\_\_0}, \textcolor{stringliteral}{"M   "}, &m, (ftnlen)4);
464     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"AN1 "}, &an1, (ftnlen)4);
465     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"AN2 "}, &an2, (ftnlen)4);
466     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{FLOSEG_8c_a9e9287f317ef3436252a395791a899f6}{c\_n1}, &\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"BPNT"}, &bpnts, (ftnlen)4);
467 
468     ierror = abs(*irr) + 5500;
469     \hyperlink{ERROR_8c_a5bb40fce8df3b6b0ad823562e349b89e}{error\_}(&ierror, rnam1, (ftnlen)8);
470 
471 L90:
472     \textcolor{keywordflow}{if} (iflow || iseg) \{
473     *iflseg = 1;
474     \}
475     \textcolor{keywordflow}{goto} L999;
476 
477 \textcolor{comment}{/* ---------------------------------------------------------- */}
478 L2000:
479 
480 
481 \textcolor{comment}{/* ---     FLOW INFORMATION IS AVAILABLE, SO START FLOW PROCESSING */}
482 \textcolor{comment}{/* ---     FIRST SCAN THE FLOW AND SEGMENT BLOCKS AND CHECK FOR */}
483 \textcolor{comment}{/* ---     INPUT CONSISTENCY. */}
484 
485     anpts = \hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nh + 2] + \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one};
486     npts = (integer) anpts;
487     bpnts = anpts - \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one};
488 \textcolor{comment}{/* ---     INCREMENT CURVE TYPE BY 10 TO INDICATE FLOW PRESENCE. */}
489     \hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nh + 1] += 10.f;
490 
491 \textcolor{comment}{/* ---     I IS CURRENT ROW, M INCREMENT TO NEXT, N2 LAST POINT */}
492     i\_\_ = 0;
493     m = 1;
494     an2 = \hyperlink{APT301_8c_a361b1d0588e13a7b5994f24b40138ec0}{zero};
495 L1010:
496     i\_\_ += \hyperlink{APT088_8c_a3d6a160e79abd2d447bd74462fa979b8}{m};
497     \textcolor{keywordflow}{if} (i\_\_ >= nsegst) \{
498     \textcolor{keywordflow}{goto} L1080;
499     \}
500     an1 = stemp[(i\_\_ << 2) - 3];
501     \textcolor{keywordflow}{if} ((d\_\_1 = an2 - an1, abs(d\_\_1)) < smal) \{
502     \textcolor{keywordflow}{goto} L1020;
503     \}
504 \textcolor{comment}{/* ****    PREVIOUS POINT AND PRESENT SHOULD BE EQUAL */}
505     *irr = 13;
506     \textcolor{keywordflow}{goto} L30;
507 L1020:
508     an2 = stemp[(i\_\_ << 2) - 2];
509     m = (integer) stemp[(i\_\_ << 2) - 1];
510     \textcolor{keywordflow}{if} (an1 + smal < an2 && an2 < bpnts + smal) \{
511     \textcolor{keywordflow}{goto} L1010;
512     \}
513 \textcolor{comment}{/* ****    REFERENCES TO CURVE POINTS ARE INVALID. */}
514     *irr = 14;
515     \textcolor{keywordflow}{goto} L30;
516 L1080:
517     \textcolor{keywordflow}{if} ((d\_\_1 = an2 - bpnts, abs(d\_\_1)) < smal) \{
518     \textcolor{keywordflow}{goto} L1090;
519     \}
520 \textcolor{comment}{/* ****    LAST POINT REFERENCE SHOULD EQUAL LAST PT OF CURVE */}
521     *irr = 15;
522     \textcolor{keywordflow}{goto} L30;
523 L1090:
524 
525 \textcolor{comment}{/* ---    NOW SCAN SEGMENT DATA AND CHECK FOR CONSISTENCY */}
526 
527     i\_\_ = nsegst - 1;
528     m = 1;
529     an2 = \hyperlink{APT301_8c_a361b1d0588e13a7b5994f24b40138ec0}{zero};
530 L1110:
531     i\_\_ += \hyperlink{APT088_8c_a3d6a160e79abd2d447bd74462fa979b8}{m};
532     \textcolor{keywordflow}{if} (i\_\_ > lstemp) \{
533     \textcolor{keywordflow}{goto} L1180;
534     \}
535     an1 = stemp[(i\_\_ << 2) - 3];
536     \textcolor{keywordflow}{if} ((d\_\_1 = an1 - an2, abs(d\_\_1)) < smal) \{
537     \textcolor{keywordflow}{goto} L1120;
538     \}
539 \textcolor{comment}{/* ****    AN1,AN2 HAVE INVALID RELATION */}
540     *irr = 16;
541     \textcolor{keywordflow}{goto} L30;
542 L1120:
543     an2 = stemp[(i\_\_ << 2) - 2];
544     \textcolor{keywordflow}{if} (an1 < an2 + smal && an2 < bpnts + smal) \{
545     \textcolor{keywordflow}{goto} L1110;
546     \}
547 \textcolor{comment}{/* ****    CURRENT TWO SCALARS HAVE INCONSISTENT RELATION */}
548     *irr = 17;
549     \textcolor{keywordflow}{goto} L30;
550 L1180:
551     \textcolor{keywordflow}{if} ((d\_\_1 = an2 - bpnts, abs(d\_\_1)) < smal) \{
552     \textcolor{keywordflow}{goto} L1190;
553     \}
554 \textcolor{comment}{/* ****    LAST SEGMENT MUST TERMINATE IN LAST POINT */}
555     *irr = 18;
556     \textcolor{keywordflow}{goto} L30;
557 L1190:
558 \textcolor{comment}{/* ------------------------------------------------ */}
559 \textcolor{comment}{/* ---     CONSISTENCY CHECKING COMPLETED ON FLOW/SEGMENT INPUT */}
560 
561 \textcolor{comment}{/* ---     MAJOR FLOW PROCESSING, ALL FLOW COMMAND INFORMATION */}
562 \textcolor{comment}{/* ---     IS STORED IN THE STEMP ARRAY WHOSE ROWS WILL BE INDEXED */}
563 \textcolor{comment}{/* ---     BY IST.  FLOW INFORMATION, INCLUDING ARC SUMMARY BLOCKS */}
564 \textcolor{comment}{/* ---     AND FLOW RATE SPLINES ARE CONTAINED IN THE ARRAY ST */}
565 \textcolor{comment}{/* ---     SUMMARY INFORMATION IS INDEXED BY IST AND SPLINE */}
566 \textcolor{comment}{/* ---     FUNCTIONS ARE INDEXED BY IFLAVL */}
567 
568 \textcolor{comment}{/* ---     SAVE STARTING VALUES FOR  FLOW AND SEGMENT SUMMARY */}
569 \textcolor{comment}{/* ---     BLOCKS */}
570     iflost = 1;
571     isegst = \hyperlink{INTCON_8c_a1f0203656d2880e98c95896b7ce303b4}{npts};
572     isplst = isegst + numseg;
573 \textcolor{comment}{/* ---     INITIALIZE INDICES TO AVAILABLE SPACE */}
574     ist = iflost;
575     ispl = isplst;
576     istmax = maxsc * 6;
577 \textcolor{comment}{/* ---     ARRAY ST (=SC) WILL BE USED TO BUFFER AND ACCUMULATE */}
578 \textcolor{comment}{/* ---     FLOW AND SEGMENT SUMMARY INFORMATION.  THIS DATA */}
579 \textcolor{comment}{/* ---     WILL THEN BE EXAMINED FOR ERRORS AND LATER BE */}
580 \textcolor{comment}{/* ---     CONSOLIDATED WITH THE REMAINING DEFINED CURVE CANON */}
581 \textcolor{comment}{/* ---     FORM, PROVIDED NO ERRORS HAVE OCCURRED. */}
582 
583     istem = 0;
584     inctem = 1;
585     irct = 0;
586 
587 L1200:
588     istem += inctem;
589     \textcolor{keywordflow}{if} (istem >= nsegst) \{
590     \textcolor{keywordflow}{goto} L1300;
591     \}
592     i1 = (integer) (stemp[(istem << 2) - 3] + \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one});
593     i2 = (integer) stemp[(istem << 2) - 2];
594     inctem = (integer) stemp[(istem << 2) - 1];
595     tol = stemp[(istem << 2) - 1] - inctem;
596 \textcolor{comment}{/* ---     EXECUTE THIS FLOW PROCESSING FOR EACH CURVE FROM I1 TO I2 */}
597 
598     i\_\_1 = \hyperlink{CUTREG_8c_a5f589bc83e55eecc5b1c372de3376ea9}{i2};
599     \textcolor{keywordflow}{for} (j = i1; j <= i\_\_1; ++\hyperlink{PRO026_8c_aa8c84707b22bdc99b810d3c7d3ec5d52}{j}) \{
600     \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 4] = (doublereal) ispl;
601     ispmx = istmax - ispl;
602     \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 2] = stemp[(ist << 2) - 4];
603 \textcolor{comment}{/* ---     COMPUTE INDEX TO CURRENT CURVE */}
604     ncurv = (integer) ((\hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nh] + j - 1) * 24 + nh);
605 
606     if (\hyperlink{FLOSEG_8c_aa2a88aa3f2e858e87f5074fadc0e1d8e}{ibugg\_1}.\hyperlink{FLOSEG_8c_acf8cd9aebbc7f97517952bf2f89ed57c}{ibug} != 11) \{
607         \textcolor{keywordflow}{goto} L1219;
608     \}
609     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{FLOSEG_8c_a6a4ee26669af052a7e7fb5dda2b01f63}{c\_\_0}, \textcolor{stringliteral}{"NCUR"}, &ncurv, (ftnlen)4);
610     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{FLOSEG_8c_a9e9287f317ef3436252a395791a899f6}{c\_n1}, &\hyperlink{FLOSEG_8c_a6a4ee26669af052a7e7fb5dda2b01f63}{c\_\_0}, \textcolor{stringliteral}{"J   "}, &j, (ftnlen)4);
611     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{FLOSEG_8c_ab547b63b356ef99dc04f74ea358aa245}{c\_\_24}, &\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"CAN "}, &\hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[ncurv - 1], (ftnlen)4);
612     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"TOL "}, &tol, (ftnlen)4);
613     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{FLOSEG_8c_a9e9287f317ef3436252a395791a899f6}{c\_n1}, &\hyperlink{FLOSEG_8c_a6a4ee26669af052a7e7fb5dda2b01f63}{c\_\_0}, \textcolor{stringliteral}{"ISPM"}, &ispmx, (ftnlen)4);
614 L1219:
615 
616 \textcolor{comment}{/* ---     BRANCH TO AREA FOR INDIVIDUAL FLOW PROCESSING */}
617     \hyperlink{HOLFRM_8c_ad837b853605dc07f300a66c119eb7eb4}{holfrm\_}(&stemp[(istem << 2) - 4], test, &\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{FLOSEG_8c_a0eeed1e607f74578e1b4643f08de6f36}{c\_\_8}, &nwd, (ftnlen)8)
618         ;
619     \textcolor{keywordflow}{if} (s\_cmp(test, arc, (ftnlen)8, (ftnlen)8) == 0) \{
620         \textcolor{keywordflow}{goto} L1320;
621     \}
622     \textcolor{keywordflow}{if} (s\_cmp(test, angle, (ftnlen)8, (ftnlen)8) == 0) \{
623         \textcolor{keywordflow}{goto} L1340;
624     \}
625     \textcolor{keywordflow}{if} (s\_cmp(test, chord, (ftnlen)8, (ftnlen)8) == 0) \{
626         \textcolor{keywordflow}{goto} L1360;
627     \}
628     \textcolor{keywordflow}{if} (s\_cmp(test, param, (ftnlen)8, (ftnlen)8) == 0) \{
629         \textcolor{keywordflow}{goto} L1380;
630     \}
631 \textcolor{comment}{/* ****    INVALID SPECIFICATION FOR FLOW */}
632     ir = 20;
633     \textcolor{keywordflow}{goto} L1290;
634 
635 \textcolor{comment}{/* ---     FLOW PROCESSING FOR ONE CUBIC ARC BY ARC LENGTH. */}
636 L1320:
637     \hyperlink{ARCSEG_8c_ad825ba5c668e9b3cdbc106d70829c35e}{arcseg\_}(&\hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[ncurv - 1], &\hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ispl << 2) - 4], &tol, &num, &ispmx, &
638         ir);
639     \textcolor{keywordflow}{goto} L1290;
640 \textcolor{comment}{/* ---     FLOW PROCESSING FOR ONE CUBIC ARC BY ANGLE. */}
641 L1340:
642     \hyperlink{ANGSEG_8c_a05661170e2895775b60bcb02795cb89b}{angseg\_}(&\hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[ncurv - 1], &\hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ispl << 2) - 4], &tol, &num, &ispmx, &
643         ir, &stemp[(istem + 1 << 2) - 4], &stemp[(istem + 3 << 2) - 4]
644         );
645     \textcolor{keywordflow}{goto} L1290;
646 \textcolor{comment}{/* ---     FLOW PROCESSING FOR ONE CUBIC ARC BY CHORD PROJECTION */}
647 L1360:
648 
649 \textcolor{comment}{/* ---     THE SET UP OF CHORDAL PARAMETERS MAY BE IMPLIED */}
650 \textcolor{comment}{/* ---     SO BEGIN BY SETTING THEM UP FIRST. */}
651     \textcolor{keywordflow}{for} (ii = 1; ii <= 3; ++\hyperlink{BAD_8c_a42e9a863c1f6c785301bf4664e47fdf3}{ii}) \{
652         \textcolor{keywordflow}{for} (jj = 1; jj <= 3; ++\hyperlink{GFETCH_8c_a8ccf5dde08cd0f6cfa1133ce508a2414}{jj}) \{
653         pp[ii + (jj << 2) - 5] = stemp[ii + (istem + jj << 2) - 5];
654 \textcolor{comment}{/* L1361: */}
655         \}
656     \}
657 \textcolor{comment}{/* ---     DEFAULT, CHORD IS DEFINED BY END POINTS OF COMBINED SEGMENT */}
658     \textcolor{keywordflow}{if} (stemp[(istem + 1 << 2) - 1] > smal) \{
659         \textcolor{keywordflow}{goto} L1362;
660     \}
661 
662     nn = (integer) ((\hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nh] + i1 - 1) * 24 + nh);
663     \hyperlink{CNCURV_8c_a04761b7674edc68920b6ae1f87beb0b5}{cncurv\_}(&zero, &\hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nn - 1], pp, &\hyperlink{FLOSEG_8c_a6a4ee26669af052a7e7fb5dda2b01f63}{c\_\_0});
664 L1362:
665     \textcolor{keywordflow}{if} (stemp[(istem + 2 << 2) - 1] > smal) \{
666         \textcolor{keywordflow}{goto} L1363;
667     \}
668     nn = (integer) ((\hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nh] + i2 - 1) * 24 + nh);
669     \hyperlink{CNCURV_8c_a04761b7674edc68920b6ae1f87beb0b5}{cncurv\_}(&one, &\hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nn - 1], &pp[4], &\hyperlink{FLOSEG_8c_a6a4ee26669af052a7e7fb5dda2b01f63}{c\_\_0});
670 L1363:
671     sz = \hyperlink{APT301_8c_a361b1d0588e13a7b5994f24b40138ec0}{zero};
672     \textcolor{keywordflow}{for} (jj = 1; jj <= 3; ++\hyperlink{GFETCH_8c_a8ccf5dde08cd0f6cfa1133ce508a2414}{jj}) \{
673         pp[jj + 3] -= pp[jj - 1];
674 \textcolor{comment}{/* Computing 2nd power */}
675         d\_\_1 = pp[jj + 3];
676         sz += d\_\_1 * d\_\_1;
677 \textcolor{comment}{/* L1364: */}
678     \}
679     sz = sqrt(sz);
680 \textcolor{comment}{/* ****    TWO POINTS TOO CLOSE FOR PROPER CHORD */}
681     ir = 21;
682     \textcolor{keywordflow}{if} (sz < smal) \{
683         \textcolor{keywordflow}{goto} L1290;
684     \}
685     ir = 0;
686     \textcolor{keywordflow}{for} (jj = 1; jj <= 3; ++\hyperlink{GFETCH_8c_a8ccf5dde08cd0f6cfa1133ce508a2414}{jj}) \{
687         pp[jj + 3] /= sz;
688 \textcolor{comment}{/* L1365: */}
689     \}
690     \textcolor{keywordflow}{if} (stemp[(istem + 3 << 2) - 1] > smal) \{
691         \textcolor{keywordflow}{goto} L1366;
692     \}
693 \textcolor{comment}{/* L1370: */}
694 \textcolor{comment}{/* ---     IF A VECTOR NORMAL TO THE PROJECTION PLANES HAS NOT BENN */}
695 \textcolor{comment}{/* ---     SUPPLIED BY THE USER, THEN THE AXIS OF THE CHORD IS CHOSEN */}
696 \textcolor{comment}{/* ---     AS A DEFAULT NORMAL VECTOR TO THESE PLANES */}
697     pp[8] = pp[4];
698     pp[9] = pp[5];
699     pp[10] = pp[6];
700 L1366:
701     \hyperlink{CHDSEG_8c_a0544e35fcd0ad404c0e478ad9a0df35a}{chdseg\_}(&\hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[ncurv - 1], &\hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ispl << 2) - 4], &tol, &num, &ispmx, &
702         ir, pp, &pp[4], &pp[8]);
703     \textcolor{keywordflow}{goto} L1290;
704 \textcolor{comment}{/* ---     DIRECT IDENTITY PARAMETERIZATION */}
705 L1380:
706     ir = 22;
707     num = 2;
708     \textcolor{keywordflow}{if} (ispl + num > ispmx) \{
709         \textcolor{keywordflow}{goto} L1290;
710     \}
711     ir = 0;
712 \textcolor{comment}{/* ---     SET UP A SPLINE IDENTITY FUNCTION */}
713     \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ispl << 2) - 4] = zero;
714     \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ispl << 2) - 3] = zero;
715     \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ispl << 2) - 2] = one;
716     \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ispl << 2) - 1] = zero;
717     \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ispl + 1 << 2) - 4] = one;
718     \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ispl + 1 << 2) - 3] = one;
719     \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ispl + 1 << 2) - 2] = one;
720     \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ispl + 1 << 2) - 1] = zero;
721     \textcolor{keywordflow}{goto} L1290;
722 
723 L1290:
724     \textcolor{keywordflow}{if} (ir == 0) \{
725         \textcolor{keywordflow}{goto} L1220;
726     \}
727 \textcolor{comment}{/* ****    ERROR PATH, INCREMENT ERROR COUNT AND RESET VALUES */}
728     ++irct;
729     \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 4] = (doublereal) (-\hyperlink{APT301_8c_a79fbdfd6d18963a5b89c61facf5afdfc}{ir});
730     \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 3] = (doublereal) num;
731     \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 1] = zero;
732     ir = 0;
733     num = 0;
734     if (\hyperlink{FLOSEG_8c_aa2a88aa3f2e858e87f5074fadc0e1d8e}{ibugg\_1}.\hyperlink{FLOSEG_8c_acf8cd9aebbc7f97517952bf2f89ed57c}{ibug} == 11) \{
735         \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{FLOSEG_8c_a900642cfb0fdb02c80380e0b73330cb5}{c\_n4}, &\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"ERR="}, &\hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 4], (ftnlen)4);
736     \}
737     ++ist;
738     \textcolor{keywordflow}{goto} L1210;
739 \textcolor{comment}{/* ---     NORMAL COMPLETION OF FLOW RATE FOR ONE ARC. */}
740 L1220:
741 \textcolor{comment}{/* ---     STORE SUMMARY DATA FOR FLOW SPLINES LOCATION,NUMBER, */}
742 \textcolor{comment}{/* ---     TYPE OF FLOW AND TOTAL SPAN */}
743     \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 4] = (doublereal) ispl;
744     \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 3] = (doublereal) num;
745 \textcolor{comment}{/* ---     SAVE TYPE FLOW AND TOLERANCE IN 3RD LOCATION */}
746     \hyperlink{HOLFRM_8c_ad837b853605dc07f300a66c119eb7eb4}{holfrm\_}(&stemp[(istem << 2) - 4], test, &\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{FLOSEG_8c_a0eeed1e607f74578e1b4643f08de6f36}{c\_\_8}, &nwd, (ftnlen)8)
747         ;
748     if (s\_cmp(test, arc, (ftnlen)8, (ftnlen)8) == 0) \{
749         \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 2] = tol + 1.\hyperlink{APT102_8c_a7a51ed112e9b79f89e3e70beb8db8bf5}{f};
750     \}
751     \textcolor{keywordflow}{if} (s\_cmp(test, angle, (ftnlen)8, (ftnlen)8) == 0) \{
752         \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 2] = tol + 2.\hyperlink{APT102_8c_a7a51ed112e9b79f89e3e70beb8db8bf5}{f};
753     \}
754     \textcolor{keywordflow}{if} (s\_cmp(test, chord, (ftnlen)8, (ftnlen)8) == 0) \{
755         \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 2] = tol + 3.\hyperlink{APT102_8c_a7a51ed112e9b79f89e3e70beb8db8bf5}{f};
756     \}
757     \textcolor{keywordflow}{if} (s\_cmp(test, param, (ftnlen)8, (ftnlen)8) == 0) \{
758         \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 2] = tol + 4.\hyperlink{APT102_8c_a7a51ed112e9b79f89e3e70beb8db8bf5}{f};
759     \}
760     \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 1] = \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ispl + num - 1 << 2) - 4] - \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ispl << 2) - 
761         4];
762     ispl += \hyperlink{APT301_8c_aa3c72ca6b3be24e62558686312531347}{num};
763     ++ist;
764     num = 0;
765 L1210:
766     ;
767     \}
768 
769     \textcolor{keywordflow}{goto} L1200;
770 L1300:
771 
772     \textcolor{keywordflow}{if} (irct == 0 && \hyperlink{FLOSEG_8c_aa2a88aa3f2e858e87f5074fadc0e1d8e}{ibugg\_1}.ibug != 11) \{
773     \textcolor{keywordflow}{goto} L1401;
774     \}
775 \textcolor{comment}{/* ****    DUMP CURV INFORMATION TO DOCUMENT FAILURES */}
776     \hyperlink{CFORM_8c_ac1d4f86996388dd43d61bc383e8ecfc4}{cform\_}(\textcolor{stringliteral}{"0 ***ERRORS WHILE PROCESSING FLOW DATA FOR CURVE"}, 
777         \hyperlink{FLOSEG_8c_a6a01fdbcd4e9ab45bf32c168785cc8a6}{darray\_1}.darray, &\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{FLOSEG_8c_a7edaec1331969a1fc0e86088d783286e}{c\_\_48}, (ftnlen)48, (ftnlen)120);
778     \hyperlink{CPRINT_8c_a162e4af07e13f17e2aa965863091b687}{cprint\_}(\hyperlink{FLOSEG_8c_a6a01fdbcd4e9ab45bf32c168785cc8a6}{darray\_1}.darray, (ftnlen)120);
779     jtop = ispl - 1;
780     i\_\_1 = jtop;
781     \textcolor{keywordflow}{for} (jj = 1; jj <= i\_\_1; ++\hyperlink{GFETCH_8c_a8ccf5dde08cd0f6cfa1133ce508a2414}{jj}) \{
782     jj1 = iflost + jj - 1;
783     \textcolor{keywordflow}{if} (jj1 >= ist) \{
784         \textcolor{keywordflow}{goto} L1305;
785     \}
786     \textcolor{keywordflow}{if} (\hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(jj1 << 2) - 4] >= 0.) \{
787         \textcolor{keywordflow}{goto} L1305;
788     \}
789     ir = (integer) (-\hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(jj1 << 2) - 4]);
790     i\_\_2 = ir + 5500;
791     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{FLOSEG_8c_a9e9287f317ef3436252a395791a899f6}{c\_n1}, &\hyperlink{FLOSEG_8c_a6a4ee26669af052a7e7fb5dda2b01f63}{c\_\_0}, \textcolor{stringliteral}{"IRR "}, &i\_\_2, (ftnlen)4);
792 L1305:
793     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{FLOSEG_8c_a900642cfb0fdb02c80380e0b73330cb5}{c\_n4}, &\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"CURV"}, &\hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(iflost + jj - 1 << 2) - 4], (ftnlen)4)
794         ;
795 \textcolor{comment}{/* L1310: */}
796     \}
797     \textcolor{keywordflow}{if} (irct == 0) \{
798     \textcolor{keywordflow}{goto} L1401;
799     \}
800 \textcolor{comment}{/* ****    ERROR IN FLOW PROCESSING */}
801     *irr = ir + 5500;
802     s\_copy(rname, rnama, (ftnlen)8, (ftnlen)8);
803     i\_\_1 = imax2;
804     \textcolor{keywordflow}{for} (il2 = 1; il2 <= i\_\_1; ++il2) \{
805 \textcolor{comment}{/* L8002: */}
806     \textcolor{keywordflow}{if} (*irr == izal2[il2 - 1]) \{
807         s\_copy(rname, rnam2, (ftnlen)8, (ftnlen)8);
808     \}
809     \}
810     i\_\_1 = imax3;
811     \textcolor{keywordflow}{for} (il3 = 1; il3 <= i\_\_1; ++il3) \{
812 \textcolor{comment}{/* L8003: */}
813     \textcolor{keywordflow}{if} (*irr == izal3[il3 - 1]) \{
814         s\_copy(rname, rnam3, (ftnlen)8, (ftnlen)8);
815     \}
816     \}
817     i\_\_1 = imax4;
818     \textcolor{keywordflow}{for} (il4 = 1; il4 <= i\_\_1; ++il4) \{
819 \textcolor{comment}{/* L8004: */}
820     \textcolor{keywordflow}{if} (*irr == izal4[il4 - 1]) \{
821         s\_copy(rname, rnam4, (ftnlen)8, (ftnlen)8);
822     \}
823     \}
824     i\_\_1 = imax5;
825     \textcolor{keywordflow}{for} (il5 = 1; il5 <= i\_\_1; ++il5) \{
826 \textcolor{comment}{/* L8005: */}
827     \textcolor{keywordflow}{if} (*irr == izal5[il5 - 1]) \{
828         s\_copy(rname, rnam5, (ftnlen)8, (ftnlen)8);
829     \}
830     \}
831     \hyperlink{ERROR_8c_a5bb40fce8df3b6b0ad823562e349b89e}{error\_}(irr, rname, (ftnlen)8);
832     \textcolor{keywordflow}{goto} L999;
833 
834 \textcolor{comment}{/* --------------------------------------------------------- */}
835 \textcolor{comment}{/* ---    FLOW SPLINES HAVE BEEN CREATED FOR EACH ARC, NOW */}
836 \textcolor{comment}{/* ---     SET UP SEGMENT DATA. */}
837 L1401:
838 \textcolor{comment}{/* ---    NOW PROCESS CURVE SEGMENT INFORMATION */}
839     istem = nsegst - 1;
840     inctem = 1;
841 L1400:
842     istem += inctem;
843     \textcolor{keywordflow}{if} (istem > lstemp) \{
844     \textcolor{keywordflow}{goto} L1490;
845     \}
846 \textcolor{comment}{/* ---    PROCESS CURVE SEGMENTS, ONE AT A TIME */}
847     \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 2] = stemp[(istem << 2) - 4];
848     \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 4] = stemp[(istem << 2) - 3];
849     \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 3] = stemp[(istem << 2) - 2];
850     \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 1] = zero;
851     \textcolor{keywordflow}{if} ((d\_\_1 = \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 4] - \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 3], abs(d\_\_1)) < smal) \{
852     \textcolor{keywordflow}{goto} L1410;
853     \}
854 \textcolor{comment}{/* ---    IN CASE OF LENGTH TOTAL SPAN IS BASED ON TOTAL FLOW LENGTH */}
855     i1 = (integer) (\hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 4] + \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one});
856     i2 = (integer) \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 3];
857     totlen = \hyperlink{APT301_8c_a361b1d0588e13a7b5994f24b40138ec0}{zero};
858     i\_\_1 = \hyperlink{CUTREG_8c_a5f589bc83e55eecc5b1c372de3376ea9}{i2};
859     \textcolor{keywordflow}{for} (ii = i1; ii <= i\_\_1; ++\hyperlink{BAD_8c_a42e9a863c1f6c785301bf4664e47fdf3}{ii}) \{
860     totlen += \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ii << 2) - 1];
861 \textcolor{comment}{/* L1440: */}
862     \}
863 \textcolor{comment}{/* ---    STORE TOTAL LENGTH IN SEGMENT BLOCK */}
864     \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 1] = totlen;
865 \textcolor{comment}{/* ---     TOTLEN=NUMBER OF ARCS IN SEGMENT IN CASE OF PARAM */}
866     \hyperlink{HOLFRM_8c_ad837b853605dc07f300a66c119eb7eb4}{holfrm\_}(&\hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 2], test, &\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{FLOSEG_8c_a0eeed1e607f74578e1b4643f08de6f36}{c\_\_8}, &nwd, (ftnlen)8);
867     \textcolor{keywordflow}{if} (s\_cmp(test, param, (ftnlen)8, (ftnlen)8) == 0) \{
868     totlen = \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 3] - \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 4];
869     \}
870 \textcolor{comment}{/* ---     NOW CHANGE PARAMETER FLOW ON EACH SEGMENT, ARC BY ARC, */}
871 \textcolor{comment}{/* ---     SO THAT THE TOTAL FLOW IS FROM ZERO TO ONE FOR THE */}
872 \textcolor{comment}{/* ---     COMPLETE SEGMENT */}
873     sum = \hyperlink{APT301_8c_a361b1d0588e13a7b5994f24b40138ec0}{zero};
874     i\_\_1 = \hyperlink{CUTREG_8c_a5f589bc83e55eecc5b1c372de3376ea9}{i2};
875     \textcolor{keywordflow}{for} (j = i1; j <= i\_\_1; ++\hyperlink{PRO026_8c_aa8c84707b22bdc99b810d3c7d3ec5d52}{j}) \{
876 \textcolor{comment}{/* ---     DETERMINE THE FACTOR FOR RESETTING FLOW FOR ARC J */}
877     span = \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(j << 2) - 1];
878     factor = one / totlen;
879     \hyperlink{HOLFRM_8c_ad837b853605dc07f300a66c119eb7eb4}{holfrm\_}(&\hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 2], test, &\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{FLOSEG_8c_a0eeed1e607f74578e1b4643f08de6f36}{c\_\_8}, &nwd, (ftnlen)8);
880     \textcolor{keywordflow}{if} (s\_cmp(test, param, (ftnlen)8, (ftnlen)8) == 0) \{
881         factor = one / (totlen * span);
882     \}
883 \textcolor{comment}{/* ---     NOW MODIFY ALL FLOW SPLINE FUNCTIONS FOR ARC J TO */}
884 \textcolor{comment}{/* ---     CHANGE THE FLOW SCALE */}
885     nloc = (integer) \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(j << 2) - 4];
886     nn = (integer) (\hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(j << 2) - 4] + \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(j << 2) - 3] - one);
887     i\_\_2 = nn;
888     \textcolor{keywordflow}{for} (jj = nloc; jj <= i\_\_2; ++\hyperlink{GFETCH_8c_a8ccf5dde08cd0f6cfa1133ce508a2414}{jj}) \{
889         \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(jj << 2) - 4] = \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(jj << 2) - 4] * factor + sum;
890         \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(jj << 2) - 2] /= factor;
891 \textcolor{comment}{/* L1460: */}
892     \}
893 
894     \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(nloc << 2) - 1] = sum;
895     tsum = sum + sum;
896     nloc1 = nloc + 1;
897     i\_\_2 = nn;
898     \textcolor{keywordflow}{for} (jj = nloc1; jj <= i\_\_2; ++\hyperlink{GFETCH_8c_a8ccf5dde08cd0f6cfa1133ce508a2414}{jj}) \{
899         \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(jj << 2) - 1] = \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(jj << 2) - 4] - \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(jj - 1 << 2) - 4] + 
900             tsum;
901 \textcolor{comment}{/* L1465: */}
902     \}
903 
904     \hyperlink{HOLFRM_8c_ad837b853605dc07f300a66c119eb7eb4}{holfrm\_}(&\hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 2], test, &\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{FLOSEG_8c_a0eeed1e607f74578e1b4643f08de6f36}{c\_\_8}, &nwd, (ftnlen)8);
905     \textcolor{keywordflow}{if} (s\_cmp(test, param, (ftnlen)8, (ftnlen)8) == 0) \{
906         sum += one / totlen;
907     \}
908     \textcolor{keywordflow}{if} (s\_cmp(test, length, (ftnlen)8, (ftnlen)8) == 0) \{
909         sum += span * factor;
910     \}
911 \textcolor{comment}{/* L1450: */}
912     \}
913 
914     \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 3] -= \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 4];
915 \textcolor{comment}{/* ---     CONVERT ALPHANUMERIC DATA TO NUMBER CODE */}
916     \hyperlink{HOLFRM_8c_ad837b853605dc07f300a66c119eb7eb4}{holfrm\_}(&\hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 2], test, &\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{FLOSEG_8c_a0eeed1e607f74578e1b4643f08de6f36}{c\_\_8}, &nwd, (ftnlen)8);
917     \textcolor{keywordflow}{if} (s\_cmp(test, param, (ftnlen)8, (ftnlen)8) == 0) \{
918     \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 2] = 1.\hyperlink{APT102_8c_a7a51ed112e9b79f89e3e70beb8db8bf5}{f};
919     \}
920     \textcolor{keywordflow}{if} (s\_cmp(test, length, (ftnlen)8, (ftnlen)8) == 0) \{
921     \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 2] = 2.\hyperlink{APT102_8c_a7a51ed112e9b79f89e3e70beb8db8bf5}{f};
922     \}
923 L1410:
924 
925     \textcolor{keywordflow}{if} (\hyperlink{FLOSEG_8c_aa2a88aa3f2e858e87f5074fadc0e1d8e}{ibugg\_1}.ibug != 11) \{
926     \textcolor{keywordflow}{goto} L1413;
927     \}
928     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{FLOSEG_8c_a6a4ee26669af052a7e7fb5dda2b01f63}{c\_\_0}, \textcolor{stringliteral}{"IST "}, &ist, (ftnlen)4);
929     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{FLOSEG_8c_ab195470f8c6d55e333ee709af09ba2d6}{c\_\_4}, &\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"ST  "}, &\hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ist << 2) - 4], (ftnlen)4);
930 L1413:
931 
932     ++ist;
933     \textcolor{keywordflow}{goto} L1400;
934 \textcolor{comment}{/* ---     PROCESSING OF SEGMENT DATA FINISHED */}
935 L1490:
936 
937 \textcolor{comment}{/* ----------------------------------------------------------- */}
938 \textcolor{comment}{/* ---     NOW MERGE THE ST ARRAY AND FLOW/SEGMENT INFORMATION */}
939 \textcolor{comment}{/* ---     AND RECORD REQUIRED POINTERS IN THE SCURV HEADER */}
940 \textcolor{comment}{/* ---     TABLE */}
941 \textcolor{comment}{/* ---     NLOC POINTS JUST TO THE END OF THE CUBIC CURVE BLOCKS */}
942     anst = (\hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nh] + anpts - \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one}) * 24.\hyperlink{APT102_8c_a7a51ed112e9b79f89e3e70beb8db8bf5}{f} + one;
943     nct = (integer) (anst - one + anh - one);
944     i\_\_1 = ispl;
945     \textcolor{keywordflow}{for} (ii = 1; ii <= i\_\_1; ++\hyperlink{BAD_8c_a42e9a863c1f6c785301bf4664e47fdf3}{ii}) \{
946     \textcolor{keywordflow}{for} (jj = 1; jj <= 4; ++\hyperlink{GFETCH_8c_a8ccf5dde08cd0f6cfa1133ce508a2414}{jj}) \{
947         ++nct;
948 \textcolor{comment}{/* ---     CONVERT ADDRESSES FROM ROW NOTATION TO SEQUENTIAL NOTATION */}
949         \textcolor{keywordflow}{if} (ii < npts) \{
950         \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ii << 2) - 4] = (\hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[(ii << 2) - 4] - \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one}) * 4.\hyperlink{APT102_8c_a7a51ed112e9b79f89e3e70beb8db8bf5}{f} + anst;
951         \}
952         \hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nct - 1] = \hyperlink{FLOSEG_8c_a6a2301d903a8a0cd60900232c4f2d69a}{st}[jj + (ii << 2) - 5];
953 \textcolor{comment}{/* L1500: */}
954     \}
955     \}
956 \textcolor{comment}{/* ---     NOW PLACE LOCATION POINTERS IN TO HEADER TABLE */}
957 \textcolor{comment}{/* ---     LOCATION OF POINT BLOCKS */}
958     \hyperlink{FLOSEG_8c_a68d3ba380c16e286247bb69367760615}{canon}[nh + 3] = canon[nh] * 24.f + \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one};
959 \textcolor{comment}{/* ---     NUMBER OF FLOW BLOCKS (IF ANY) AND LOCATION */}
960     canon[nh + 4] = canon[nh + 2];
961     canon[nh + 5] = canon[nh + 3] + (anpts - \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one}) * 24.\hyperlink{APT102_8c_a7a51ed112e9b79f89e3e70beb8db8bf5}{f};
962 \textcolor{comment}{/* ---     NUMBER OF SEGMENT BLOCKS AND STARTING LOCATION */}
963     canon[nh + 6] = (doublereal) numseg;
964     canon[nh + 7] = canon[nh + 5] + canon[nh + 4] * 4.f;
965 \textcolor{comment}{/* ---     NUMBER OF FLOW BLOCKS AND STARTING LOCATION */}
966     canon[nh + 8] = (doublereal) (ispl - numseg - npts);
967     canon[nh + 9] = canon[nh + 7] + canon[nh + 6] * 4.f;
968 \textcolor{comment}{/* ---     FINALLY SETUP THE TOTAL SIZE OF THE STRUCTURE */}
969     canon[nh + 10] = canon[nh + 9] + canon[nh + 8] * 4.f - \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one};
970     canon[nh + 11] = \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one};
971 
972     \textcolor{keywordflow}{if} (\hyperlink{FLOSEG_8c_aa2a88aa3f2e858e87f5074fadc0e1d8e}{ibugg\_1}.ibug != 11) \{
973     \textcolor{keywordflow}{goto} L4322;
974     \}
975     nnnn = (integer) (canon[nh + 10] / 4.\hyperlink{APT102_8c_a7a51ed112e9b79f89e3e70beb8db8bf5}{f} + .1\hyperlink{APT102_8c_a7a51ed112e9b79f89e3e70beb8db8bf5}{f});
976     mmmm = -3;
977     i\_\_1 = nnnn;
978     \textcolor{keywordflow}{for} (kkk = 1; kkk <= i\_\_1; ++kkk) \{
979     mmmm += 4;
980     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{FLOSEG_8c_ab195470f8c6d55e333ee709af09ba2d6}{c\_\_4}, &\hyperlink{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"FCAN"}, &canon[nh - 1 + mmmm - 1], (ftnlen)4);
981     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{FLOSEG_8c_a9e9287f317ef3436252a395791a899f6}{c\_n1}, &\hyperlink{FLOSEG_8c_a6a4ee26669af052a7e7fb5dda2b01f63}{c\_\_0}, \textcolor{stringliteral}{"INDX"}, &mmmm, (ftnlen)4);
982 \textcolor{comment}{/* L4321: */}
983     \}
984 L4322:
985     *irr = 0;
986 
987 \textcolor{comment}{/* ------------------------------------------------- */}
988 \textcolor{comment}{/* ---     THE PROCESSING OF FLOW FUNCTIONS ACROSS THE CURVE IS COMPLETE. */}
989 
990 L999:
991 
992     \textcolor{keywordflow}{return} 0;
993 \} \textcolor{comment}{/* floseg\_ */}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{FLOSEG_8c_ae676909061cd7cd0ffe5a99f54de2fef_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{FLOSEG_8c_ae676909061cd7cd0ffe5a99f54de2fef_icgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+@{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+}}
\index{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+@{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{\+\_\+\+B\+L\+N\+K\+\_\+\+\_\+}{_BLNK__}}]{\setlength{\rightskip}{0pt plus 5cm}struct \{ ... \}   \+\_\+\+B\+L\+N\+K\+\_\+\+\_\+}\hypertarget{FLOSEG_8c_a5ce107cfed3c87771544f53193b59d31}{}\label{FLOSEG_8c_a5ce107cfed3c87771544f53193b59d31}
\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!c\+\_\+\+\_\+0@{c\+\_\+\+\_\+0}}
\index{c\+\_\+\+\_\+0@{c\+\_\+\+\_\+0}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{c\+\_\+\+\_\+0}{c__0}}]{\setlength{\rightskip}{0pt plus 5cm}integer c\+\_\+\+\_\+0 = 0\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{FLOSEG_8c_a6a4ee26669af052a7e7fb5dda2b01f63}{}\label{FLOSEG_8c_a6a4ee26669af052a7e7fb5dda2b01f63}


Definition at line 48 of file F\+L\+O\+S\+E\+G.\+c.



Referenced by floseg\+\_\+().

\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!c\+\_\+\+\_\+1@{c\+\_\+\+\_\+1}}
\index{c\+\_\+\+\_\+1@{c\+\_\+\+\_\+1}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{c\+\_\+\+\_\+1}{c__1}}]{\setlength{\rightskip}{0pt plus 5cm}integer c\+\_\+\+\_\+1 = 1\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}{}\label{FLOSEG_8c_aac061f9822f71d2164eeeaae0e2a342c}


Definition at line 44 of file F\+L\+O\+S\+E\+G.\+c.



Referenced by floseg\+\_\+().

\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!c\+\_\+\+\_\+24@{c\+\_\+\+\_\+24}}
\index{c\+\_\+\+\_\+24@{c\+\_\+\+\_\+24}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{c\+\_\+\+\_\+24}{c__24}}]{\setlength{\rightskip}{0pt plus 5cm}integer c\+\_\+\+\_\+24 = 24\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{FLOSEG_8c_ab547b63b356ef99dc04f74ea358aa245}{}\label{FLOSEG_8c_ab547b63b356ef99dc04f74ea358aa245}


Definition at line 49 of file F\+L\+O\+S\+E\+G.\+c.



Referenced by floseg\+\_\+().

\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!c\+\_\+\+\_\+4@{c\+\_\+\+\_\+4}}
\index{c\+\_\+\+\_\+4@{c\+\_\+\+\_\+4}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{c\+\_\+\+\_\+4}{c__4}}]{\setlength{\rightskip}{0pt plus 5cm}integer c\+\_\+\+\_\+4 = 4\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{FLOSEG_8c_ab195470f8c6d55e333ee709af09ba2d6}{}\label{FLOSEG_8c_ab195470f8c6d55e333ee709af09ba2d6}


Definition at line 52 of file F\+L\+O\+S\+E\+G.\+c.



Referenced by floseg\+\_\+().

\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!c\+\_\+\+\_\+48@{c\+\_\+\+\_\+48}}
\index{c\+\_\+\+\_\+48@{c\+\_\+\+\_\+48}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{c\+\_\+\+\_\+48}{c__48}}]{\setlength{\rightskip}{0pt plus 5cm}integer c\+\_\+\+\_\+48 = 48\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{FLOSEG_8c_a7edaec1331969a1fc0e86088d783286e}{}\label{FLOSEG_8c_a7edaec1331969a1fc0e86088d783286e}


Definition at line 51 of file F\+L\+O\+S\+E\+G.\+c.



Referenced by floseg\+\_\+().

\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!c\+\_\+\+\_\+8@{c\+\_\+\+\_\+8}}
\index{c\+\_\+\+\_\+8@{c\+\_\+\+\_\+8}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{c\+\_\+\+\_\+8}{c__8}}]{\setlength{\rightskip}{0pt plus 5cm}integer c\+\_\+\+\_\+8 = 8\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{FLOSEG_8c_a0eeed1e607f74578e1b4643f08de6f36}{}\label{FLOSEG_8c_a0eeed1e607f74578e1b4643f08de6f36}


Definition at line 45 of file F\+L\+O\+S\+E\+G.\+c.



Referenced by floseg\+\_\+().

\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!c\+\_\+n1@{c\+\_\+n1}}
\index{c\+\_\+n1@{c\+\_\+n1}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{c\+\_\+n1}{c_n1}}]{\setlength{\rightskip}{0pt plus 5cm}integer c\+\_\+n1 = -\/1\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{FLOSEG_8c_a9e9287f317ef3436252a395791a899f6}{}\label{FLOSEG_8c_a9e9287f317ef3436252a395791a899f6}


Definition at line 47 of file F\+L\+O\+S\+E\+G.\+c.



Referenced by floseg\+\_\+().

\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!c\+\_\+n4@{c\+\_\+n4}}
\index{c\+\_\+n4@{c\+\_\+n4}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{c\+\_\+n4}{c_n4}}]{\setlength{\rightskip}{0pt plus 5cm}integer c\+\_\+n4 = -\/4\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{FLOSEG_8c_a900642cfb0fdb02c80380e0b73330cb5}{}\label{FLOSEG_8c_a900642cfb0fdb02c80380e0b73330cb5}


Definition at line 50 of file F\+L\+O\+S\+E\+G.\+c.



Referenced by floseg\+\_\+().

\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!c\+\_\+n54@{c\+\_\+n54}}
\index{c\+\_\+n54@{c\+\_\+n54}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{c\+\_\+n54}{c_n54}}]{\setlength{\rightskip}{0pt plus 5cm}integer c\+\_\+n54 = -\/54\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{FLOSEG_8c_ad0e41331e05e813dcc44fc78ce9d648f}{}\label{FLOSEG_8c_ad0e41331e05e813dcc44fc78ce9d648f}


Definition at line 46 of file F\+L\+O\+S\+E\+G.\+c.



Referenced by floseg\+\_\+().

\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!com@{com}}
\index{com@{com}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{com}{com}}]{\setlength{\rightskip}{0pt plus 5cm}doublereal com\mbox{[}36000\mbox{]}}\hypertarget{FLOSEG_8c_ac9e1ba82c0ed916fb992cf8f72d92ac0}{}\label{FLOSEG_8c_ac9e1ba82c0ed916fb992cf8f72d92ac0}


Definition at line 18 of file F\+L\+O\+S\+E\+G.\+c.

\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!darray@{darray}}
\index{darray@{darray}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{darray}{darray}}]{\setlength{\rightskip}{0pt plus 5cm}char darray\mbox{[}120\mbox{]}}\hypertarget{FLOSEG_8c_ad8149129b0ac5c966968e55ba6106146}{}\label{FLOSEG_8c_ad8149129b0ac5c966968e55ba6106146}


Definition at line 37 of file F\+L\+O\+S\+E\+G.\+c.

\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!darray\+\_\+@{darray\+\_\+}}
\index{darray\+\_\+@{darray\+\_\+}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{darray\+\_\+}{darray_}}]{\setlength{\rightskip}{0pt plus 5cm}struct \{ ... \}   darray\+\_\+}\hypertarget{FLOSEG_8c_a3782325cc3240c0e554c3d8d28814ee4}{}\label{FLOSEG_8c_a3782325cc3240c0e554c3d8d28814ee4}
\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!ibug@{ibug}}
\index{ibug@{ibug}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{ibug}{ibug}}]{\setlength{\rightskip}{0pt plus 5cm}integer ibug}\hypertarget{FLOSEG_8c_acf8cd9aebbc7f97517952bf2f89ed57c}{}\label{FLOSEG_8c_acf8cd9aebbc7f97517952bf2f89ed57c}


Definition at line 31 of file F\+L\+O\+S\+E\+G.\+c.

\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!ibugg\+\_\+@{ibugg\+\_\+}}
\index{ibugg\+\_\+@{ibugg\+\_\+}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{ibugg\+\_\+}{ibugg_}}]{\setlength{\rightskip}{0pt plus 5cm}struct \{ ... \}   ibugg\+\_\+}\hypertarget{FLOSEG_8c_abf885136954d7c11355b87e2d6b0bd09}{}\label{FLOSEG_8c_abf885136954d7c11355b87e2d6b0bd09}
\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!ipcolc@{ipcolc}}
\index{ipcolc@{ipcolc}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{ipcolc}{ipcolc}}]{\setlength{\rightskip}{0pt plus 5cm}integer ipcolc}\hypertarget{FLOSEG_8c_aa7c1d3b50810f4362d609ea905340770}{}\label{FLOSEG_8c_aa7c1d3b50810f4362d609ea905340770}


Definition at line 31 of file F\+L\+O\+S\+E\+G.\+c.

\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!ipcolm@{ipcolm}}
\index{ipcolm@{ipcolm}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{ipcolm}{ipcolm}}]{\setlength{\rightskip}{0pt plus 5cm}integer ipcolm}\hypertarget{FLOSEG_8c_ab16df98aac0af928eb1e69b5f3080334}{}\label{FLOSEG_8c_ab16df98aac0af928eb1e69b5f3080334}


Definition at line 31 of file F\+L\+O\+S\+E\+G.\+c.

\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!iscan@{iscan}}
\index{iscan@{iscan}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{iscan}{iscan}}]{\setlength{\rightskip}{0pt plus 5cm}integer iscan}\hypertarget{FLOSEG_8c_a4f36f70535ff45e43613827fb1a9c44c}{}\label{FLOSEG_8c_a4f36f70535ff45e43613827fb1a9c44c}


Definition at line 24 of file F\+L\+O\+S\+E\+G.\+c.

\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!nscnmx@{nscnmx}}
\index{nscnmx@{nscnmx}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{nscnmx}{nscnmx}}]{\setlength{\rightskip}{0pt plus 5cm}integer nscnmx}\hypertarget{FLOSEG_8c_ab26b43007e1470a6812269aedc276cc4}{}\label{FLOSEG_8c_ab26b43007e1470a6812269aedc276cc4}


Definition at line 24 of file F\+L\+O\+S\+E\+G.\+c.

\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!scan@{scan}}
\index{scan@{scan}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{scan}{scan}}]{\setlength{\rightskip}{0pt plus 5cm}doublereal scan\mbox{[}20000\mbox{]}}\hypertarget{FLOSEG_8c_a054b516dd6020a563cf155a4b217ec26}{}\label{FLOSEG_8c_a054b516dd6020a563cf155a4b217ec26}


Definition at line 25 of file F\+L\+O\+S\+E\+G.\+c.

\index{F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}!sspad\+\_\+@{sspad\+\_\+}}
\index{sspad\+\_\+@{sspad\+\_\+}!F\+L\+O\+S\+E\+G.\+c@{F\+L\+O\+S\+E\+G.\+c}}
\subsubsection[{\texorpdfstring{sspad\+\_\+}{sspad_}}]{\setlength{\rightskip}{0pt plus 5cm}struct \{ ... \}   sspad\+\_\+}\hypertarget{FLOSEG_8c_a855e143ab6e1d6bb108e7a8bb52f7e00}{}\label{FLOSEG_8c_a855e143ab6e1d6bb108e7a8bb52f7e00}
