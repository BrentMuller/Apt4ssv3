\hypertarget{FORCUB_8c}{}\section{F\+O\+R\+C\+U\+B.\+c File Reference}
\label{FORCUB_8c}\index{F\+O\+R\+C\+U\+B.\+c@{F\+O\+R\+C\+U\+B.\+c}}
{\ttfamily \#include \char`\"{}f2c.\+h\char`\"{}}\\*
Include dependency graph for F\+O\+R\+C\+U\+B.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=148pt]{FORCUB_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{FORCUB_8c_a85c8c12c025d65437e8b925db0a1e629}{forcub\+\_\+} (doublereal $\ast$pa, doublereal $\ast$pb, doublereal $\ast$pc, doublereal $\ast$pd, doublereal $\ast$\hyperlink{UTILTY_8c_aa38365a06b4e51426459eba3db71f888}{ta}, doublereal $\ast$td, integer $\ast$irr)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static integer \hyperlink{FORCUB_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\+\_\+\+\_\+1} = 1
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{F\+O\+R\+C\+U\+B.\+c@{F\+O\+R\+C\+U\+B.\+c}!forcub\+\_\+@{forcub\+\_\+}}
\index{forcub\+\_\+@{forcub\+\_\+}!F\+O\+R\+C\+U\+B.\+c@{F\+O\+R\+C\+U\+B.\+c}}
\subsubsection[{\texorpdfstring{forcub\+\_\+(doublereal $\ast$pa, doublereal $\ast$pb, doublereal $\ast$pc, doublereal $\ast$pd, doublereal $\ast$ta, doublereal $\ast$td, integer $\ast$irr)}{forcub_(doublereal *pa, doublereal *pb, doublereal *pc, doublereal *pd, doublereal *ta, doublereal *td, integer *irr)}}]{\setlength{\rightskip}{0pt plus 5cm}int forcub\+\_\+ (
\begin{DoxyParamCaption}
\item[{doublereal $\ast$}]{pa, }
\item[{doublereal $\ast$}]{pb, }
\item[{doublereal $\ast$}]{pc, }
\item[{doublereal $\ast$}]{pd, }
\item[{doublereal $\ast$}]{ta, }
\item[{doublereal $\ast$}]{td, }
\item[{integer $\ast$}]{irr}
\end{DoxyParamCaption}
)}\hypertarget{FORCUB_8c_a85c8c12c025d65437e8b925db0a1e629}{}\label{FORCUB_8c_a85c8c12c025d65437e8b925db0a1e629}


Definition at line 21 of file F\+O\+R\+C\+U\+B.\+c.



References beta, c\+\_\+\+\_\+1, clocub\+\_\+(), cosa, dif, dx, dy, f, i\+\_\+\+\_\+, j, norml3\+\_\+(), one, parint\+\_\+(), ra, sina, t1, t2, ta, and temp.



Referenced by curfit\+\_\+().


\begin{DoxyCode}
23 \{
24     \textcolor{comment}{/* System generated locals */}
25     doublereal d\_\_1, d\_\_2, d\_\_3;
26 
27     \textcolor{comment}{/* Builtin functions */}
28     \textcolor{keywordtype}{double} sqrt(doublereal), d\_sign(doublereal *, doublereal *);
29 
30     \textcolor{comment}{/* Local variables */}
31     \textcolor{keyword}{static} integer \hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}, \hyperlink{PRO026_8c_aa8c84707b22bdc99b810d3c7d3ec5d52}{j};
32     \textcolor{keyword}{static} doublereal \hyperlink{APT088_8c_a65f7891fccbfcf7d08964555630773b3}{t1}[3], \hyperlink{TRANSM_8c_aa4652e2d6053d420dcbea07a113db5fe}{t2}[3], qa[3], qb[3], qc[3], qd[3], cn[3], \hyperlink{APT301_8c_ae1d0d606e7eb860732925d6dbb82f18a}{dx}[3], 
33         \hyperlink{APT301_8c_a1aa95347d299564b1d20a922f0d7eb97}{dy}[3], \hyperlink{AERR2_8c_afd7904dc572e69a5db4ddf95d1a2cd5d}{ra}, rd, gx, gy, hx, hy, gl, hl, \hyperlink{DDPARA_8c_add158ec609178bc62ea2667b23b5ecec}{dif}[3], \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one}, pav[3], 
      \hyperlink{AXSET_8c_a0f4d8a67bb39acc583704de120c23b36}{beta}, 
34         difl, alph, \hyperlink{APT069_8c_ac8bea603620e8184eaf39b513a6a5ef6}{cosa}, cosd, \hyperlink{APT069_8c_a694d1e234c04670a207cbb6164b7902a}{sina}, sind, \hyperlink{APT100_8c_a5905d48604152cf57aa6bfa087b49173}{temp};
35     \textcolor{keyword}{static} integer idiag;
36     \textcolor{keyword}{static} doublereal vnull[3];
37     \textcolor{keyword}{extern} \textcolor{comment}{/* Subroutine */} \textcolor{keywordtype}{int} \hyperlink{NORML3_8c_afff34da020d3ad44d20adfd63925b981}{norml3\_}(doublereal *, doublereal *, 
38         doublereal *, doublereal *, integer *), \hyperlink{CLOCUB_8c_a9b20bb943d50b4574b80a549cc2f53f1}{clocub\_}(doublereal *, 
39         doublereal *, doublereal *, doublereal *, doublereal *, 
40         doublereal *, doublereal *, doublereal *, doublereal *, 
41         doublereal *, doublereal *, doublereal *, integer *), \hyperlink{PARINT_8c_ad02f1b1323bd1330bada2512898c2e59}{parint\_}(
42         doublereal *, doublereal *, doublereal *, doublereal *, 
43         doublereal *, integer *, integer *);
44 
45 \textcolor{comment}{/* ------INPUT IS FOUR SPACE POINTS PA,PB,PC,PD.   OUTPUT TA, TD DEFINES */}
46 \textcolor{comment}{/* ------A PARAMETRIC CUBIC CURVE WITH END POINTS PA,PD AND END TANGENT */}
47 \textcolor{comment}{/* ------VECTORS TA,TD  WHICH APPROXIMATES SMOOTHLY THE POINTS PB AND PC */}
48 \textcolor{comment}{/* ------THIS IS A COMPLETELY MODULAR APT SCULPTURED SURFACE ROUTINE */}
49 \textcolor{comment}{/* ------ WRITTEN AT IITRI APRIL 1970 --- JKH */}
50     \textcolor{comment}{/* Parameter adjustments */}
51     --td;
52     --\hyperlink{APT088_8c_ac56f1181f2a123c57b00a6514e809d02}{ta};
53     --pd;
54     --pc;
55     --pb;
56     --pa;
57 
58     \textcolor{comment}{/* Function Body */}
59     one = 1.f;
60     idiag = 18000;
61 \textcolor{comment}{/* ------AVERAGE INTERIOR POINTS PB,PC INTO PAV */}
62     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= 3; ++\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}) \{
63     dif[i\_\_ - 1] = pd[\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}] - pa[\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}];
64 \textcolor{comment}{/* L10: */}
65     pav[i\_\_ - 1] = (pb[\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}] + pc[\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}]) / 2.\hyperlink{APT102_8c_a7a51ed112e9b79f89e3e70beb8db8bf5}{f};
66     \}
67 \textcolor{comment}{/* Computing 2nd power */}
68     d\_\_1 = dif[0];
69 \textcolor{comment}{/* Computing 2nd power */}
70     d\_\_2 = dif[1];
71 \textcolor{comment}{/* Computing 2nd power */}
72     d\_\_3 = dif[2];
73     difl = sqrt(d\_\_1 * d\_\_1 + d\_\_2 * d\_\_2 + d\_\_3 * d\_\_3);
74     *irr = idiag + 1;
75     \textcolor{keywordflow}{if} (difl < 1e-10) \{
76     \textcolor{keywordflow}{return} 0;
77     \}
78 \textcolor{comment}{/* ------CONSTRUCT THE AVERAGED NORMAL TO PA,PAV,PD */}
79     \hyperlink{NORML3_8c_afff34da020d3ad44d20adfd63925b981}{norml3\_}(&pa[1], pav, &pd[1], cn, irr);
80     \textcolor{keywordflow}{if} (*irr != 0) \{
81     \hyperlink{NORML3_8c_afff34da020d3ad44d20adfd63925b981}{norml3\_}(&pa[1], &pb[1], &pd[1], cn, irr);
82     \}
83     \textcolor{keywordflow}{if} (*irr != 0) \{
84     \hyperlink{NORML3_8c_afff34da020d3ad44d20adfd63925b981}{norml3\_}(&pa[1], &pc[1], &pd[1], cn, irr);
85     \}
86     \textcolor{keywordflow}{if} (*irr == 0) \{
87     \textcolor{keywordflow}{goto} L20;
88     \}
89 \textcolor{comment}{/* ------STRAIGHT LINE CASE */}
90     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= 3; ++\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}) \{
91     \hyperlink{APT088_8c_ac56f1181f2a123c57b00a6514e809d02}{ta}[\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}] = dif[i\_\_ - 1];
92 \textcolor{comment}{/* L30: */}
93     td[\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}] = dif[i\_\_ - 1];
94     \}
95     *irr = 0;
96     \textcolor{keywordflow}{return} 0;
97 L20:
98 \textcolor{comment}{/* ------CONSIDER THE COMMON PLANE THROUGH PA,PB WITH NORMAL CN */}
99 \textcolor{comment}{/* ------CONSTRUCT ORTHOGONAL COORDINATE VECTORS DX AND DY IN THIS PLANE */}
100     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= 3; ++\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}) \{
101 \textcolor{comment}{/* L40: */}
102     dx[i\_\_ - 1] = dif[i\_\_ - 1] / difl;
103     \}
104     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= 3; ++\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}) \{
105 \textcolor{comment}{/* L50: */}
106     vnull[i\_\_ - 1] = 0.f;
107     \}
108     \hyperlink{NORML3_8c_afff34da020d3ad44d20adfd63925b981}{norml3\_}(vnull, cn, dx, dy, irr);
109 \textcolor{comment}{/* ------NOW PROJECT ALL POINTS PA,PB,PC,PD ONTO THE AVERAGED PLANE. */}
110 \textcolor{comment}{/* ------CALL THE PROJECTIONS BY QA,QB,QC,QD */}
111     qa[0] = 0.f;
112     qa[1] = 0.f;
113     qa[2] = 0.f;
114     qd[0] = difl;
115     qd[1] = 0.f;
116     qd[2] = 0.f;
117     \textcolor{keywordflow}{for} (j = 1; j <= 3; ++\hyperlink{PRO026_8c_aa8c84707b22bdc99b810d3c7d3ec5d52}{j}) \{
118     qb[j - 1] = 0.f;
119 \textcolor{comment}{/* L300: */}
120     qc[j - 1] = 0.f;
121     \}
122     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= 3; ++\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}) \{
123     qb[0] += (pb[\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}] - pa[\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}]) * dx[i\_\_ - 1];
124     qb[1] += (pb[\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}] - pa[\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}]) * dy[i\_\_ - 1];
125     qc[0] += (pc[\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}] - pa[\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}]) * dx[i\_\_ - 1];
126     qc[1] += (pc[\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}] - pa[\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}]) * dy[i\_\_ - 1];
127 \textcolor{comment}{/* L310: */}
128     \}
129 \textcolor{comment}{/* ------NOW INTERPOLATE TANGENT VECTORS AND RADII AT EACH END OF THE */}
130 \textcolor{comment}{/* ------CURVE (USING A PARABOLIC APPROXIMATION) */}
131     \hyperlink{PARINT_8c_ad02f1b1323bd1330bada2512898c2e59}{parint\_}(&pa[1], &pb[1], &pc[1], t1, &ra, &\hyperlink{FORCUB_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, irr);
132 \textcolor{comment}{/* ------ADJUST THE SIGN OF THE RADIUS */}
133     temp = qb[0] * qc[1] - qb[1] * qc[0];
134     ra = abs(ra) * d\_sign(&one, &temp);
135 \textcolor{comment}{/* ------CONVERT FROM RADIUS TO CURVATURE */}
136     \textcolor{keywordflow}{if} (ra > 1e8) \{
137     ra = 1e-8;
138     \}
139     \textcolor{keywordflow}{if} (ra <= 1e8) \{
140     ra = 1.f / \hyperlink{AERR2_8c_afd7904dc572e69a5db4ddf95d1a2cd5d}{ra};
141     \}
142     \hyperlink{PARINT_8c_ad02f1b1323bd1330bada2512898c2e59}{parint\_}(&pd[1], &pc[1], &pb[1], t2, &rd, &\hyperlink{FORCUB_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, irr);
143     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= 3; ++\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}) \{
144 \textcolor{comment}{/* L60: */}
145     t2[i\_\_ - 1] = -t2[i\_\_ - 1];
146     \}
147     temp -= difl * (qc[1] - qb[1]);
148     rd = abs(rd) * d\_sign(&one, &temp);
149 \textcolor{comment}{/* ------CONVERT FROM RADIUS TO CURVATURE */}
150     \textcolor{keywordflow}{if} (rd <= 1e8) \{
151     rd = 1.f / rd;
152     \}
153     \textcolor{keywordflow}{if} (rd > 1e8) \{
154     rd = 1e-8;
155     \}
156 \textcolor{comment}{/* ------NOW END TANGENTS AND END RADII HAVE BEEN APPROXIMATED IN THE */}
157 \textcolor{comment}{/* ------AVERAGED PLANE */}
158 \textcolor{comment}{/* ------NOW OBTAIN COMPONENTS OF THE INTERPOLATED TANGENTS T1 AND T2 IN */}
159 \textcolor{comment}{/* ------THE AVERAGED PLANE */}
160     gx = t1[0] * dx[0] + t1[1] * dx[1] + t1[2] * dx[2];
161     gy = t1[0] * dy[0] + t1[1] * dy[1] + t1[2] * dy[2];
162     hx = t2[0] * dx[0] + t2[1] * dx[1] + t2[2] * dx[2];
163     hy = t2[0] * dy[0] + t2[1] * dy[1] + t2[2] * dy[2];
164     gl = sqrt(gx * gx + gy * gy);
165     hl = sqrt(hx * hx + hy * hy);
166 \textcolor{comment}{/* ------MODIFY THE SPACE CURVATURES RA AND RD BY THEIR PROJECTIONS ON THE */}
167 \textcolor{comment}{/* ------AVERAGED PLANE */}
168     cosa = cn[0] * t1[0] + cn[1] * t1[1] + cn[2] * t1[2];
169     temp = (d\_\_1 = one - cosa * \hyperlink{APT069_8c_ac8bea603620e8184eaf39b513a6a5ef6}{cosa}, abs(d\_\_1));
170     sina = sqrt(temp);
171     cosd = cn[0] * t2[0] + cn[1] * t2[1] + cn[2] * t2[2];
172     temp = (d\_\_1 = one - cosd * cosd, abs(d\_\_1));
173     sind = sqrt(temp);
174     ra /= \hyperlink{APT069_8c_a694d1e234c04670a207cbb6164b7902a}{sina};
175     rd /= sind;
176 \textcolor{comment}{/* ------NOW SOLVE IN THE AVERAGED PLANE FOR A PARAMETRIC PLANAR CUBIC */}
177 \textcolor{comment}{/* ------WITH END POINTS QA,QD AND END TANGENTS GX,GY AND HX,HY , AND */}
178 \textcolor{comment}{/* ------WITH END CURVATURE RA AND RB */}
179 \textcolor{comment}{/* ------THE OUTPUT ALPH,BETA GIVES THE SIGNED MULTIPLIERS OF THE INPUT */}
180 \textcolor{comment}{/* ------VECTORS GX ,GY AND HX,HY. */}
181     \hyperlink{CLOCUB_8c_a9b20bb943d50b4574b80a549cc2f53f1}{clocub\_}(qa, &qa[1], qd, &qd[1], &gx, &gy, &hx, &hy, &ra, &rd, &alph, &
182         beta, irr);
183     \textcolor{keywordflow}{if} (*irr != 0) \{
184     \textcolor{keywordflow}{return} 0;
185     \}
186 \textcolor{comment}{/* ------PROJECT THE PLANAR SOLUTIONS ONTO THE INTERPOLATED SPACE */}
187 \textcolor{comment}{/* ------TANGENTS FOR A FINAL ANSWER */}
188     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= 3; ++\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}) \{
189     \hyperlink{APT088_8c_ac56f1181f2a123c57b00a6514e809d02}{ta}[\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}] = alph * t1[i\_\_ - 1] / gl;
190 \textcolor{comment}{/* L200: */}
191     td[\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}] = beta * t2[i\_\_ - 1] / hl;
192     \}
193     *irr = 0;
194     \textcolor{keywordflow}{return} 0;
195 \} \textcolor{comment}{/* forcub\_ */}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{FORCUB_8c_a85c8c12c025d65437e8b925db0a1e629_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{FORCUB_8c_a85c8c12c025d65437e8b925db0a1e629_icgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\index{F\+O\+R\+C\+U\+B.\+c@{F\+O\+R\+C\+U\+B.\+c}!c\+\_\+\+\_\+1@{c\+\_\+\+\_\+1}}
\index{c\+\_\+\+\_\+1@{c\+\_\+\+\_\+1}!F\+O\+R\+C\+U\+B.\+c@{F\+O\+R\+C\+U\+B.\+c}}
\subsubsection[{\texorpdfstring{c\+\_\+\+\_\+1}{c__1}}]{\setlength{\rightskip}{0pt plus 5cm}integer c\+\_\+\+\_\+1 = 1\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{FORCUB_8c_aac061f9822f71d2164eeeaae0e2a342c}{}\label{FORCUB_8c_aac061f9822f71d2164eeeaae0e2a342c}


Definition at line 17 of file F\+O\+R\+C\+U\+B.\+c.



Referenced by forcub\+\_\+().

