\hypertarget{CURFLO_8c}{}\section{C\+U\+R\+F\+L\+O.\+c File Reference}
\label{CURFLO_8c}\index{C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}}
{\ttfamily \#include \char`\"{}f2c.\+h\char`\"{}}\\*
Include dependency graph for C\+U\+R\+F\+L\+O.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=146pt]{CURFLO_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{CURFLO_8c_a6a01fdbcd4e9ab45bf32c168785cc8a6}{darray\+\_\+1}~\hyperlink{XCANON_8c_a01023c467b63fbe7d0676e9952161ec5}{darray\+\_\+}
\item 
\#define \hyperlink{CURFLO_8c_aa2a88aa3f2e858e87f5074fadc0e1d8e}{ibugg\+\_\+1}~\hyperlink{XTPCAL_8c_a00d42583c036d05afed4d07a03432522}{ibugg\+\_\+}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{CURFLO_8c_a0b62b83550ba1c0345040e1d700fdeba}{curflo\+\_\+} (doublereal $\ast$uin, doublereal $\ast$\hyperlink{ZSURF_8c_a9cae3e36ae5e63785447451b6081dc98}{sc}, doublereal $\ast$cv, integer $\ast$\hyperlink{APT331_8c_af613cadd5cf49515a2b8790d3bfd56af}{mode}, integer $\ast$nnseg)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\begin{tabbing}
xx\=xx\=xx\=xx\=xx\=xx\=xx\=xx\=xx\=\kill
struct \{\\
\>char \hyperlink{CURFLO_8c_ad8149129b0ac5c966968e55ba6106146}{darray} \mbox{[}120\mbox{]}\\
\} \hyperlink{CURFLO_8c_af51148698e59d8219f4e1af4e7f8bbcc}{darray\_}\\

\end{tabbing}\item 
\begin{tabbing}
xx\=xx\=xx\=xx\=xx\=xx\=xx\=xx\=xx\=\kill
struct \{\\
\>integer \hyperlink{CURFLO_8c_acf8cd9aebbc7f97517952bf2f89ed57c}{ibug}\\
\>integer \hyperlink{CURFLO_8c_aa7c1d3b50810f4362d609ea905340770}{ipcolc}\\
\>integer \hyperlink{CURFLO_8c_a0def98d78ab8101d518729447f28e4e8}{ipcomc}\\
\} \hyperlink{CURFLO_8c_a33e2ef86cf11003407b35d9236c94679}{ibugg\_}\\

\end{tabbing}\item 
static integer \hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\+\_\+\+\_\+1} = 1
\item 
static integer \hyperlink{CURFLO_8c_a6a4ee26669af052a7e7fb5dda2b01f63}{c\+\_\+\+\_\+0} = 0
\item 
static integer \hyperlink{CURFLO_8c_a9e9287f317ef3436252a395791a899f6}{c\+\_\+n1} = -\/1
\item 
static integer \hyperlink{CURFLO_8c_a900642cfb0fdb02c80380e0b73330cb5}{c\+\_\+n4} = -\/4
\item 
static integer \hyperlink{CURFLO_8c_ab547b63b356ef99dc04f74ea358aa245}{c\+\_\+\+\_\+24} = 24
\item 
static integer \hyperlink{CURFLO_8c_a3685742eafc43c67e05ca885c8ad5511}{c\+\_\+\+\_\+333} = 333
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\index{C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}!darray\+\_\+1@{darray\+\_\+1}}
\index{darray\+\_\+1@{darray\+\_\+1}!C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}}
\subsubsection[{\texorpdfstring{darray\+\_\+1}{darray_1}}]{\setlength{\rightskip}{0pt plus 5cm}\#define darray\+\_\+1~{\bf darray\+\_\+}}\hypertarget{CURFLO_8c_a6a01fdbcd4e9ab45bf32c168785cc8a6}{}\label{CURFLO_8c_a6a01fdbcd4e9ab45bf32c168785cc8a6}


Definition at line 21 of file C\+U\+R\+F\+L\+O.\+c.



Referenced by curflo\+\_\+().

\index{C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}!ibugg\+\_\+1@{ibugg\+\_\+1}}
\index{ibugg\+\_\+1@{ibugg\+\_\+1}!C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}}
\subsubsection[{\texorpdfstring{ibugg\+\_\+1}{ibugg_1}}]{\setlength{\rightskip}{0pt plus 5cm}\#define ibugg\+\_\+1~{\bf ibugg\+\_\+}}\hypertarget{CURFLO_8c_aa2a88aa3f2e858e87f5074fadc0e1d8e}{}\label{CURFLO_8c_aa2a88aa3f2e858e87f5074fadc0e1d8e}


Definition at line 27 of file C\+U\+R\+F\+L\+O.\+c.



Referenced by curflo\+\_\+().



\subsection{Function Documentation}
\index{C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}!curflo\+\_\+@{curflo\+\_\+}}
\index{curflo\+\_\+@{curflo\+\_\+}!C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}}
\subsubsection[{\texorpdfstring{curflo\+\_\+(doublereal $\ast$uin, doublereal $\ast$sc, doublereal $\ast$cv, integer $\ast$mode, integer $\ast$nnseg)}{curflo_(doublereal *uin, doublereal *sc, doublereal *cv, integer *mode, integer *nnseg)}}]{\setlength{\rightskip}{0pt plus 5cm}int curflo\+\_\+ (
\begin{DoxyParamCaption}
\item[{doublereal $\ast$}]{uin, }
\item[{doublereal $\ast$}]{sc, }
\item[{doublereal $\ast$}]{cv, }
\item[{integer $\ast$}]{mode, }
\item[{integer $\ast$}]{nnseg}
\end{DoxyParamCaption}
)}\hypertarget{CURFLO_8c_a0b62b83550ba1c0345040e1d700fdeba}{}\label{CURFLO_8c_a0b62b83550ba1c0345040e1d700fdeba}


Definition at line 40 of file C\+U\+R\+F\+L\+O.\+c.



References bad\+\_\+(), c\+\_\+\+\_\+0, c\+\_\+\+\_\+1, c\+\_\+\+\_\+24, c\+\_\+\+\_\+333, c\+\_\+n1, c\+\_\+n4, cform\+\_\+(), cncurv\+\_\+(), cprint\+\_\+(), crblen\+\_\+(), cross\+\_\+(), darray\+\_\+1, f, i\+\_\+\+\_\+, ibugg\+\_\+1, iseg, j, l, one, sc, scdump\+\_\+(), temp, u, ua, up, upp, vnorm\+\_\+(), w, w1, and zero.



Referenced by apt109\+\_\+(), cnsurh\+\_\+(), crsfit\+\_\+(), dgeom\+\_\+(), gencrv\+\_\+(), gop\+\_\+(), and scpict\+\_\+().


\begin{DoxyCode}
42 \{
43     \textcolor{comment}{/* Initialized data */}
44 
45     \textcolor{keyword}{static} doublereal \hyperlink{APT301_8c_a361b1d0588e13a7b5994f24b40138ec0}{zero} = 0.;
46     \textcolor{keyword}{static} doublereal \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one} = 1.;
47     \textcolor{keyword}{static} doublereal smal = 1e-7;
48 
49     \textcolor{comment}{/* System generated locals */}
50     integer i\_\_1;
51     doublereal d\_\_1, d\_\_2, d\_\_3;
52 
53     \textcolor{comment}{/* Builtin functions */}
54     \textcolor{keywordtype}{double} sqrt(doublereal);
55 
56     \textcolor{comment}{/* Local variables */}
57     \textcolor{keyword}{static} integer \hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}, \hyperlink{PRO026_8c_aa8c84707b22bdc99b810d3c7d3ec5d52}{j}, \hyperlink{PRO026_8c_a1cb503ddd20ff3cf9588d2b5abd202d8}{l};
58     \textcolor{keyword}{static} doublereal \hyperlink{APT088_8c_a1f9aca42e2010bb82488684dee1a66ea}{u}, \hyperlink{DDRLSR_8c_a6c6772207c061db8f6ca77c2661f497a}{w}, \hyperlink{SETVER_8c_a79a66cb9bf8fd1717a49e13f26283cbc}{w1}, w2, \hyperlink{APT109_8c_a805070ec05d12594ca986c059b87b2c0}{ua}, ub;
59     \textcolor{keyword}{static} integer nn;
60     \textcolor{keyword}{static} doublereal pu, \hyperlink{DDTABC_8c_a0337592b74197133c4203f6dce657a76}{up};
61     \textcolor{keyword}{extern} \textcolor{comment}{/* Subroutine */} \textcolor{keywordtype}{int} \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}();
62     \textcolor{keyword}{static} doublereal uma, umb, ulo, \hyperlink{AERR2_8c_a0ed8e24d788f96176ad6340f44528535}{upp}, frac;
63     \textcolor{keyword}{static} integer iarc, \hyperlink{AERR_8c_abdc936055e6863ee32f47ab3666ef718}{iseg};
64     \textcolor{keyword}{static} doublereal span;
65     \textcolor{keyword}{static} integer nmax;
66     \textcolor{keyword}{static} doublereal \hyperlink{APT100_8c_a5905d48604152cf57aa6bfa087b49173}{temp}[16]  \textcolor{comment}{/* was [4][4] */};
67     \textcolor{keyword}{static} integer merr, ispl;
68     \textcolor{keyword}{static} doublereal upsq;
69     \textcolor{keyword}{static} integer iarc1, iarc2, inseg;
70     \textcolor{keyword}{extern} \textcolor{comment}{/* Subroutine */} \textcolor{keywordtype}{int} \hyperlink{CFORM_8c_ac1d4f86996388dd43d61bc383e8ecfc4}{cform\_}(\textcolor{keywordtype}{char} *, \textcolor{keywordtype}{char} *, integer *, integer *, 
71         ftnlen, ftnlen), \hyperlink{UTILTY_8c_a58ae76ce755b09f1dcba2597c6be3859}{cross\_}(doublereal *, doublereal *, doublereal *),
72          \hyperlink{UTILTY_8c_a46efcd0a33c423bde8c314847c49a645}{vnorm\_}(doublereal *, doublereal *);
73     \textcolor{keyword}{static} integer iflow1, iflow2, locarc;
74     \textcolor{keyword}{extern} \textcolor{comment}{/* Subroutine */} \textcolor{keywordtype}{int} \hyperlink{CRBLEN_8c_a5a4cc6211822994020957320e36846b3}{crblen\_}(doublereal *, doublereal *, 
75         doublereal *, integer *);
76     \textcolor{keyword}{static} integer locseg;
77     \textcolor{keyword}{extern} \textcolor{comment}{/* Subroutine */} \textcolor{keywordtype}{int} \hyperlink{SCDUMP_8c_a407ea0ec05de474d31cb34c209fe3571}{scdump\_}(integer *, doublereal *), \hyperlink{CPRINT_8c_a162e4af07e13f17e2aa965863091b687}{cprint\_}(
78         \textcolor{keywordtype}{char} *, ftnlen), \hyperlink{CNCURV_8c_a04761b7674edc68920b6ae1f87beb0b5}{cncurv\_}(doublereal *, doublereal *, doublereal *,
79          integer *);
80 
81 \textcolor{comment}{/* ---     PURPOSE IS TO COMPUTE CURVE POINT AND DERIVATIVES FROM AN */}
82 \textcolor{comment}{/* ---     INPUT PARAMETRIC VALUE U.  SC IS THE COMPLETE INPUT CURVE */}
83 \textcolor{comment}{/* ---     CANONICAL FORM AND MODE IS ZERO FOR POINT EXTRACTION, */}
84 \textcolor{comment}{/* ---     AND NON ZERO IF FIRST AND SECONDERIVATIVES ARE ALSO */}
85 \textcolor{comment}{/* ---     DESIRED.   CV IS THE OUTPUT ARRAY. CV(1-3) CONTAINS */}
86 \textcolor{comment}{/* ---     THE CURVE POINT, CV(5-7) CONTAINS THE FIRST DERIVATIVE, */}
87 \textcolor{comment}{/* ---     CV(9-11) THE SECOND DERIVATIVE AND CV(13-15) CONTAINS */}
88 \textcolor{comment}{/* ---     THE UNITIZED TANGENT VECTOR */}
89 \textcolor{comment}{/* ---     IF MODE=2 ON INPUT THEN CV(17-19) CONTAINS THE CRSSPL VECOTR, */}
90 \textcolor{comment}{/* ---     CV(21-23) THE TWIST ETC. ANALAGOUS TO THE CURVE POINT */}
91 \textcolor{comment}{/* ---     AND TANGENT VECTOR ETC. */}
92 \textcolor{comment}{/* ---     IF THESE QUANTITIES DO NOT EXIST, THE UPPER PART IS ZEROED. */}
93 \textcolor{comment}{/* ---     INPUT  INSEG IS NORMALLY 0.  HOWEVER, IF INSEG */}
94 \textcolor{comment}{/* ---     IS POSITIVE THEN INSEG IS INTERPRETED AS A SPECIFIC */}
95 \textcolor{comment}{/* ---     SEGMENT NUMBER AND UIN IS A PARAMETER */}
96 \textcolor{comment}{/* ---     RELATIVE TO THIS SEGMENT ONLY.  IF UIN IS OUTSIDE THE */}
97 \textcolor{comment}{/* ---     0,1 RANGE THE A POINT ON THE LINEAR EXTENSION OF THIS */}
98 \textcolor{comment}{/* ---     SEGMENT WILL BE GENERATED.  IF INSEG IS NEGATIVE, THEN */}
99 \textcolor{comment}{/* ---     THE ABSOLUTE VALUE REFERS TO A SEGMENT COUNTING BACKWARD FROM */}
100 \textcolor{comment}{/* ---     THE LAST SEGMENT OF THE CURVE. */}
101 \textcolor{comment}{/* ---     IN EITHER CASE, INSEG MUST REFER TO A LEGITIMATE SEGMENT. */}
102 
103 \textcolor{comment}{/*   ***  20.  DARRAY BLOCK  *** */}
104 
105 \textcolor{comment}{/*   PRINT BUFFER */}
106 
107 
108 
109     \textcolor{comment}{/* Parameter adjustments */}
110     --cv;
111     --\hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc};
112 
113     \textcolor{comment}{/* Function Body */}
114 
115     inseg = *nnseg;
116     merr = 0;
117 
118 
119     nmax = (integer) \hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[8];
120 \textcolor{comment}{/* ---     IF NMAX IS ZERO THERE IS NO FLOW STRUCTURE */}
121 \textcolor{comment}{/* ---     THEN TREAT INDIVIDUAL ARCS AS CURVE SEGMENTS USING */}
122 \textcolor{comment}{/* ---     THE NATURAL COON PARAMETER AS FLOW. */}
123     \textcolor{keywordflow}{if} (nmax == 0) \{
124     \textcolor{keywordflow}{goto} L300;
125     \}
126     \textcolor{keywordflow}{if} (inseg == 0) \{
127     \textcolor{keywordflow}{goto} L5;
128     \}
129 
130     merr = 1;
131     \textcolor{keywordflow}{if} (abs(inseg) > nmax) \{
132     \textcolor{keywordflow}{goto} L998;
133     \}
134     iseg = abs(inseg);
135     \textcolor{keywordflow}{if} (inseg < 0) \{
136     iseg = nmax - iseg + 1;
137     \}
138     u = *uin;
139     \textcolor{keywordflow}{if} (inseg < 0) \{
140     u = one - \hyperlink{APT088_8c_a1f9aca42e2010bb82488684dee1a66ea}{u};
141     \}
142     frac = \hyperlink{APT088_8c_a1f9aca42e2010bb82488684dee1a66ea}{u};
143     locseg = (integer) (\hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[9] + (iseg - 1 << 2));
144     \textcolor{keywordflow}{if} (\hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[locseg + 3] < smal) \{
145     \textcolor{keywordflow}{goto} L200;
146     \}
147     \textcolor{keywordflow}{if} (u >= zero && u <= one) \{
148     \textcolor{keywordflow}{goto} L30;
149     \}
150     locarc = (integer) \hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[7];
151     iarc = (integer) (locarc + \hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[locseg] * 4.\hyperlink{APT102_8c_a7a51ed112e9b79f89e3e70beb8db8bf5}{f});
152     \textcolor{keywordflow}{if} (u > one) \{
153     iarc = (integer) (iarc + (\hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[locseg + 1] - one) * 4.f);
154     \}
155     ispl = (integer) \hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[iarc];
156     \textcolor{keywordflow}{if} (u > one) \{
157     ispl = (integer) (ispl + (\hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[iarc + 1] - one - one) * 4.f);
158     \}
159     iarc = (iarc - locarc) / 4 + 1;
160     \textcolor{keywordflow}{goto} L80;
161 
162 L5:
163     u = *uin;
164     \textcolor{keywordflow}{if} (u < zero) \{
165     \textcolor{keywordflow}{goto} L10;
166     \}
167     \textcolor{keywordflow}{if} (u > \hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[8]) \{
168     \textcolor{keywordflow}{goto} L20;
169     \}
170 \textcolor{comment}{/* ---      OBTAIN SEGMENT NUMBER AND FRACTIONAL AMOUNT */}
171     iseg = (integer) u;
172     frac = u - \hyperlink{AERR_8c_abdc936055e6863ee32f47ab3666ef718}{iseg};
173     nmax = (integer) \hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[8];
174     ++\hyperlink{AERR_8c_abdc936055e6863ee32f47ab3666ef718}{iseg};
175     \textcolor{keywordflow}{if} (iseg > nmax) \{
176     frac = \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one};
177     \}
178     \textcolor{keywordflow}{if} (iseg > nmax) \{
179     --\hyperlink{AERR_8c_abdc936055e6863ee32f47ab3666ef718}{iseg};
180     \}
181     \textcolor{keywordflow}{goto} L30;
182 
183 L10:
184     iseg = 1;
185     frac = \hyperlink{APT088_8c_a1f9aca42e2010bb82488684dee1a66ea}{u};
186     ispl = (integer) \hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[11];
187     iarc = 1;
188 
189     locseg = (integer) (\hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[9] + (iseg - 1 << 2));
190 \textcolor{comment}{/* ---     BRANCH FOR CASE OF A DEGENERATE SEGMENT */}
191     \textcolor{keywordflow}{if} (\hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[locseg + 3] < smal) \{
192     \textcolor{keywordflow}{goto} L200;
193     \}
194     \textcolor{keywordflow}{goto} L80;
195 
196 L20:
197     iseg = (integer) \hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[8];
198     frac = u - \hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[8] + \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one};
199     ispl = (integer) (\hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[11] + \hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[10] * 4.f - 8.f);
200     iarc = (integer) \hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[4];
201 
202     locseg = (integer) (\hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[9] + (iseg - 1 << 2));
203 \textcolor{comment}{/* ---     BRANCH FOR CASE OF A DEGENERATE SEGMENT */}
204     \textcolor{keywordflow}{if} (\hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[locseg + 3] < smal) \{
205     \textcolor{keywordflow}{goto} L200;
206     \}
207     \textcolor{keywordflow}{goto} L80;
208 
209 L30:
210 
211     locseg = (integer) (\hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[9] + (iseg - 1 << 2));
212 \textcolor{comment}{/* ---     BRANCH FOR CASE OF A DEGENERATE SEGMENT */}
213     \textcolor{keywordflow}{if} (\hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[locseg + 3] < smal) \{
214     \textcolor{keywordflow}{goto} L200;
215     \}
216 \textcolor{comment}{/* ---     COMPUTE STARTING AND ENDING ARCS FOR THIS SEGMENT(ISEG) */}
217     locarc = (integer) \hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[7];
218     iarc1 = (integer) (locarc + \hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[locseg] * 4.f);
219     iarc2 = (integer) (iarc1 + (\hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[locseg + 1] - one) * 4.f);
220 \textcolor{comment}{/* ---     FIND  AN ARC WHICH INCLUDES THE FRACTIONAL VALUE */}
221     i\_\_1 = iarc2;
222     \textcolor{keywordflow}{for} (iarc = iarc1; iarc <= i\_\_1; iarc += 4) \{
223     iflow1 = (integer) \hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[iarc];
224     iflow2 = (integer) ((\hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[iarc + 1] - one) * 4.f + \hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[iarc]);
225     \textcolor{keywordflow}{if} (frac >= \hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[iflow1] && frac < \hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[iflow2] + smal) \{
226         \textcolor{keywordflow}{goto} L60;
227     \}
228 \textcolor{comment}{/* L50: */}
229     \}
230     merr = 2;
231     \textcolor{keywordflow}{goto} L998;
232 \textcolor{comment}{/* --- */}
233 L60:
234 \textcolor{comment}{/* ---     CONVERT ARC REFERENCE TO AN ABSOLUTE */}
235     iarc = (iarc - locarc) / 4 + 1;
236 \textcolor{comment}{/* ---     LOCATE FRAC WITHIN THE RANGE OF ONE FLOW FUNCTION */}
237     i\_\_1 = iflow2;
238     \textcolor{keywordflow}{for} (ispl = iflow1; ispl <= i\_\_1; ispl += 4) \{
239     \textcolor{keywordflow}{if} (frac >= \hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[ispl] && frac < \hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[ispl + 4] + smal) \{
240         \textcolor{keywordflow}{goto} L80;
241     \}
242 \textcolor{comment}{/* L70: */}
243     \}
244     merr = 3;
245     \textcolor{keywordflow}{goto} L998;
246 
247 L80:
248     \textcolor{keywordflow}{if} (\hyperlink{CURFLO_8c_aa2a88aa3f2e858e87f5074fadc0e1d8e}{ibugg\_1}.ibug != 11) \{
249     \textcolor{keywordflow}{goto} L83;
250     \}
251     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"U   "}, &u, (ftnlen)4);
252     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"FRAC"}, &frac, (ftnlen)4);
253     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{CURFLO_8c_a6a4ee26669af052a7e7fb5dda2b01f63}{c\_\_0}, \textcolor{stringliteral}{"SEG "}, &iseg, (ftnlen)4);
254     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{CURFLO_8c_a6a4ee26669af052a7e7fb5dda2b01f63}{c\_\_0}, \textcolor{stringliteral}{"IARC"}, &iarc, (ftnlen)4);
255     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{CURFLO_8c_a6a4ee26669af052a7e7fb5dda2b01f63}{c\_\_0}, \textcolor{stringliteral}{"ISPL"}, &ispl, (ftnlen)4);
256     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_a9e9287f317ef3436252a395791a899f6}{c\_n1}, &\hyperlink{CURFLO_8c_a6a4ee26669af052a7e7fb5dda2b01f63}{c\_\_0}, \textcolor{stringliteral}{"LOCS"}, &locseg, (ftnlen)4);
257 L83:
258 
259     \textcolor{keywordflow}{if} (frac < zero) \{
260     \textcolor{keywordflow}{goto} L85;
261     \}
262     \textcolor{keywordflow}{if} (frac > one) \{
263     \textcolor{keywordflow}{goto} L87;
264     \}
265 \textcolor{comment}{/* ---      CASE WHERE FRAC IS BETWEEN ZERO AND ONE */}
266 
267     pu = frac - \hyperlink{APT108_8c_a03ede5fb0d1eb2158dbb5f2aeb7a5066}{sc}[ispl];
268     span = sc[ispl + 4] - sc[ispl];
269     \textcolor{keywordflow}{if} (span == zero) \{
270     \textcolor{keywordflow}{goto} L81;
271     \}
272     pu /= span;
273     ua = sc[ispl + 1];
274     ub = sc[ispl + 5];
275     uma = sc[ispl + 2] * span;
276     umb = sc[ispl + 6] * span;
277     \textcolor{keywordflow}{goto} L89;
278 
279 L85:
280 \textcolor{comment}{/* ---      CASE WHERE FRAC IS LT ZERO */}
281     pu = frac - sc[ispl];
282     span = sc[ispl + 4] - sc[ispl];
283     \textcolor{keywordflow}{if} (span == zero) \{
284     \textcolor{keywordflow}{goto} L81;
285     \}
286     pu /= span;
287     ua = sc[ispl + 1];
288     uma = sc[ispl + 2] * span;
289     ub = uma;
290     umb = uma;
291     \textcolor{keywordflow}{goto} L89;
292 
293 L87:
294     pu = frac - sc[ispl];
295     span = sc[ispl] - sc[ispl - 4];
296     \textcolor{keywordflow}{if} (span == zero) \{
297     \textcolor{keywordflow}{goto} L81;
298     \}
299     pu /= span;
300     ub = \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one};
301     umb = sc[ispl + 2] * span;
302     ua = ub - umb;
303     uma = umb;
304     \textcolor{keywordflow}{goto} L89;
305 
306 L81:
307     u = \hyperlink{APT109_8c_a805070ec05d12594ca986c059b87b2c0}{ua};
308     up = \hyperlink{APT301_8c_a361b1d0588e13a7b5994f24b40138ec0}{zero};
309     upp = \hyperlink{APT301_8c_a361b1d0588e13a7b5994f24b40138ec0}{zero};
310     upsq = \hyperlink{APT301_8c_a361b1d0588e13a7b5994f24b40138ec0}{zero};
311     \textcolor{keywordflow}{goto} L92;
312 
313 L89:
314     \textcolor{keywordflow}{if} (\hyperlink{CURFLO_8c_aa2a88aa3f2e858e87f5074fadc0e1d8e}{ibugg\_1}.ibug != 11) \{
315     \textcolor{keywordflow}{goto} L88;
316     \}
317     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"PU  "}, &pu, (ftnlen)4);
318     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"SPAN"}, &span, (ftnlen)4);
319     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"UA  "}, &ua, (ftnlen)4);
320     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"UB  "}, &ub, (ftnlen)4);
321     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"UMA "}, &uma, (ftnlen)4);
322     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_a9e9287f317ef3436252a395791a899f6}{c\_n1}, &\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"UMB "}, &umb, (ftnlen)4);
323 L88:
324 \textcolor{comment}{/* ---     COMPUTE EXACT CORRESPONDING VALUE U OF COONS PARAMETER */}
325     w1 = (ub - \hyperlink{APT109_8c_a805070ec05d12594ca986c059b87b2c0}{ua}) * 3.f - uma - uma - umb;
326     w2 = (ua - ub) * 2.f + uma + umb;
327     u = ua + pu * (uma + pu * (w1 + pu * w2));
328     up = uma + pu * (w1 + w1 + pu * 3.f * w2);
329     upp = w1 + w1 + pu * 6.f * w2;
330     up /= span;
331     upp /= span * span;
332     upsq = up * \hyperlink{DDTABC_8c_a0337592b74197133c4203f6dce657a76}{up};
333 L92:
334     nn = (integer) (sc[5] + (iarc - 1) * 24);
335     \textcolor{keywordflow}{if} (\hyperlink{CURFLO_8c_aa2a88aa3f2e858e87f5074fadc0e1d8e}{ibugg\_1}.ibug != 11) \{
336     \textcolor{keywordflow}{goto} L91;
337     \}
338     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"U   "}, &u, (ftnlen)4);
339     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"UP  "}, &up, (ftnlen)4);
340     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_a9e9287f317ef3436252a395791a899f6}{c\_n1}, &\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"UPP "}, &upp, (ftnlen)4);
341 L91:
342     \hyperlink{CNCURV_8c_a04761b7674edc68920b6ae1f87beb0b5}{cncurv\_}(&u, &sc[nn], &cv[1], \hyperlink{APT331_8c_af613cadd5cf49515a2b8790d3bfd56af}{mode});
343 \textcolor{comment}{/*     DO 556 I=1,13,4 */}
344 \textcolor{comment}{/*     CALL BAD(-4,1,'CNCV',CV(I)) */}
345 \textcolor{comment}{/* 556 CONTINUE */}
346     \textcolor{keywordflow}{if} (*\hyperlink{APT331_8c_af613cadd5cf49515a2b8790d3bfd56af}{mode} == 0) \{
347     \textcolor{keywordflow}{goto} L999;
348     \}
349 \textcolor{comment}{/* ---     CHANGE DERIVATIVES TO COMPENSATE FOR FLOW RATE. */}
350     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= 3; ++\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}) \{
351     cv[i\_\_ + 8] = cv[i\_\_ + 4] * upp + cv[i\_\_ + 8] * upsq;
352     cv[i\_\_ + 4] *= \hyperlink{DDTABC_8c_a0337592b74197133c4203f6dce657a76}{up};
353 \textcolor{comment}{/* L90: */}
354     \}
355 \textcolor{comment}{/* ---     WORK COMPLETED IF MODE.LT.2 */}
356     \textcolor{keywordflow}{if} (*\hyperlink{APT331_8c_af613cadd5cf49515a2b8790d3bfd56af}{mode} < 2) \{
357     \textcolor{keywordflow}{goto} L999;
358     \}
359 \textcolor{comment}{/* ---     CHECK IF A CRSSPL IS AVAILABLE AT EACH END OF THE ARC */}
360     \textcolor{keywordflow}{if} ((d\_\_1 = sc[nn - 5] - one, abs(d\_\_1)) + (d\_\_2 = sc[nn + 19] - one, abs(
361         d\_\_2)) < smal) \{
362     \textcolor{keywordflow}{goto} L100;
363     \}
364     \textcolor{keywordflow}{if} ((d\_\_1 = sc[nn - 5] - one, abs(d\_\_1)) < smal && abs(u) < smal) \{
365     \textcolor{keywordflow}{goto} L130;
366     \}
367     \textcolor{keywordflow}{if} ((d\_\_1 = sc[nn + 19] - one, abs(d\_\_1)) < smal && (d\_\_2 = one - u, abs(
368         d\_\_2)) < smal) \{
369     \textcolor{keywordflow}{goto} L140;
370     \}
371 
372 \textcolor{comment}{/* ---     NO CROSS SPLINES ARE THERE, SO ZERO OUT CV(17-32) */}
373     \textcolor{keywordflow}{for} (i\_\_ = 17; i\_\_ <= 32; ++\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}) \{
374 \textcolor{comment}{/* L101: */}
375     cv[\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}] = \hyperlink{APT301_8c_a361b1d0588e13a7b5994f24b40138ec0}{zero};
376     \}
377     \textcolor{keywordflow}{goto} L999;
378 
379 \textcolor{comment}{/* ---     NOW INTERPOLATE A CROSS SPLINE VECTOR AND DERIVATIVES */}
380 L100:
381     w1 = (d\_\_1 = sc[nn - 1] - 3.f, abs(d\_\_1));
382     w2 = (d\_\_1 = sc[nn + 23] - 3.f, abs(d\_\_1));
383 \textcolor{comment}{/* ---    SET UP CANON FORM FOR CRSSPL VECTOR AS A CUBIC ARC */}
384     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= 3; ++\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}) \{
385     temp[(i\_\_ << 2) - 4] = sc[nn - 9 + i\_\_];
386     temp[(i\_\_ << 2) - 3] = sc[nn + 15 + i\_\_];
387     temp[(i\_\_ << 2) - 2] = zero;
388     \textcolor{keywordflow}{if} (w1 < smal) \{
389         temp[(i\_\_ << 2) - 2] = sc[nn - 5 + i\_\_];
390     \}
391     temp[(i\_\_ << 2) - 1] = zero;
392     \textcolor{keywordflow}{if} (w2 < smal) \{
393         temp[(i\_\_ << 2) - 1] = sc[nn + 19 + i\_\_];
394     \}
395 \textcolor{comment}{/* L110: */}
396     \}
397 
398     temp[12] = \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one};
399     temp[13] = \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one};
400     temp[14] = \hyperlink{APT301_8c_a361b1d0588e13a7b5994f24b40138ec0}{zero};
401     temp[15] = \hyperlink{APT301_8c_a361b1d0588e13a7b5994f24b40138ec0}{zero};
402 
403     \hyperlink{CRBLEN_8c_a5a4cc6211822994020957320e36846b3}{crblen\_}(&u, temp, &cv[17], &\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1});
404 \textcolor{comment}{/*     DO 557 I=17,32,4 */}
405 \textcolor{comment}{/*     CALL BAD(-4,1,'CRBN',CV(I)) */}
406 \textcolor{comment}{/* 557 CONTINUE */}
407     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= 3; ++\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}) \{
408     cv[i\_\_ + 24] = cv[i\_\_ + 20] * upp + cv[i\_\_ + 24] * upsq;
409     cv[i\_\_ + 20] *= \hyperlink{DDTABC_8c_a0337592b74197133c4203f6dce657a76}{up};
410 \textcolor{comment}{/* L120: */}
411     \}
412 \textcolor{comment}{/* ---     FINALLY COMPUTE THE NORMAL (TAN CROSSED WITH CRS) */}
413 L121:
414     \hyperlink{UTILTY_8c_a58ae76ce755b09f1dcba2597c6be3859}{cross\_}(&cv[5], &cv[17], temp);
415 \textcolor{comment}{/* Computing 2nd power */}
416     d\_\_1 = temp[0];
417 \textcolor{comment}{/* Computing 2nd power */}
418     d\_\_2 = temp[1];
419 \textcolor{comment}{/* Computing 2nd power */}
420     d\_\_3 = temp[2];
421     w = d\_\_1 * d\_\_1 + d\_\_2 * d\_\_2 + d\_\_3 * d\_\_3;
422     w = sqrt(w);
423     \textcolor{keywordflow}{if} (w < smal) \{
424     w = \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one};
425     \}
426     cv[29] = temp[0] / \hyperlink{DDRLSR_8c_a6c6772207c061db8f6ca77c2661f497a}{w};
427     cv[30] = temp[1] / \hyperlink{DDRLSR_8c_a6c6772207c061db8f6ca77c2661f497a}{w};
428     cv[31] = temp[2] / \hyperlink{DDRLSR_8c_a6c6772207c061db8f6ca77c2661f497a}{w};
429     cv[32] = \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one};
430     \textcolor{keywordflow}{goto} L999;
431 \textcolor{comment}{/* ---     SIMPLE EXTRACTION OF AVAILABLE VECTORS FROM JUNCTION */}
432 L130:
433     \textcolor{keywordflow}{for} (l = 1; l <= 3; ++\hyperlink{PRO026_8c_a1cb503ddd20ff3cf9588d2b5abd202d8}{l}) \{
434     cv[l + 16] = sc[nn - 9 + \hyperlink{PRO026_8c_a1cb503ddd20ff3cf9588d2b5abd202d8}{l}];
435     \textcolor{keywordflow}{if} ((d\_\_1 = sc[nn - 1] - 3.f, abs(d\_\_1)) < smal) \{
436         cv[l + 20] = sc[nn - 5 + \hyperlink{PRO026_8c_a1cb503ddd20ff3cf9588d2b5abd202d8}{l}];
437     \}
438     cv[l + 24] = \hyperlink{APT301_8c_a361b1d0588e13a7b5994f24b40138ec0}{zero};
439 \textcolor{comment}{/* L131: */}
440     \}
441     cv[20] = \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one};
442     cv[28] = \hyperlink{APT301_8c_a361b1d0588e13a7b5994f24b40138ec0}{zero};
443     \textcolor{keywordflow}{goto} L121;
444 
445 L140:
446     \textcolor{keywordflow}{for} (l = 1; l <= 3; ++\hyperlink{PRO026_8c_a1cb503ddd20ff3cf9588d2b5abd202d8}{l}) \{
447     cv[l + 16] = sc[nn + 15 + \hyperlink{PRO026_8c_a1cb503ddd20ff3cf9588d2b5abd202d8}{l}];
448     \textcolor{keywordflow}{if} ((d\_\_1 = sc[nn + 23] - 3.f, abs(d\_\_1)) < smal) \{
449         cv[l + 20] = sc[nn + 19 + \hyperlink{PRO026_8c_a1cb503ddd20ff3cf9588d2b5abd202d8}{l}];
450     \}
451     cv[l + 24] = \hyperlink{APT301_8c_a361b1d0588e13a7b5994f24b40138ec0}{zero};
452 \textcolor{comment}{/* L141: */}
453     \}
454     cv[20] = \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one};
455     cv[28] = \hyperlink{APT301_8c_a361b1d0588e13a7b5994f24b40138ec0}{zero};
456     \textcolor{keywordflow}{if} ((d\_\_1 = sc[nn + 23] - 3.f, abs(d\_\_1)) < smal) \{
457     cv[24] = \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one};
458     \}
459     \textcolor{keywordflow}{goto} L121;
460 
461 
462 L999:
463     \textcolor{keywordflow}{if} (\hyperlink{CURFLO_8c_aa2a88aa3f2e858e87f5074fadc0e1d8e}{ibugg\_1}.ibug != 11) \{
464     \textcolor{keywordflow}{goto} L997;
465     \}
466     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_a900642cfb0fdb02c80380e0b73330cb5}{c\_n4}, &\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"CV1 "}, &cv[1], (ftnlen)4);
467     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_a900642cfb0fdb02c80380e0b73330cb5}{c\_n4}, &\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"CV5 "}, &cv[5], (ftnlen)4);
468     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_a900642cfb0fdb02c80380e0b73330cb5}{c\_n4}, &\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"CV9 "}, &cv[9], (ftnlen)4);
469     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_a900642cfb0fdb02c80380e0b73330cb5}{c\_n4}, &\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"CV17"}, &cv[17], (ftnlen)4);
470     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_a900642cfb0fdb02c80380e0b73330cb5}{c\_n4}, &\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"CV21"}, &cv[21], (ftnlen)4);
471 L997:
472     \textcolor{keywordflow}{return} 0;
473 
474 L998:
475     \hyperlink{CFORM_8c_ac1d4f86996388dd43d61bc383e8ecfc4}{cform\_}(\textcolor{stringliteral}{" WARNING ERROR IN CURFLO"}, \hyperlink{CURFLO_8c_a6a01fdbcd4e9ab45bf32c168785cc8a6}{darray\_1}.darray, &\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &
      \hyperlink{CURFLO_8c_ab547b63b356ef99dc04f74ea358aa245}{c\_\_24}, (
476         ftnlen)24, (ftnlen)120);
477     \hyperlink{CPRINT_8c_a162e4af07e13f17e2aa965863091b687}{cprint\_}(\hyperlink{CURFLO_8c_a6a01fdbcd4e9ab45bf32c168785cc8a6}{darray\_1}.darray, (ftnlen)120);
478     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"UIN "}, uin, (ftnlen)4);
479     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{CURFLO_8c_a6a4ee26669af052a7e7fb5dda2b01f63}{c\_\_0}, \textcolor{stringliteral}{"MERR"}, &merr, (ftnlen)4);
480     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{CURFLO_8c_a6a4ee26669af052a7e7fb5dda2b01f63}{c\_\_0}, \textcolor{stringliteral}{"INSG"}, &inseg, (ftnlen)4);
481     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"U   "}, &u, (ftnlen)4);
482     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, \textcolor{stringliteral}{"FRAC"}, &frac, (ftnlen)4);
483     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{CURFLO_8c_a6a4ee26669af052a7e7fb5dda2b01f63}{c\_\_0}, \textcolor{stringliteral}{"SEG "}, &iseg, (ftnlen)4);
484     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{CURFLO_8c_a6a4ee26669af052a7e7fb5dda2b01f63}{c\_\_0}, \textcolor{stringliteral}{"IARC"}, &iarc, (ftnlen)4);
485     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1}, &\hyperlink{CURFLO_8c_a6a4ee26669af052a7e7fb5dda2b01f63}{c\_\_0}, \textcolor{stringliteral}{"ISPL"}, &ispl, (ftnlen)4);
486     \hyperlink{BAD_8c_a4e7ec5852aef8f8487def3a6dc8b71b1}{bad\_}(&\hyperlink{CURFLO_8c_a9e9287f317ef3436252a395791a899f6}{c\_n1}, &\hyperlink{CURFLO_8c_a6a4ee26669af052a7e7fb5dda2b01f63}{c\_\_0}, \textcolor{stringliteral}{"LOCS"}, &locseg, (ftnlen)4);
487     \hyperlink{SCDUMP_8c_a407ea0ec05de474d31cb34c209fe3571}{scdump\_}(&\hyperlink{CURFLO_8c_a3685742eafc43c67e05ca885c8ad5511}{c\_\_333}, &sc[1]);
488     \textcolor{keywordflow}{goto} L999;
489 
490 L200:
491 \textcolor{comment}{/* ---     SPECIAL ENTRY FOR A DEGENERATE SEGMENT */}
492     locarc = (integer) sc[7];
493     iarc = (integer) sc[locseg];
494     \textcolor{keywordflow}{if} (iarc == 0) \{
495     \textcolor{keywordflow}{goto} L210;
496     \}
497 
498     --iarc;
499     pu = \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one};
500     \textcolor{keywordflow}{goto} L220;
501 
502 L210:
503     iarc = 1;
504     pu = \hyperlink{APT301_8c_a361b1d0588e13a7b5994f24b40138ec0}{zero};
505 
506 L220:
507     nn = (integer) (sc[5] + (iarc - 1) * 24);
508     \hyperlink{CNCURV_8c_a04761b7674edc68920b6ae1f87beb0b5}{cncurv\_}(&pu, &sc[nn], &cv[1], \hyperlink{APT331_8c_af613cadd5cf49515a2b8790d3bfd56af}{mode});
509 \textcolor{comment}{/* ---      ZERO OUT FIRST AND SECOND DERIVATIVES */}
510     \textcolor{keywordflow}{for} (j = 1; j <= 2; ++\hyperlink{PRO026_8c_aa8c84707b22bdc99b810d3c7d3ec5d52}{j}) \{
511     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= 3; ++\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}) \{
512         cv[i\_\_ + (j << 2)] = zero;
513 \textcolor{comment}{/* L230: */}
514     \}
515     \}
516     \textcolor{keywordflow}{goto} L999;
517 
518 \textcolor{comment}{/* ---      UIN AND INSEG REFER TO ARC STRUCTURE AND COONS NATURAL */}
519 \textcolor{comment}{/* ---      FLOW PARAMETER DIRECTLY */}
520 L300:
521     u = *uin;
522     nmax = (integer) sc[4];
523     \textcolor{keywordflow}{if} (inseg < 0) \{
524     \textcolor{keywordflow}{goto} L310;
525     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (inseg == 0) \{
526     \textcolor{keywordflow}{goto} L320;
527     \} \textcolor{keywordflow}{else} \{
528     \textcolor{keywordflow}{goto} L330;
529     \}
530 
531 L310:
532 \textcolor{comment}{/* ---     CONVERT INSEG AND UIN TO CASE OF POSITIVE INSEG */}
533     inseg = nmax - abs(inseg) + 1;
534     *uin = one - *uin;
535     \textcolor{keywordflow}{goto} L330;
536 
537 L320:
538     iarc = (integer) (*uin + one);
539     iarc = min(nmax,iarc);
540     iarc = max(1,iarc);
541     ulo = (doublereal) (iarc - 1);
542     u = *uin - ulo;
543     \textcolor{keywordflow}{goto} L340;
544 
545 L330:
546 \textcolor{comment}{/* ****    SEGMENT REFERENCE IS OUT OF VALID RANGE */}
547     merr = 4;
548     \textcolor{keywordflow}{if} (inseg < 1 || inseg > nmax) \{
549     \textcolor{keywordflow}{goto} L998;
550     \}
551 
552     iarc = inseg;
553     u = *uin;
554 
555 L340:
556 \textcolor{comment}{/* ---     COMPUTE ARC LOCATION IN SC ARRAY */}
557     nn = (integer) ((sc[2] - one + iarc) * 24 + 1);
558     \hyperlink{CNCURV_8c_a04761b7674edc68920b6ae1f87beb0b5}{cncurv\_}(&u, &sc[nn], &cv[1], \hyperlink{APT331_8c_af613cadd5cf49515a2b8790d3bfd56af}{mode});
559     \textcolor{keywordflow}{if} (*\hyperlink{APT331_8c_af613cadd5cf49515a2b8790d3bfd56af}{mode} < 2) \{
560     \textcolor{keywordflow}{goto} L999;
561     \}
562 
563     \textcolor{keywordflow}{if} ((d\_\_1 = sc[nn - 5] - one, abs(d\_\_1)) + (d\_\_2 = sc[nn + 19] - one, abs(
564         d\_\_2)) < smal) \{
565     \textcolor{keywordflow}{goto} L345;
566     \}
567     \textcolor{keywordflow}{if} ((d\_\_1 = sc[nn - 5] - one, abs(d\_\_1)) < smal && abs(u) < smal) \{
568     \textcolor{keywordflow}{goto} L130;
569     \}
570     \textcolor{keywordflow}{if} ((d\_\_1 = sc[nn + 19] - one, abs(d\_\_1)) < smal && (d\_\_2 = one - u, abs(
571         d\_\_2)) < smal) \{
572     \textcolor{keywordflow}{goto} L140;
573     \}
574 
575 L345:
576 
577     w1 = (d\_\_1 = sc[nn - 1] - 3.f, abs(d\_\_1));
578     w2 = (d\_\_1 = sc[nn + 23] - 3.f, abs(d\_\_1));
579 \textcolor{comment}{/* ---    SET UP CANON FORM FOR CRSSPL VECTOR AS A CUBIC ARC */}
580     \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= 3; ++\hyperlink{APT088_8c_ae86436b0a8c8a69ba8ece7d58c8ed452}{i\_\_}) \{
581     temp[(i\_\_ << 2) - 4] = sc[nn - 9 + i\_\_];
582     temp[(i\_\_ << 2) - 3] = sc[nn + 15 + i\_\_];
583     temp[(i\_\_ << 2) - 2] = zero;
584     \textcolor{keywordflow}{if} (w1 < smal) \{
585         temp[(i\_\_ << 2) - 2] = sc[nn - 5 + i\_\_];
586     \}
587     temp[(i\_\_ << 2) - 1] = zero;
588     \textcolor{keywordflow}{if} (w2 < smal) \{
589         temp[(i\_\_ << 2) - 1] = sc[nn + 19 + i\_\_];
590     \}
591 \textcolor{comment}{/* L350: */}
592     \}
593 
594     temp[3] = \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one};
595     temp[7] = \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one};
596     temp[11] = \hyperlink{APT301_8c_a361b1d0588e13a7b5994f24b40138ec0}{zero};
597     temp[15] = \hyperlink{APT301_8c_a361b1d0588e13a7b5994f24b40138ec0}{zero};
598 
599     \hyperlink{CRBLEN_8c_a5a4cc6211822994020957320e36846b3}{crblen\_}(&u, temp, &cv[17], &\hyperlink{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{c\_\_1});
600 \textcolor{comment}{/* ---     FINALLY COMPUTE THE NORMAL (TAN CROSSED WITH CRS) */}
601     \hyperlink{UTILTY_8c_a58ae76ce755b09f1dcba2597c6be3859}{cross\_}(&cv[5], &cv[17], temp);
602     \hyperlink{UTILTY_8c_a46efcd0a33c423bde8c314847c49a645}{vnorm\_}(temp, &cv[29]);
603     cv[32] = \hyperlink{APT298_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one};
604     \textcolor{keywordflow}{goto} L999;
605 
606 \} \textcolor{comment}{/* curflo\_ */}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{CURFLO_8c_a0b62b83550ba1c0345040e1d700fdeba_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{CURFLO_8c_a0b62b83550ba1c0345040e1d700fdeba_icgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\index{C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}!c\+\_\+\+\_\+0@{c\+\_\+\+\_\+0}}
\index{c\+\_\+\+\_\+0@{c\+\_\+\+\_\+0}!C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}}
\subsubsection[{\texorpdfstring{c\+\_\+\+\_\+0}{c__0}}]{\setlength{\rightskip}{0pt plus 5cm}integer c\+\_\+\+\_\+0 = 0\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{CURFLO_8c_a6a4ee26669af052a7e7fb5dda2b01f63}{}\label{CURFLO_8c_a6a4ee26669af052a7e7fb5dda2b01f63}


Definition at line 32 of file C\+U\+R\+F\+L\+O.\+c.



Referenced by curflo\+\_\+().

\index{C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}!c\+\_\+\+\_\+1@{c\+\_\+\+\_\+1}}
\index{c\+\_\+\+\_\+1@{c\+\_\+\+\_\+1}!C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}}
\subsubsection[{\texorpdfstring{c\+\_\+\+\_\+1}{c__1}}]{\setlength{\rightskip}{0pt plus 5cm}integer c\+\_\+\+\_\+1 = 1\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}{}\label{CURFLO_8c_aac061f9822f71d2164eeeaae0e2a342c}


Definition at line 31 of file C\+U\+R\+F\+L\+O.\+c.



Referenced by curflo\+\_\+().

\index{C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}!c\+\_\+\+\_\+24@{c\+\_\+\+\_\+24}}
\index{c\+\_\+\+\_\+24@{c\+\_\+\+\_\+24}!C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}}
\subsubsection[{\texorpdfstring{c\+\_\+\+\_\+24}{c__24}}]{\setlength{\rightskip}{0pt plus 5cm}integer c\+\_\+\+\_\+24 = 24\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{CURFLO_8c_ab547b63b356ef99dc04f74ea358aa245}{}\label{CURFLO_8c_ab547b63b356ef99dc04f74ea358aa245}


Definition at line 35 of file C\+U\+R\+F\+L\+O.\+c.



Referenced by curflo\+\_\+().

\index{C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}!c\+\_\+\+\_\+333@{c\+\_\+\+\_\+333}}
\index{c\+\_\+\+\_\+333@{c\+\_\+\+\_\+333}!C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}}
\subsubsection[{\texorpdfstring{c\+\_\+\+\_\+333}{c__333}}]{\setlength{\rightskip}{0pt plus 5cm}integer c\+\_\+\+\_\+333 = 333\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{CURFLO_8c_a3685742eafc43c67e05ca885c8ad5511}{}\label{CURFLO_8c_a3685742eafc43c67e05ca885c8ad5511}


Definition at line 36 of file C\+U\+R\+F\+L\+O.\+c.



Referenced by curflo\+\_\+().

\index{C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}!c\+\_\+n1@{c\+\_\+n1}}
\index{c\+\_\+n1@{c\+\_\+n1}!C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}}
\subsubsection[{\texorpdfstring{c\+\_\+n1}{c_n1}}]{\setlength{\rightskip}{0pt plus 5cm}integer c\+\_\+n1 = -\/1\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{CURFLO_8c_a9e9287f317ef3436252a395791a899f6}{}\label{CURFLO_8c_a9e9287f317ef3436252a395791a899f6}


Definition at line 33 of file C\+U\+R\+F\+L\+O.\+c.



Referenced by curflo\+\_\+().

\index{C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}!c\+\_\+n4@{c\+\_\+n4}}
\index{c\+\_\+n4@{c\+\_\+n4}!C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}}
\subsubsection[{\texorpdfstring{c\+\_\+n4}{c_n4}}]{\setlength{\rightskip}{0pt plus 5cm}integer c\+\_\+n4 = -\/4\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{CURFLO_8c_a900642cfb0fdb02c80380e0b73330cb5}{}\label{CURFLO_8c_a900642cfb0fdb02c80380e0b73330cb5}


Definition at line 34 of file C\+U\+R\+F\+L\+O.\+c.



Referenced by curflo\+\_\+().

\index{C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}!darray@{darray}}
\index{darray@{darray}!C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}}
\subsubsection[{\texorpdfstring{darray}{darray}}]{\setlength{\rightskip}{0pt plus 5cm}char darray\mbox{[}120\mbox{]}}\hypertarget{CURFLO_8c_ad8149129b0ac5c966968e55ba6106146}{}\label{CURFLO_8c_ad8149129b0ac5c966968e55ba6106146}


Definition at line 18 of file C\+U\+R\+F\+L\+O.\+c.

\index{C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}!darray\+\_\+@{darray\+\_\+}}
\index{darray\+\_\+@{darray\+\_\+}!C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}}
\subsubsection[{\texorpdfstring{darray\+\_\+}{darray_}}]{\setlength{\rightskip}{0pt plus 5cm}struct \{ ... \}   darray\+\_\+}\hypertarget{CURFLO_8c_af51148698e59d8219f4e1af4e7f8bbcc}{}\label{CURFLO_8c_af51148698e59d8219f4e1af4e7f8bbcc}
\index{C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}!ibug@{ibug}}
\index{ibug@{ibug}!C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}}
\subsubsection[{\texorpdfstring{ibug}{ibug}}]{\setlength{\rightskip}{0pt plus 5cm}integer ibug}\hypertarget{CURFLO_8c_acf8cd9aebbc7f97517952bf2f89ed57c}{}\label{CURFLO_8c_acf8cd9aebbc7f97517952bf2f89ed57c}


Definition at line 24 of file C\+U\+R\+F\+L\+O.\+c.

\index{C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}!ibugg\+\_\+@{ibugg\+\_\+}}
\index{ibugg\+\_\+@{ibugg\+\_\+}!C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}}
\subsubsection[{\texorpdfstring{ibugg\+\_\+}{ibugg_}}]{\setlength{\rightskip}{0pt plus 5cm}struct \{ ... \}   ibugg\+\_\+}\hypertarget{CURFLO_8c_a33e2ef86cf11003407b35d9236c94679}{}\label{CURFLO_8c_a33e2ef86cf11003407b35d9236c94679}
\index{C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}!ipcolc@{ipcolc}}
\index{ipcolc@{ipcolc}!C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}}
\subsubsection[{\texorpdfstring{ipcolc}{ipcolc}}]{\setlength{\rightskip}{0pt plus 5cm}integer ipcolc}\hypertarget{CURFLO_8c_aa7c1d3b50810f4362d609ea905340770}{}\label{CURFLO_8c_aa7c1d3b50810f4362d609ea905340770}


Definition at line 24 of file C\+U\+R\+F\+L\+O.\+c.

\index{C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}!ipcomc@{ipcomc}}
\index{ipcomc@{ipcomc}!C\+U\+R\+F\+L\+O.\+c@{C\+U\+R\+F\+L\+O.\+c}}
\subsubsection[{\texorpdfstring{ipcomc}{ipcomc}}]{\setlength{\rightskip}{0pt plus 5cm}integer ipcomc}\hypertarget{CURFLO_8c_a0def98d78ab8101d518729447f28e4e8}{}\label{CURFLO_8c_a0def98d78ab8101d518729447f28e4e8}


Definition at line 24 of file C\+U\+R\+F\+L\+O.\+c.

