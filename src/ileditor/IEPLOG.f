**** SOURCE FILE : M0006636.W02   ***
*
C
C              FORTRAN SUBROUTINE IEPLOG
C
C LINKAGE      SUBROUTINE IEPLOG
C
C          SUBSIDIARIES                  CALLED BY
C          TYPE          ENTRY           TYPE          ENTRY
C          SUBROUTINE    AWRITE          SUBROUTINE    EPILOG
C          SUBROUTINE    MCXTRN
C          SUBROUTINE    NTSHFT
C          SUBROUTINE    RLSBUF
C          SUBROUTINE    TAPOP
C
      SUBROUTINE IEPLOG
C
      IMPLICIT INTEGER (A-Z)
C
C        1.    NAME TABLE AND TABLE LIMITS
C
      INCLUDE 'NAMETB.INC'
C NAMTBL:      INTEGER CORRESPONDING TO NAME TABLE ENTRY
C CNAMTB:      NAME TABLE OR DICTIONARY
C INAMST:      BEGIN GEOMETRIC DEFINITION ROUTINE NAME SECTION(NAMTBL)
C NAMMAX:      NAMTBL INDEX OF END OF THE PART PROGRAM NAME SECTION
C IFIXST:      NAMTBL INDEX OF BEGINNING OF FIXED POINT NUMBER SECTION
C IFIXND:      NAMTBL INDEX OF START OF FIXED POINT NUMBER SECTION
C NUMBST:      NAMTBL INDEX OF BEGINNING OF NUMBER SECTION
C NUMBND:      NAMTBL INDEX OF END OF NUMBER SECTION
C
C       12.    LARGE DATA ARRAY STORAGE REQUIREMENTS
C
      COMMON/CFSIZE/CFSIZE
      DIMENSION CFSIZE(205),MAXSIZ(2)
C MAXSIZ:      SIZE OF THE LAST LARGEST LARGE DATA ARRAY
      EQUIVALENCE (MAXSIZ(1),CFSIZE(4))
C
C       14.    I. L. LIST OPTION FLAGS
C
      COMMON/PRT/PRT
      LOGICAL CILPRT
      DIMENSION PRT(7)
C CILPRT:      TRUE WHEN COMPRESSED I.L. PRINTING REQUESTED
      EQUIVALENCE (CILPRT,PRT(1))
C
C       33.    SYMBOLIC FILE DEFINITIONS
C
      INCLUDE 'SYMFIL.INC'
C MACTXT:      EXTERNAL FILE  OF MACRO TEXT
C ELFIL1:      PACKING FACTOR FOR CREATING PAGES (INTERPRETER)
C ELFIL2:      PART PROGRAMMING TEXT GENERATED BY INTERPRETER
C ELFIL3:      MACRO TEXT GENERATED FOR INTERPRETER
C ELFIL4:      MACRO TEXT GENERATED FOR INTERPRETER
C
C       34.    COMMON BLOCK FOR INTERPRETIVE C.I.L. OUTPUT
C
      INCLUDE 'OUTBUF.INC'
C PAGPAK:      PACKING FACTOR FOR CREATING PAGES (INTERPRETER)
C MACFLG:      TRUE WHEN MACRO PROCESSING IN EFFECT (INTERPRETER)
C LABFLG:      INDICATES I.L. COMMAND IS LABEL (INTERPRETER)
C PPPAGE:      PAGE NUMBER OF PART PROGRAMMING TEXT (INTERPRETER)
C MCPAGE:      NUMBER OF PAGES OF MACRO I.L. (INTERPRETER)
      INTEGER BUF(23),JBUF(11),INUMB,INAME
      LOGICAL LCILPR
      EQUIVALENCE (BUF(1),PAGPAK)
C INUMB:       NUMBER OF ITEMS IN THE LABBUF ARRAY (INTERPRETER)
      EQUIVALENCE (INUMB,JBUF(1),BUF(13))
C INAME:
      EQUIVALENCE (INAME,JBUF(2))
C LCILPR:
      EQUIVALENCE (LCILPR,JBUF(6))
C
C       41.    NUMBER TABLE OVERFLOW VARIABLES
C
      COMMON/NTBL/NTBL
      DIMENSION NTBL(6)
C NMOD:        NUMBER OF ENTRIES PERMITTED IN INTERNAL NUMBER TABLE
      EQUIVALENCE (NMOD,NTBL(1))
C NLAST:       LAST NEW BLOCK NUMBER OF NUMBER TABLE ON THE EXTERN FILE
      EQUIVALENCE (NLAST,NTBL(4))
C NSTR:        NUMBER OF FIRST MACTXT RECORD AVAILABLE FOR NUMBER TABLE
      EQUIVALENCE (NSTR,NTBL(5))
C
C       45.    NUMBER TABLE INDICES
C
      INCLUDE 'NUMBLK.INC'
C MNMBND:      LAST NAME TABLE ENTRY TO MACRO ASSIGNED NUMBER SECTION
C*
C**
C...     CLEAR BUFFERS AND REWIND FILES 2 AND 3
C
      IF (.NOT.MACFLG) GOTO 1
      CALL RLSBUF
      CALL TAPOP (ELFIL3,-2)
    1 LABFLG = .TRUE.
      CALL RLSBUF
      CALL TAPOP(ELFIL2,-2)
      CALL TAPOP(ELFIL1,-2)
C
C...       ALL USEFUL ITEMS IN THE NAMTBL ARE STORED IN BUFFER
C...       TOGETHER WITH ALL RELEVANT PARAMETERS
C
      INAME = NAMMAX - INAMST + 1
      INUMB = MNMBND-IFIXST+1
      JBUF(3)=PPPAGE
      JBUF(4)=MCPAGE
      JBUF(5)=INAMST
      LCILPR=CILPRT
      JBUF(7)=NUMBST
      JBUF(8)=NLAST
      JBUF(9)=NSTR
      JBUF(10)=MAXSIZ(1)
      JBUF(11)=MAXSIZ(2)
      IREC=0
      CALL AWRITE(ELFIL4,IREC,BUF,23,IRET)
C
C...     WRITE NAME TABLE
      IREC=0
C...  4TH ARGUMENT OF CHWRIT IS NUMBER OF BYTES
      I = INAME*6
      CALL CHWRIT(ELFIL4,IREC,CNAMTB(INAMST),I,IRET)
C...  4TH ARGUMENT OF CHWRIT IS NUMBER OF BYTES
      I = INUMB*12
      IREC=0
      CALL CHWRIT(ELFIL4,IREC,CNUMTB(IFIXST),  I  ,IRET)
C
C...     ALL TABLES AND PARAMETERS NOW WRITTEN.  REWIND FILES 4 AND 9.
C
      CALL TAPOP(ELFIL4,-2)
      CALL TAPOP(MACTXT,-3)
      RETURN
       END
