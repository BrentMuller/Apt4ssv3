PARTNO TEST20   VERSION OF SQUARE BOTTLE WITH ROUND CORNERS  JKH,IITRI
$$ ********************************************
$$ *                                          *
$$ *   THIS TEST OK IN SSV3  -  14-JUN-1989   *
$$ *                                          *
$$ *   NOTE: GIVES CORRECT WARNING 50         *
$$ ********************************************
$$
$$   THIS TEST LARGELY OK IN SSV2 - 05-NOV-1986
$$
$$   RESTART DIAGNOSTIC 25402 ISN 373 FROM DDSSRF FOR SECTION 16
$$          TLON,  GOFWD/PLA, ON, LCEN
$$   SECTIONS 1 - 15 PROCESS OK, EXECUTION PRINT AND CLPRNT PRODUCED
$$
CLPRNT
INTOL/.005
OUTTOL/.005
CLPRNT
REMARK  IIT RESEARCH INSTITUTE   FEBRUARY,1974 JKH
REMARK FOR THE CAM-I INC SCULPTURED SURFACE PROJECT
TITLES  ---------------------  SECTION NUMBER ONE    -----------------
REMARK  THE FOLLOWING PART PROGRAM DEFINES A BOTTLE WITH A ROUND TOP AND
REMARK  A SQUARE SIDED BOTTOM WITH ROUNDED EDGES
REMARK  THE MOST UNIQUE PROBLEM IS REPRESENTING THE INTERMEDIATE BLEND
REMARK  THE BOTTLE IS COMPLETELY DEFINED BY THE FOLLOWING DIMENSIONS
REMARK  AND THE USER CAN REQUEST EITHER DIGITIZED PLOT DATA OR ELSE
REMARK  NUMERICAL CONTROL MACHINING DATA.  THE CRITICAL PART IS DEFINED
REMARK BY FOUR SEPATATE SCULPTURED SUFACES AND WHICH DEFINE ONE HALF
REMARK  OF THE MALE VERSION OF THE BOTTLE
REMARK  IGEOM CONTROLS THE GENERATION OF GEOMETRY CLDATA
REMARK  ICUT CONTROLS THE GENERATION OF CUTTER POSITION DATA FOR MACHIN-
REMARK  ING
   IGEOM=  1
   IGEOM=  -1
   ICUT=   -1
   ICUT=   1
TITLES  ---------------------  SECTION NUMBER TWO    -----------------
REMARK  KEY DIMENSI0NS FOR THE BOTTLE FOLLOW
   LIPRAD= 0.375     $$  RADIUS OF THE LIP OF THE BOTTLE
   LIPLN=   0.5      $$  LENGTH IF THE LIP OF THE BOTTLE
   TOPRAD= 1.375     $$ MAXIMUM RADIUS OF THE REVOLVED TOP SECTIIN
   TOPLN=  1.25     $$  HEIGHT OF THE REVOLVED TOP SECTION
   BLENLN= 0.75     $$  HEIGHT BETWEEN REVOLVED TOP AND SQUARE BOTTOM
   SQRLN= 4.75  $$  LENGTH OF THE VERTICAL SQUARED SECTION
   RNDRAD= 0.75    $$  RADIUS OF ROUNDED CORNERS OF SQUARE SECTION
   SQRRAD= 1.875   $$  HALF WIDTH OF SQUARED BOTTLE
REMARK   GENERATED LENGTHS AND USEFUL CONSTANTS
 QLN= RNDRAD     $$ HEIGHT OF Q-SECTION
 PLN= QLN+SQRLN     $$  HEIGHT OF P SECTION
 RLN= PLN+BLENLN     $$  HEIGHT OF R SECTION
 BOTLN=  RLN+TOPLN+LIPLN  $$  TOTAL HEIGHT OF BOTTLE
REMARK BCOS AND BSIN ARE COMPONENTS OF THE TERMINAL SLOPE OF THE TOP
 BCOS= TOPRAD-LIPRAD
 BSIN= TOPLN/3.0
 BL= SQRTF(BCOS*BCOS+BSIN*BSIN)
 BCOS= BCOS/BL
 BSIN= -BSIN/BL
 SQRFLT= SQRRAD-RNDRAD
REMARK THE FOLLOWING VECTORS ARE USED FREQUENTLY
 VXUP= VECTOR/ 1,0,0
 VXDN= VECTOR/ -1,0,0
 VYUP= VECTOR/ 0,1,0
 VYDN= VECTOR/ 0,-1,0
 VZUP= VECTOR/ 0,0,1
 VZDN= VECTOR/ 0,0,-1
 PZ= POINT/0.0001,0,0
 VZ= VECTOR/ 0,0,0
 VTOP= VECTOR/ BCOS,BSIN,0
 PT= POINT/ 0,BOTLN,0
 LTOP= LINE/ 0, BOTLN, 1, BOTLN
 LQQ= LINE/ 0, QLN, 1, QLN
 LPP= LINE/ 0, PLN, 1, PLN
 LRR= LINE/ 0, RLN, 1, RLN
 LBOT= LINE/ 0, 0, 1, 0
 LCEN= LINE/ 0, 0, 0, 1
 LRGT= LINE/ SQRRAD, 0, SQRRAD, 1
 LLEF= LINE/ -SQRRAD, 0, -SQRRAD, 1
PRINT/3,ALL
TITLES  ---------------------  SECTION NUMBER THREE  -----------------
REMARK  THE BOTTLE IS DESCRIBED IN AN X-Y PLANE VIEW WITH THE CENTER
REMARK  BASE AT THE ORIGIN OF COORDINATES AND THE CENTRAL AXIS OF THE
REMARK  BOTTLE THE Y-AXIS.  THE MID SECTION OF THE BOTTLE IS IN THE
REMARK  XY PLANE AND THE HALF DESCRIBED RISES IN THE POSITIVE Z-PLANE
REMARK  DEFINE AN XY PROFILE OF THE BOTTLE BY KEY POINTS
   RESERV/ PROFIL, 15
   PROFIL(1)= POINT/ 0,BOTLN
   PROFIL(2)= POINT/ LIPRAD,BOTLN
   PROFIL(3)= POINT/ LIPRAD,(BOTLN-LIPLN)
   PROFIL(4)= POINT/ TOPRAD,RLN
   PROFIL(5)= POINT/ SQRRAD,PLN
   PROFIL(6)= POINT/ SQRRAD,QLN
   PROFIL(7)= POINT/ SQRFLT,0
   PROFIL(8)= POINT/ 0,0
REMARK GENERATE THE SYMMETRIC POINTS ON THE MIRROR SIDE OF THE BOTLLE
         ICT= 0
STAT1)   ICT=     ICT+1
         IF(ICT-8) STAT2,STAT3,STAT3
STAT2)   OBTAIN,POINT/PROFIL(8-ICT),X,Y
         PROFIL(8+ICT)=  POINT/-X,Y,0
         JUMPTO/STAT1
STAT3)   DUM=     0.0
PRINT/3,PROFIL(1,THRU,15)
TITLES  ---------------------  SECTION NUMBER FOUR   -----------------
         CLIP=    SCURV/CURSEG,PROFIL(2,THRU,3)
         CNECK=   SCURV/SPLINE,PROFIL(3),TANSPL,VYDN,PROFIL(4),TANSPL, $
                               VTOP
REMARK  DEFINE INDIVIDUAL AND COMBINED CURVES ON THE PROFILE
         CCAP=    SCURV/CURSEG,PROFIL(1,THRU,2)
         CBLEN=   SCURV/SPLINE,PROFIL(4),TANSPL,VTOP,PROFIL(5),TANSPL, $
                               VYDN
         CSQR=    SCURV/CURSEG,PROFIL(5,THRU,6)
         CRND=    SCURV/SPLINE,PROFIL(6),TANSPL,VYDN,PROFIL(7),TANSPL, $
                               VXDN
         CBOT=    SCURV/CURSEG,PROFIL(7,THRU,8)
REMARK
         PROCUR=  SCURV/ COMBIN, CLIP, CNECK, CBLEN, CSQR, CRND, CBOT
REMARK
         CTOP=    SCURV/ COMBIN, CLIP, CNECK
REMARK  TOP OF BOTTLE IS A SURFACE OF REVOLUTION
         STOP=    SSURF/ REVOLV, CTOP, AXIS,  PT, PZ,CCLW, 0, 180
TITLES  ---------------------  SECTION NUMBER FIVE   -----------------
REMARK  DEFINE KEY POINTS ON THE SQUARE SECTION
         RESERV/ PS,7, QS,7
         PS(1)=   POINT/ SQRRAD,PLN,0
         PS(2)=   POINT/ SQRRAD, PLN, SQRFLT
         PS(3)=   POINT/ SQRFLT, PLN, SQRRAD
         PS(4)=   POINT/ 0, PLN, SQRRAD
         PS(5)=   POINT/ (-SQRFLT), PLN, SQRRAD
         PS(6)=   POINT/ (-SQRRAD), PLN, SQRFLT
         PS(7)=   POINT/ (-SQRRAD), PLN, 0
REMARK  GENERATE Q POINTS ON THE LOWER END OF THE SQUARE SECTION
         ICT=     0
STATA)   ICT=     ICT+1
         IF(ICT-8) STATB, STATC, STATC
STATB)   OBTAIN, POINT/PS(ICT),X,Y,Z
         QS(ICT)= POINT/X,QLN,Z
         JUMPTO/STATA
STATC)   DUM=     0.0
PRINT/3,PS(1,THRU,7),QS(1,THRU,7)
REMARK  DEFINE THE SQUARE SECTION SURFACE
         SSQR=    SSURF/ SMESH, XYZ,                                   $
SPLINE,  PS(1), TANSPL, VZUP, PS(2), TANSPL, VZUP,                     $
         PS(3), TANSPL, VXDN, PS(5), TANSPL, VXDN,                     $
         PS(6), TANSPL, VZDN, PS(7), TANSPL, VZDN,                     $
SPLINE,  QS(1), TANSPL, VZUP, QS(2), TANSPL, VZUP,                     $
         QS(3),   TANSPL, VXDN, QS(5), TANSPL, VXDN,                   $
         QS(6), TANSPL, VZDN, QS(7), TANSPL, VZDN
REMARK  DEFINE THE BOTTOM AND TOP SECTION CURVES OF THE SQUARE SECTION
         CQS=     SCURV/                                               $
SPLINE,  QS(1), TANSPL, VZUP, QS(2), TANSPL, VZUP,                     $
         QS(3),   TANSPL, VXDN, QS(5), TANSPL, VXDN,                   $
         QS(6), TANSPL, VZDN, QS(7), TANSPL, VZDN
         CPS=     SCURV/                                               $
SPLINE,  PS(1), TANSPL, VZUP, PS(2), TANSPL, VZUP,                     $
         PS(3), TANSPL, VXDN, PS(5), TANSPL, VXDN,                     $
         PS(6), TANSPL, VZDN, PS(7), TANSPL, VZDN
TITLES  ---------------------  SECTION NUMBER SIX    -----------------
REMARK  DEFINE POINTS AND VECTORS FOR THE ROUNDED BOTTOM
RESERV/ TS,7
         TS(1)=   POINT/ SQRFLT, 0, 0
         TS(2)=   POINT/ SQRFLT, 0, SQRFLT
         TS(3)=   POINT/ SQRFLT, 0, SQRFLT
         TS(4)=   POINT/ 0, 0, SQRFLT
         TS(5)=   POINT/ -SQRFLT, 0, SQRFLT
         TS(6)=   POINT/ -SQRFLT, 0, SQRFLT
         TS(7)=   POINT/ -SQRFLT, 0, 0
RESERV/ QTS,7
         ALEN=SQRTF(2.0*RNDRAD*RNDRAD)
         QTS(1)=  VECTOR/ SQRFLT,TIMES,VZUP
         QTS(2)=  VECTOR/ ALEN, TIMES, VZUP
         QTS(3)=  VECTOR/ ALEN, TIMES, VXDN
         QTS(4)=  VECTOR/ (2*SQRFLT), TIMES, VXDN
         QTS(5)=  VECTOR/ ALEN, TIMES, VXDN
         QTS(6)=  VECTOR/ ALEN, TIMES, VZDN
         QTS(7)=  VECTOR/ SQRFLT, TIMES, VZDN
         VXD=     VECTOR/ ALEN, TIMES, VXDN
         VXU=     VECTOR/ ALEN, TIMES, VXUP
         VYD=     VECTOR/ ALEN, TIMES, VYDN
         VYU=     VECTOR/ ALEN, TIMES, VYUP
         VZD=     VECTOR/ ALEN, TIMES, VZDN
         VZU=     VECTOR/ ALEN, TIMES, VZUP
PRINT/3,TS(1,THRU,7),QS(1,THRU,7),QTS(1,THRU,7)
TITLES  ---------------------  SECTION NUMBER SEVEN  -----------------
REMARK  DEFINE THE BOTTOM ROUNDED SECTION OF THE BOTTLE BY MEANS OF
REMARK DIRECT PATCH DEFINTIONS.  THESE ARE NECESSARY TO OBTAIN THE THREE
REMARK CORNERED PATCHES ON THE ROUNDED CORNERS OF THE BOTTLE
SBOT=    SSURF/   PATCH, PNTVEC,                                       $
PLUS,    QS(1), QS(2), QTS(1), QTS(1), TS(1), TS(2), QTS(1), QTS(1),   $
         VYD,   VYD,   VZ, VZ, VXD, VXD, VZ, VZ,                       $
PLUS,    QS(2), QS(3), QTS(2), QTS(3), TS(2), TS(3), VZ, VZ,           $
         VYD, VYD, VZ, VZ, VXD, VZD, VZ, VZ,                           $
PLUS,    QS(3),QS(5), QTS(4), QTS(4), TS(3), TS(5), QTS(4), QTS(4),    $
         VYD, VYD, VZ, VZ, VZD, VZD, VZ, VZ,                           $
PLUS,    QS(5), QS(6), VXD, VZD, TS(5), TS(6), VZ, VZ,                 $
         VYD, VYD, VZ, VZ, VZD, VXU, VZ, VZ,                           $
PLUS,    QS(6), QS(7), QTS(7), QTS(7), TS(6), TS(7), QTS(7), QTS(7),   $
         VYD, VYD, VZ, VZ, VXU, VXU, VZ, VZ
TITLES  ---------------------  SECTION NUMBER EIGHT  -----------------
REMARK  CTSEC IS THE CIRCULAR SECTION R.  DEVELOP POINTS AND VECTORS
REMARK  ON THIS SECTION FOR USE IN THE BLEND SURFACE DEFINITION
 CTSEC1=SCURV/ CURSEG, PROFIL(4),TANSPL, VZUP, (POINT/0,RLN,  TOPRAD)
CTSEC2=SCURV/ CURSEG,(POINT/0, RLN ,TOPRAD),TANSPL,VXDN,PROFIL(12)
         CTSEC=   SCURV/ COMBIN, CTSEC1, CTSEC2
REMARK  CTSEC IS THE CIRCULAR SECTION R.  DEVELOP POINTS AND VECTORS
REMARK  COMPUTE SPACE INTERSECTIONS BETWEEN AXIAL PLANES AND CTSEC CURVE
RESERV/ RS,7, VTS,7, VCS,7
         PCEN=    POINT/ 0, RLN , 0
         ICT=0
STATF)   ICT=ICT+1
         IF(ICT-8) STATG,STATH,STATH
STATG)   PLA=     PLANE/ PCEN, PS(ICT), PZ
         RS(ICT)= POINT/INTOF, PLA, CTSEC, PZ
   IF(ICT-7) STATAF,STATAG,STATAF
REMARK   THE LAST POINT MUST BE REDEFINED BECAUSE OF MULTIPLE INTERSEC
   STATAG) OBTAIN, POINT/ RS(ICT), X, Y, Z
         RS(ICT)= POINT/ -X, Y , Z
   STATAF) DUM= 0.0
         VX1=     VECTOR/ PCEN, RS(ICT)
         VX2=     VECTOR/ UNIT, VX1
         VX3=     VECTOR/ BCOS, TIMES, VX2
         VX4=     VECTOR/ BSIN, TIMES, VYUP
         VCS(ICT)= VECTOR/ VX3, PLUS, VX4
         VTS(ICT)= VECTOR/ VCS(ICT), CROSS, VYUP
         JUMPTO/ STATF
STATH)   DUM=0.0
PRINT/3,RS(ALL),VTS(ALL),VCS(ALL)
TITLES  ---------------------  SECTION NUMBER NINE   -----------------
REMARK  DEFINITION OF THE BLEND SURFACE
SBLEN=   SSURF/ SMESH, XYZ,                                            $
SPLINE,  RS(1), TANSPL, VTS(1), CRSSPL, VCS(1),                        $
         RS(2), TANSPL, VTS(2), CRSSPL, VCS(2),                        $
         RS(3), TANSPL, VTS(3), CRSSPL, VCS(3),                        $
         RS(4), TANSPL, VTS(4), CRSSPL, VCS(4),                        $
         RS(5), TANSPL, VTS(5), CRSSPL, VCS(5),                        $
         RS(6), TANSPL, VTS(6), CRSSPL, VCS(6),                        $
         RS(7), TANSPL, VTS(7), CRSSPL, VCS(7),                        $
SPLINE,  PS(1), TANSPL, VZUP, CRSSPL, VYDN,                            $
         PS(2), TANSPL, VZUP, CRSSPL, VYDN,                            $
         PS(3), TANSPL, VXDN, CRSSPL, VYDN,                            $
         PS(4), TANSPL, VXDN, CRSSPL, VYDN,                            $
         PS(5), TANSPL, VXDN, CRSSPL, VYDN,                            $
         PS(6), TANSPL, VZDN, CRSSPL, VYDN,                            $
         PS(7), TANSPL, VZDN, CRSSPL, VYDN
TITLES  ---------------------  SECTION NUMBER TEN    -----------------
REMARK  MACRO TO DIGITIZE PART  OR ALL OF A GIVEN SYNTHETIC CURVE
CDIGIT=  MACRO/ CNAME, SEG1, SEG2, NUM
         SEG=     SEG1-1
ID1)     SEG=     SEG +1
         IF(SEG-SEG2) ID2,ID2,ID3
ID2)     ICT=0
PENUP
ID4)     ICT=     ICT+1
         IF(ICT-NUM+1) ID5,ID5,ID1
ID5)     TVAL= (ICT-1)/NUM
         P=       POINT/ INTOF, CNAME, PARAM, TVAL, SEG
         GOTO/P
PENDWN
         JUMPTO/ ID4
ID3)     DUM=0.0
TERMAC
TITLES  ---------------------  SECTION NUMBER ELEVEN -----------------
REMARK  MACRO TO DIGITIZE A SURFACE
SDIGIT=  MACRO/ SNAME, PNUM1, PNUM2, PINC, UORV, CA, CB, CINC, CDEN, NRM
REMARK  SNAME IS THE SCULPTURED SURFACE NAME
REMARK   PNUM1 IS THE NUMBER OF THE FIRST PATCH TO BE DISPLAYED
REMARK   PNUM2 IS THE NUMBER OF THE LAST PATCH TO BE DISPLAYED
REMARK   PINC IS THE INTERVAL OF PATCHES TO BE DISPLAYED BETWEEN THESE
REMARK   UORV = EITHER U OR V DEPENDING ON WHETHER U OR V IS CONSTANT
REMARK   CA IS THE FIRST VALUE OF THE CONSTANT PARAMETER
REMARK   CB IS THE LAST VALUE OF THE CONSTANT PARAMETER
REMARK   CINC IS THE INCREMENT OF THE CONSTANT PARAMETER
REMARK   CDEN IS THE NUMBER OF LINEAR INTERVALS DISPLAYED PER CURVE
REMARK   NRM POS MEANS DISPLAY NORMALS, OTHERWISE NEGATIVE
$$
REMARK  MACRO VARIABLE CANNOT BE USED AS EXPRESSION IN IF STATEMENT
REMARK  ASSIGN TO LOCAL MACRO VARIABLE
         UVTST=UORV
         NORM=NRM
         PNUM= PNUM1-PINC    $$ PNUM IS THE CURRENT PATCH NUMBER
IQ1)     PNUM= PNUM+PINC
         IF(PNUM-PNUM2) IQ2,IQ2,IQEND
IQ2)     UVAL= CA-CINC
PENUP
IQ3)     UVAL= UVAL+CINC
      IF(UVAL-CB) IQ4,IQ4,IQ1
IQ4)     VNUM=-1
IQ5)     VNUM= VNUM+1
          VNUM0=VNUM-CDEN
        IF(VNUM0) IQ6,IQ6,IQ3
IQ6)     DUM= 0.0
         IF(UVTST) IQ7,IQ7,IQ8
IQ7)     UU=UVAL
         VV=VNUM
         JUMPTO/IQ9
IQ8)     UU=VNUM
         VV= UVAL
IQ9)     P=       POINT/ INTOF, SNAME, PARAM, UU, VV, PNUM
         GOTO/ P
PENDWN
         IF ( NORM ) IQ5,IQ5,IQ10
IQ10)  V=VECTOR/INTOF,SNAME,PARAM,UU,VV,PNUM,NORMAL,UNIT
         OBTAIN,VECTOR/V,X,Y,Z
         GODLTA/X,Y,Z
         GODLTA/-X,-Y,-Z
         JUMPTO/ IQ5
IQEND)   DUM=0.0
TERMAC
TITLES  ---------------------  SECTION NUMBER TWELVE -----------------
REMARK   THIS SECTION DIGITIZES THE MAIN GEOMETRY IF THE USER SO DESIRES
         IF ( IGEOM) IREND, IREND, IR1
         CUTTER/ 0,0,0,0,0,0,0
IR1)     DUM=0.0
INDEX/ 1
CALL/ CDIGIT, CNAME=PROCUR, SEG1=1, SEG2=6, NUM=6
COPY/1,MODIFY,(MATRIX/MIRROR,YZPLAN),1
CALL/ CDIGIT, CNAME=CTSEC, SEG1=1, SEG2=2, NUM=6
CALL/ CDIGIT, CNAME=CQS  , SEG1=1, SEG2=5, NUM=6
CALL/ CDIGIT, CNAME=CPS  , SEG1=1, SEG2=5, NUM=6
CALL/ SDIGIT, SNAME=SBLEN, PNUM1=1, PNUM2=6, PINC=1, UORV=1,           $
              CA=0, CB=1, CINC=0.25, CDEN=5, NRM=1
CALL/ SDIGIT, SNAME=SSQR, PNUM1=1, PNUM2=5, PINC=2, UORV=-1,           $
              CA=0, CB=1, CINC=3, CDEN=5, NRM=-1
CALL/SDIGIT, SNAME=SSQR, PNUM1=2, PNUM2=4, PINC=2, UORV=-1,            $
              CA=0, CB=1, CINC=2, CDEN=5, NRM=-1
CALL/ SDIGIT, SNAME=SBOT, PNUM1=1, PNUM2=5, PINC=1, UORV=-1,           $
             CA=0, CB=1, CINC=3, CDEN=5, NRM=-1
CALL/ SDIGIT,SNAME=STOP, PNUM1=1, PNUM2=4, PINC=1, UORV=1,             $
             CA=0, CB=1, CINC=.25, CDEN=6, NRM=-1
IREND)   DUM=0.0
TITLES  ---------------------  SECTION NUMBER THIRTEEN----------------
REMARK   CUTTING SEQUENCE
         IF( ICUT) ICEND,ICEND,IC1
IC1)     DUM=0.0
REMARK  FIRST CONTOUR AND FACE MILL A BLOCK OF MATERIAL
         CUTRAD=  0.375
REMARK  USE FLAT END MILL FOR FACING AND PROFILING THE BLOCK
         CUTTER/ (2*CUTRAD), 0, 0, 0, 0, 0, CUTRAD
         SUM=     CUTRAD+SQRRAD
         ULL=     POINT/-SUM, -CUTRAD, SQRRAD
         DLL=     POINT/-SUM, -CUTRAD, 0
         DLR=     POINT/ SUM, -CUTRAD, 0
         DUR=     POINT/ SUM, (BOTLN+CUTRAD), 0
         DUL=     POINT/ -SUM, (BOTLN+CUTRAD), 0
         GOTO/ ULL
         GOTO/ DLL
         GOTO/ DLR
         GOTO/ DUR
         GOTO/ DUL
         GOTO/ DLL
         TOP=     BOTLN+CUTRAD
         BOT=     -CUTRAD
         INC=     CUTRAD*0.8
         XVAL=    -(CUTRAD+SQRRAD)-INC
IB1)     XVAL=    XVAL+INC
         IF(XVAL-CUTRAD-SQRRAD) IB2,IB2,IB3
IB2)     GOTO/ XVAL, BOT, SQRRAD
         GOTO/ XVAL, TOP, SQRRAD
         GOTO/ XVAL, BOT, SQRRAD
         JUMPTO/ IB1
IB3)     DUM= 0.0
TITLES  ---------------------  SECTION NUMBER FOURTEEN----------------
REMARK   MILL THE PROFILE
REMARK  CONSTRUCT A RULED SURFACE THROUGH THE PROFILE CURVE
         SPRO=    SSURF/ RULED, PROCUR, AXIS, VZDN
         INDEX/3
         GODLTA/ 0, 0, SQRRAD
         GOTO/ DUR
         GOTO/(LIPRAD+CUTRAD+0.1),BOTLN,0
         GO/TO,SPRO,TO,(PLANE/0,0,1,0),ON,LTOP
         INDIRV/ 0,-1,0
         GOFWD/ SPRO, PAST, LTOP
         GOFWD/SPRO,ON,LQQ
         GOFWD/SPRO,ON,(LINE/(POINT/SQRFLT,RNDRAD,0),ATANGL,135)
         GOFWD/ SPRO, ON, LCEN
         GODLTA/ (2*(CUTRAD+LIPRAD)), 0, SQRRAD
         COPY/3,MODIFY,(MATRIX/MIRROR,YZPLAN),1
TITLES  ---------------------  SECTION NUMBER FIFTEEN ----------------
REMARK  MILL THE UPPER PORTION OF THE BOTTLE (STOP AND SBLEN)
         CUTTER/(2*CUTRAD), CUTRAD, 0, 0, 0, 0, CUTRAD
         CSTOP=   LINE/ 0, BOTLN, 1, BOTLN
         CSINT=LINE/0,(RLN-CUTRAD*(1-BCOS)),1,(RLN-CUTRAD*(1-BCOS))
         CSBOT=   LINE/ 0, PLN, 1, PLN
         COMRAD=  CUTRAD+LIPRAD
         ATO=     ATANF( CUTRAD/COMRAD)
         INC=     10
         ANG= -INC
         INDEX/2
IT1)     ANG= ANG+INC
         IF ( ANG-90.1) IT2,IT2,IT3
IT2)     DRPLAN=  PLANE/ (-SINF(ANG)), 0, (COSF(ANG)), 0
         GOTO/ (COMRAD*COSF(ANG+ATO)), BOTLN,  (COMRAD*SINF(ANG+ATO))
         GO/      ON, DRPLAN, TO, STOP, ON, CSTOP
         TLON, INDIRV/ 0,-1,0
         GOFWD/ DRPLAN, TO, CSINT
REMARK   SWITCH TO NEXT SURFACE
         DNTCUT
         GO/ ON, DRPLAN, TO, SBLEN, TO, CSINT
         CUT
         INDIRV/ 0,-1,0
         TLON
         GOFWD/ DRPLAN, ON, CSBOT
         GODLTA/ 0,0,1
         JUMPTO/ IT1
IT3)     DUM= 0.0
COPY/2,MODIFY,(MATRIX/MIRROR,YZPLAN),1
TITLES  ---------------------  SECTION NUMBER SIXTEEN ----------------
REMARK   MILL THE ROUNDED PORTION OF THE SQUARE SECTION
         LM45= LINE/ (POINT/ -SQRFLT, RNDRAD, 0), ATANGL, 45
         LP45= LINE/ (POINT/ SQRFLT, RNDRAD,0), ATANGL, 135
         CSTOP=   LINE/ 0, PLN, 1, PLN
         CSINT=   LINE/ 0, QLN, 1, QLN
         CSBOT=   LINE/ 0, 0, 1, 0
         CSINT2=LINE/(POINT/-SQRFLT,RNDRAD,0),ATANGL,45
         CSINT3=LINE/(POINT/-SQRFLT,RNDRAD,0),ATANGL,90
         INC=     RNDRAD/7.0
         A= SQRFLT - CUTRAD
IX1)     A= A + INC
         IF ( A-SQRRAD ) IX2,IX3,IX3
IX2)     PLA=     PLANE/ 0, 0, 1, A
         GOTO/  (SQRRAD+CUTRAD), (SQRLN+RNDRAD), SQRRAD
         GO/ ON, PLA, TO, SSQR, ON, CSTOP
         INDIRV/ 0, -1, 0
REMARK USE AN INTERMEDIATE CHECK SURFACE TO HELP ARELEM
         TLON, GOFWD / PLA, ON, LM45
         GOFWD/ PLA, ON, CSINT
         DNTCUT
         GO/ ON, PLA, TO, SBOT, ON, CSINT
         INDIRV/ -1,-1,0
         CUT
         TLON,    GOFWD/PLA, ON, LCEN
         GOFWD/PLA,ON,CSINT3
         GOFWD/PLA,ON,CSINT2
         GOFWD/ PLA, ON, CSINT
         DNTCUT
         GO/ ON, PLA, TO, SSQR, ON, CSINT
         CUT
         INDIRV/ 0, 1, 0
         TLON
         GOFWD/ PLA, ON, CSTOP
         GODLTA/ 0, 0, 1
         JUMPTO/ IX1
IX3)     DUM= 0.0
ICEND)   DUM=0.0
PRINT/3,ALL
FINI
